from flask import Flask,redirect,render_template,request,json,jsonify,session,url_for,flash,Markup
from flask_mail import Mail,Message
import mysql.connector
import requests
import random
import datetime
from datetime import datetime
from datetime import timedelta
from datetime import date
import hashlib
import uuid
import os
from werkzeug.utils import secure_filename
from bs4 import BeautifulSoup
from flask_socketio import SocketIO,send,emit,join_room,leave_room
import xlrd
import razorpay
import xlsxwriter 
from PIL import Image,ImageDraw,ImageFont
from publitio import PublitioAPI
import json

#Cloud Upload API
publitio_api = PublitioAPI(key='1DJB25jRHW9WLQMvLlap', secret='asD7u807m6by7WZ36wStXJmowPqlzisb')

#PAYMENT API
razorpay_client = razorpay.Client(auth=("rzp_test_dSw0oiTYzkIoDn", "BKoGi2mAK2bPCIceByZ5ygpC"))

# New SMS API : nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC


app = Flask(__name__)

socketio = SocketIO(app)


app.secret_key = '1509'



mail=Mail(app)

UPLOAD_FOLDER = '/uploads/'
app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER
app.config['MAIL_SERVER']='smtp.gmail.com'
app.config['MAIL_PORT'] = 465
app.config['MAIL_USERNAME'] = 'alumni.association.goa@gmail.com'
app.config['MAIL_PASSWORD'] = 'ats12345'
app.config['MAIL_USE_TLS'] = False
app.config['MAIL_USE_SSL'] = True

mail = Mail(app)


#DB
cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
con = cnx.cursor()

app_base_url = "http://127.0.0.1:5000/"


# General Routes


@app.route('/l')
def l():
    return render_template("temp.html")

@app.route('/')
def index():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    events = []
    sql = "SELECT * FROM association_events ORDER BY time DESC LIMIT 5"
    con.execute(sql)
    events = con.fetchall()
    
    fund_raising_projects = []
    sql = "SELECT * FROM fund_raising_projects WHERE isVerifiedByAssociation='YES' ORDER BY date_time DESC LIMIT 8"
    con.execute(sql)
    te = con.fetchall()
    
    for i in te :
        t = list(i)
       
        if i[1] == "ALUMNI" :
            t.append("alumni/view/fund-raising-project/"+str(t[0]))
        else :
            if i[1] == "COLLEGE SPOC" :
                t.append("college/view/fund-raising-project/"+str(t[0]))
            
        fund_raising_projects.append(t)
        # print(t)
    con.close()
    
    return render_template('index.html',events=events,l_events=len(events),fund_raising_projects=fund_raising_projects,l_fund_raising_projects=len(fund_raising_projects))

@app.route('/about/')
def about():
    return render_template('about.html')

@app.route('/special_interest_groups/')
def special_interest_groups():
    return render_template("special_interest_groups.html")

@app.route('/alumni_map/')
def alumni_map():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    alumni_locations = []
    try :
        sql = "SELECT college FROM students"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            if i[0] not in alumni_locations :
                alumni_locations.append(i[0])
        print(alumni_locations)
    except :
        print("ERROR FETCHING.")
    
    con.close()
    return render_template("alumni_map.html",alumni_locations=alumni_locations)

@app.route('/student-coordinators/')
def student_coordinators():
    return render_template('student_coordinators.html')


@app.route('/sponsors/')
def sponsors():
    return render_template('sponsors.html')

@app.route('/jobs/')
def jobs():
    return render_template('jobs.html')

@app.route('/internships/')
def internships():
    return render_template('internships.html')

@app.route('/mentorships/')
def mentorships():
    return render_template('mentorships.html')

@app.route('/blog/')
def blog():
    all_blog_posts = []
    trending_posts = []
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * FROM blog_post_association ORDER BY total_views DESC"
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    b_desc = soup.get_text()
                    print(b_desc)
                    t.append(str(b_desc))
                else :
                    if j == 8 :
                        ti = res[i][j].strftime("%d %B %Y")
                        t.append(ti)
                    else :
                        t.append(res[i][j])
            trending_posts.append(t)
            
            
        # print(trending_posts)
                    
                
    except :
        pass
    
    try :
        sql = "SELECT * FROM blog_post_association"
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    b_desc = soup.get_text()
                    print(b_desc)
                    t.append(str(b_desc))
                else :
                    if j == 8 :
                        ti = res[i][j].strftime("%d %B %Y")
                        t.append(ti)
                    else :
                        t.append(res[i][j])
            all_blog_posts.append(t)
            
            
        # print(all_blog_posts)
                    
                
    except :
        pass
    
    con.close()
    return render_template('blog.html',trending_posts=trending_posts,l_t_p=len(trending_posts),all_blog_posts=all_blog_posts,l_a_b_p=len(all_blog_posts))

@app.route('/association/blog/post/<int:association_post_id>')
def association_view_blogPost(association_post_id):
    post_details = []
    all_blog_posts = []
    trending_posts = []
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * FROM blog_post_association WHERE post_id=%d" % (association_post_id)
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                
                if j == 8 :
                    ti = res[i][j].strftime("%d %B %Y")
                    t.append(ti)
                else :
                    t.append(res[i][j])
            post_details.append(t)
            
     
                
    except :
        return redirect(url_for('blog'))
    
    
    try :
        sql = "SELECT * FROM blog_post_association ORDER BY total_views DESC"
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    b_desc = soup.get_text()
                    print(b_desc)
                    t.append(str(b_desc))
                else :
                    if j == 8 :
                        ti = res[i][j].strftime("%d %B %Y")
                        t.append(ti)
                    else :
                        t.append(res[i][j])
            trending_posts.append(t)
            
            
        # print(trending_posts)
                    
                
    except :
        pass
    
    try :
        sql = "SELECT * FROM blog_post_association"
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    b_desc = soup.get_text()
                    print(b_desc)
                    t.append(str(b_desc))
                else :
                    if j == 8 :
                        ti = res[i][j].strftime("%d %B %Y")
                        t.append(ti)
                    else :
                        t.append(res[i][j])
            all_blog_posts.append(t)
            
            
        # print(all_blog_posts)
                    
                
    except :
        pass
    
    
    con.close()
    return render_template('association_view_blog_post.html',post_details=post_details,trending_posts=trending_posts,l_t_p=len(trending_posts),all_blog_posts=all_blog_posts,l_a_b_p=len(all_blog_posts))



@app.route('/alumni_awardees/')
def alumni_awardees():
    return render_template('alumni_awardees.html')


@app.route('/success_stories/')
def success_stories():
    return render_template('success_stories.html')


@app.route('/magazines/')
def magazines():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    magazines = []
    
    try :
        sql = "SELECT * FROM association_magazines"
        con.execute(sql)
        magazines = con.fetchall()
        
    except :
        print("Error : Unable To Get Association Magazines.")
        
    
    con.close()
    return render_template('magazines.html',magazines=magazines,l_magazines=len(magazines))

@app.route('/news/')
def news():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    news = []
    
    try :
        sql = "SELECT * FROM association_news ORDER BY date_time DESC"
        con.execute(sql)
        res = con.fetchall()
        for i in res : 
            print(i[0]) 
            soup = BeautifulSoup(str(i[4]),features="html.parser")
            n_desc = soup.get_text()
            
            n_cat = str(i[5]).replace(","," ")
            d_t = i[7].strftime("%d/%m/%Y")
            news.append([i[0],i[2],i[3],n_desc,n_cat,d_t])
            
    except :
        print("Error In Getting Association News.")
    
    # print(news)
    
    main_news_categories = ["All","College","Alumni","Placement","Achievement"]
    
    con.close()
    return render_template('news_and_updates.html',main_news_categories=main_news_categories,news=news,l_news=len(news))

@app.route('/news/view/<int:news_id>')
def view_news(news_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    news = []
    
    try :
        sql = "UPDATE association_news SET total_views = total_views+1 WHERE id=%d" % (news_id)
        con.execute(sql)
        cnx.commit()           
    except :
        print("Error In Updating Total Views Of News.")
    
    
    try :
        sql = "SELECT * FROM association_news WHERE id=%d" % (news_id)
        con.execute(sql)
        res = con.fetchall()            
    except :
        print("Error In Getting Association News.")
    
    # print(news)
    
    
    
    con.close()
    return render_template('view_news.html',news=res[0])


@app.route('/volunteer_opportunities/')
def volunteer_opportunities():
    return render_template('volunteer_opportunities.html')

@app.route('/inquiry/',methods=['GET','POST'])
def inquiry():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if request.method == "POST" :
        f_name = str(request.form['first_name'])
        l_name = str(request.form['last_name'])
        email = str(request.form['email'])
        mobile_no = int(request.form['mobile_number'])
        subject = str(request.form['subject'])
        message = str(request.form['message'])
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")
        
        isInserted = 0
        isEmailSent = 0
        try :
            sql = "INSERT INTO association_inquiry(first_name,last_name,email,mobile_no,subject,message,isResponsed,responsed_by_association_id,date_time) VALUES('%s','%s','%s',%d,'%s','%s','%s',%d,'%s')" % (f_name,l_name,email,mobile_no,subject,message,"NO",0,d_t)
            con.execute(sql)
            cnx.commit()
            isInserted = 1
        except :
            print("Error In Adding Inquiry.")
        
        if isInserted == 1 :
            sub = "Inquiry @ Alumni Association Of Goa Regarding "+str(subject)
            msg = Message(sub, sender = ('Alumni Association Of Goa.','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        blockquote{
            display:block;
            background: #fff;
            padding: 15px 20px 15px 15px;
            margin: 0 0 20px;
            position: relative;
            
            /*Font*/
            font-family: Georgia, serif;
            font-size: 16px;
            line-height: 1.2;
            color: #666;
            text-align: justify;
            
            /*Borders - (Optional)*/
            border-left: 15px solid #0088ff;
            border-right: 2px solid #0088ff;
            border-radius: 20px;
            /*Box Shadow - (Optional)*/
            -moz-box-shadow: 2px 2px 15px #ccc;
            -webkit-box-shadow: 2px 2px 15px #ccc;
            box-shadow: 2px 2px 15px #ccc;
          }
          
          
          
          blockquote::after{
            /*Reset to make sure*/
            content: "";
          }
          
          blockquote a{
            text-decoration: none;
            background: #eee;
            cursor: pointer;
            padding: 0 3px;
            color: #c76c0c;
          }
          
          blockquote a:hover{
           color: #666;
          }
          
          blockquote em{
            font-style: italic;
          }
    </style>
</head>
<body>
    <p>&nbsp;</p>
<!-- [if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
<p></p>
<!-- [if !mso]><!-->
<p></p>
<!--<![endif]-->
<p></p>
<!-- [if !mso]><!-->
<p></p>
<!--<![endif]--><!-- [if IE]><div class="ie-browser"><![endif]-->
<table class="nl-container" style="table-layout: fixed; vertical-align: top; min-width: 320px; margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f5f5f5; width: 100%;" role="presentation" width="100%" cellspacing="0" cellpadding="0" bgcolor="#F5F5F5">
<tbody>
<tr style="vertical-align: top;" valign="top">
<td style="word-break: break-word; vertical-align: top;" valign="top"><!-- [if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
<div style="background-color: transparent;">
<div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
<div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
<div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
<div style="width: 100% !important;"><!-- [if (!mso)&(!IE)]><!-->
<div style="border: 0px solid transparent; padding: 5px 0px 5px 0px;"><!--<![endif]-->
<table class="divider" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0">
<tbody>
<tr style="vertical-align: top;" valign="top">
<td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;" valign="top">
<table class="divider_content" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
<tbody>
<tr style="vertical-align: top;" valign="top">
<td style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" height="10">&nbsp;</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<!-- [if (!mso)&(!IE)]><!--></div>
<!--<![endif]--></div>
</div>
<!-- [if (mso)|(IE)]></td></tr></table><![endif]--> <!-- [if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]--></div>
</div>
</div>
<div style="background-color: transparent;">
<div class="block-grid two-up no-stack" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
<div style="border-collapse: collapse; display: table; width: 100%; background-color: #ffffff;"><!-- [if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]--> <!-- [if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
<div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
<div style="width: 100% !important;"><!-- [if (!mso)&(!IE)]><!-->
<div style="border: 0px solid transparent; padding: 25px 0px 25px 25px;"><!--<![endif]-->
<div class="img-container left fixedwidth" style="padding-right: 0px; padding-left: 0px;font-size:30px;font-family: Verdana, Geneva, Tahoma, sans-serif;" align="left"><!-- [if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]-->ALUMNI ASSOCIATION OF GOA <!-- [if mso]></td></tr></table><![endif]--></div>
<!-- [if (!mso)&(!IE)]><!--></div>
<!--<![endif]--></div>
</div>

<!-- [if (mso)|(IE)]></td></tr></table><![endif]--> <!-- [if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]--></div>
</div>
</div>
<div style="background-color: transparent;">
<div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #fff;">
<div style="border-collapse: collapse; display: table; width: 100%; background-color: #fff;"><!-- [if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]--> <!-- [if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
<div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
<div style="width: 100% !important;"><!-- [if (!mso)&(!IE)]><!-->
<div style="border: 0px solid transparent; padding: 5px 25px 60px 25px;"><!--<![endif]-->
<div class="img-container center fixedwidth" style="padding-right: 0px; padding-left: 0px;" align="center"><!-- [if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->

 <!-- [if mso]></td></tr></table><![endif]--></div>
<!-- [if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->

<div style="font-family: Verdana, Geneva, Tahoma, sans-serif;">
    <div style="font-size: 20px;">Hey <span style="font-weight: bold;">'''+str(f_name).capitalize()+''' '''+str(l_name).capitalize()+'''</span>,</div>
    <br>
    <div>
Thanks for reaching out! We will be more than happy to help you.
    </div>
    <br>
    <div>
            You Said :
    </div>
    <br>
<div>
    <blockquote>
        <img src="https://darshpatel.best/static/img/quote.png" alt="" style="width: 50px;">
        <br>
        <div style="padding: 0 60px;">
            '''+str(message)+'''
        </div>
      </blockquote>
</div>
<br>
    <div>
        <p>Thanks,</p>
        <p style="font-style: italic;">ALUMNI ASSOCIATION OF GOA.</p>
    </div>
</div>

<!-- [if mso]></td></tr></table><![endif]--> <!-- [if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
<div style="color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; line-height: 1.2; padding: 10px;">
<div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
<p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;">
    We'll contact you within 12-24 hours.
</p>
</div>
</div>
<!-- [if mso]></td></tr></table><![endif]-->
<!-- [if (!mso)&(!IE)]><!--></div>
<!--<![endif]--></div>
</div>
<!-- [if (mso)|(IE)]></td></tr></table><![endif]--> <!-- [if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]--></div>
</div>
</div>
<div style="background-color: transparent;">
<div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
<div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;"><!-- [if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]--> <!-- [if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
<div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
<div style="width: 100% !important;"><!-- [if (!mso)&(!IE)]><!-->
<div style="border: 0px solid transparent; padding: 20px 0px 60px 0px;"><!--<![endif]-->
<table class="social_icons" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
<tbody>
<tr style="vertical-align: top;" valign="top">
<td style="word-break: break-word; vertical-align: top; padding: 10px;" valign="top">
<table class="social_table" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" role="presentation" cellspacing="0" cellpadding="0" align="center">
<tbody>
<tr style="vertical-align: top; display: inline-block; text-align: center;" align="center" valign="top">
<td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://www.facebook.com/darshpatelofficial" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" alt="Facebook" width="32" height="32" /></a></td>
                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://twitter.com/pateldarsh10" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" alt="Twitter" width="32" height="32" /></a></td>
                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://instagram.com/pateldarsh_007" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" alt="Instagram" width="32" height="32" /></a></td>
                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" alt="E-Mail" width="32" height="32" /></a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<!-- [if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
<div style="color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; line-height: 1.5; padding: 10px;">
<div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
<p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;">&copy; 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
</div>
</div>
<!-- [if mso]></td></tr></table><![endif]--> <!-- [if (!mso)&(!IE)]><!--></div>
<!--<![endif]--></div>
</div>
<!-- [if (mso)|(IE)]></td></tr></table><![endif]--> <!-- [if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]--></div>
</div>
</div>
<!-- [if (mso)|(IE)]></td></tr></table><![endif]--></td>
</tr>
</tbody>
</table>
<!-- [if (IE)]></div><![endif]-->
</body>
</html>



                '''
            try :
                mail.send(msg)
                isEmailSent = 1
            except :
                print("Error In Sending Inquiry Mail.")
                
            if isEmailSent == 1 :
              flash(Markup("<p style='color:green;font-size:15px;'>Your Inquiry Request Submitted Successfully.</p>"))  
              return redirect(url_for('inquiry'))
            else :
                flash(Markup("<p style='color:green;font-size:15px;'>Your Inquiry Request Made Successfully.</p>"))  
                return redirect(url_for('inquiry'))
        else :
            flash(Markup("<p style='color:red;font-size:15px;'>Unable To Make Request For Inquiry.</p>"))  
            return redirect(url_for('inquiry'))
        
    con.close() 
    return render_template('inquiry.html')


@app.route('/events/')
def events():
    association_events = []
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT event_name,event_logo,event_description,event_venue,start_date_time,event_id FROM association_events ORDER BY time DESC"
        con.execute(sql)
        res = con.fetchall()
        print("res : ",res)
        for i in range(len(res)) :
            soup = BeautifulSoup(res[i][2],features="html.parser")
            e_desc = soup.get_text()
            # print(e_desc)
            ti = res[i][4]
            ti1 = datetime.strftime(ti,"%d/%m/%Y")
            # print("ti1 : ",ti1)
            association_events.append([res[i][1],res[i][0],e_desc,res[i][3],ti1,res[i][5]])
        
        # print(res_x)
    except :
        pass
    print(association_events)
    con.close()
    return render_template('events.html',association_events=association_events,total_association_events=len(association_events))

@app.route('/association/view/event/<int:event_id>',methods=['GET','POST'])
def association_view_event(event_id):
    event_details = []
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * from association_events WHERE event_id=%d" % (event_id)
        con.execute(sql)
        res = con.fetchall()
        event_details = res
    except :
        pass
    
    if len(event_details) == 0 :
        return redirect(url_for('index'))
    # print("ed :",event_details)
    
    isBookingAllowed = "NO"
    msg = ""
    login_type = ""
    shopping_order_id = ""
    if event_details[0][10] == "YES" :
        
        if event_details[0][11] == "YES" :
            
            if 'alumni_login_id' in session :
                login_type = "ALUMNI"
                isBookingAllowed = "YES"
                
            if 'college_login_id' in session :
                login_type = "COLLEGE SPOC"
                isBookingAllowed = "YES"
                
            if 'association_login_id' in session :
                login_type = "ASSOCIATION"
                isBookingAllowed = "YES"
                
        else :
            msg = "This Event Is Not Active."
            isBookingAllowed = "NO"
    else :
        msg = "Ticket Booking Is Not Allowed."
        isBookingAllowed = "NO"
    
    d_e = ""
    d_m_n = ""
    prepand = ""
    login_profile_id = 0
    if 'alumni_login_id' in session :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        login_profile_id = res[0][0]
        my_college = res[0][7]
        d_e = str(res[0][3])
        d_m_n = "+"+str(res[0][4])+str(res[0][5])
        prepand = "ALUMNI"
    else :
        if 'college_login_id' in session :
            sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
            con.execute(sql)
            res = con.fetchall()
            login_profile_id = res[0][0]
            my_college = res[0][8]
            d_e = str(res[0][4])
            d_m_n = "+"+str(res[0][5])+str(res[0][6])
            prepand = "COLLEGE_SPOC"
        else :
            if 'association_login_id' in session :
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                login_profile_id = res[0][0]
                my_college = res[0][7]
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])
                prepand = "ASSOCIATION"
    
    
    
    order_id = prepand+"_ASSOCIATION_EVENT_"+str(event_id)+"_"+str(uuid.uuid1()).replace("-","")
    payment_amount_inr = int(event_details[0][8]) * 100
    session['association_event_amount'] = int(event_details[0][8])
    session['association_event_id'] = event_id
    session['assocition_event_membership_type'] = login_type
    session['association_event_login_id'] = login_profile_id
    
    isEventStarted = "NO" 
    e_s_d_t = event_details[0][6].strftime("%Y-%m-%d %H:%M:%S")
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    if now < e_s_d_t :
        isEventStarted = "NO"
    else :
        isEventStarted =  "YES"
        
    con.close()
    
    con.close()
    return render_template('association_view_event.html',event_details=event_details,isBookingAllowed=isBookingAllowed,msg=msg,login_type=login_type,order_id=order_id,payment_amount_inr=payment_amount_inr,d_e=d_e,d_m_n=d_m_n,isEventStarted=isEventStarted)

@app.route('/association/event/payment/callback', methods=['POST'])
def app_charge_association_event_payment_callback():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    amount = int(session['association_event_amount']) * 100
    payment_id = request.form['razorpay_payment_id']
    
    razorpay_client.payment.capture(payment_id, amount)
    res = razorpay_client.payment.fetch(payment_id)
    isDetailsGot = 0
    isGeneratePDF = 0
    
    event_id = session['association_event_id']
    
    try :
    
        order_id = str(res["notes"]["shopping_order_id"])
        membership_type = session['assocition_event_membership_type'] 
        user_id = int(session['association_event_login_id'] )
        payment_id = str(res["id"])
        payment_amount = int(res["amount"]) / 100
        payment_status = str(res["status"])
        payment_method = str(res["method"])
        payment_email = str(res["email"])
        payment_contact = str(res["contact"])
        payment_fee = int(res["fee"]) / 100
        if payment_status == "captured" :
            payment_done = "DONE"
            isGeneratePDF = 1
            
        elif payment_status == "authorized" :
            payment_done = "PENDING"
        else :
            payment_done = "ERROR"
        
        isDetailsGot = 1
    except :
        print("Error In Getting Payment Details.")
    main_sent = 0
    isInserted = 0
    if isDetailsGot == 1 :
        print(payment_id)
        print(order_id)
        print(event_id)
        print(membership_type)
        print("User Id : ",user_id)
        print(payment_amount)
        print(payment_status)
        print(payment_method)
        print(payment_email)
        print(payment_contact)
        print(payment_fee)
        print(isDetailsGot)
        print(payment_done)
        total_payment_done = payment_amount - payment_fee
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S") 
        try :
            sql = "INSERT INTO association_event_attendees(event_id,membership_type,user_id,payment_id,order_id,payment_amount,payment_fee,payment_method,payment_email,payment_contact,payment_status,payment_done,ticket,date_time) VALUES (%d,'%s',%d,'%s','%s',%f,%f,'%s','%s',%d,'%s','%s','%s','%s')" % (int(event_id),str(membership_type),int(user_id),str(payment_id),str(order_id),float(payment_amount),float(payment_fee),str(payment_method),str(payment_email),int(payment_contact),str(payment_status),str(payment_done),"",d_t)
            print(sql)
            con.execute(sql)
            cnx.commit()
            
            sql = "UPDATE association_events SET event_tickets_to_sell=event_tickets_to_sell-1 WHERE event_id="+str(event_id)
            
            con.execute(sql)
            cnx.commit()
            
            isInserted = 1         
        except :
            print("Error In Inserting In Association Attendee Payment Details.")
        
        if isInserted == 1 :
            sql = "SELECT * FROM association_events WHERE event_id=%d" % (int(event_id))
            con.execute(sql)
            res = con.fetchall()
            event_name = res[0][2]
            if membership_type == "ALUMNI" : 
                sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])
                
            if membership_type == "COLLEGE SPOC" :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][2]).capitalize()+" "+str(res[0][3]).capitalize()
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
            
            if membership_type == "ASSOCIATION" :
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])

            try :
                
                msg = Message('EVENT TICKET PAYMENT DETAILS', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [payment_email])
                    
                msg.html = '''
                                <!DOCTYPE html>
                                <html lang="en">
                                <head>
                                    <meta charset="UTF-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                    <title></title>
                                </head>
                                <body>
                                    <table class="nl-container" style="table-layout: fixed; vertical-align: top; min-width: 320px; margin: 0 
                                auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f5f5f5; width: 100%;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                        <tbody>
                                        <tr style="vertical-align: top;" valign="top">
                                            <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 5px 0px 5px 0px;">       
                                                                <table class="divider" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;" valign="top">
                                                                            <table class="divider_content" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
                                                                                <tbody>
                                                                                    <tr style="vertical-align: top;" valign="top">
                                                                                        <td style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" height="10">&nbsp;</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid two-up no-stack" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">     
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #ffffff;">
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 0px 25px 25px;">    
                                                                <div class="img-container left fixedwidth" style="padding-right: 0px; padding-left: 0px;" align="left">
                                                                    <img class="left fixedwidth" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" alt="Image Logo" width="195" border="0" />
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 25px 25px 0px;">    
                                                                <div class="button-container" style="padding: 10px 0px 10px 10px;" align="right">
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #d6e7f0;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #d6e7f0;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;background-color:white;padding:20px">
                                                        
                                                            <table bgcolor="#f9f9f9" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f9f9f9; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#f9f9f9"><![endif]-->
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 14px; line-height: 1.2; word-break: break-word; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 17px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Dear </span><span style="font-size: 17px; mso-ansi-font-size: 18px;"><b>'''+str(name)+'''</b> Your Payment For Event Ticket Booking Is Successful.Thank You</span></span><span style="font-size: 17px; color: #000000; mso-ansi-font-size: 18px;"> For Booking Ticket For <b>'''+str(event_name)+'''</b>.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 17px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 20px; mso-ansi-font-size: 18px; margin: 0;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Payment Details</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>PAYMENT ID : '''+str(payment_id)+'''</strong></span></span></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>ORDER ID : '''+str(order_id)+'''</strong></span></span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid three-up" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;">Total Amount Paid</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:0px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;"> '''+str(payment_amount)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Fee</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(payment_fee)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Received</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(total_payment_done)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:transparent;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:0px; padding-bottom:0px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:0px; padding-bottom:0px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Email</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_email)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Mobile No.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_contact)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="0" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 0px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td height="0" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                <div align="center" class="button-container" style="padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="" style="height:31.5pt; width:116.25pt; v-text-anchor:middle;" arcsize="10%" stroke="false" fillcolor="#ea5256"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, sans-serif; font-size:16px"><![endif]-->
                                                                <a href="'''+str(app_base_url)+'''association/event/receipt/'''+str(payment_id)+'''/'''+str(order_id)+'''"><div style="text-decoration:none;display:inline-block;color:#ffffff;background-color:#ea5256;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;width:auto; width:auto;;border-top:1px solid #ea5256;border-right:1px solid #ea5256;border-bottom:1px solid #ea5256;border-left:1px solid #ea5256;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;text-align:center;mso-border-alt:none;word-break:keep-all;"><span style="padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;">VIEW NOW</span></span></div></a>
                                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        <div style="background-color: transparent;">
                                            <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                            <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                    <div style="width: 100% !important;">
                                                        <div style="border: 0px solid transparent; padding: 20px 0px 60px 0px;">
                                                        <table class="social_icons" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                                            <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                    <td style="word-break: break-word; vertical-align: top; padding: 10px;" valign="top">
                                                                    <table class="social_table" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" role="presentation" cellspacing="0" cellpadding="0" align="center">
                                                                        <tbody>
                                                                            <tr style="vertical-align: top; display: inline-block; text-align: center;" align="center" valign="top">
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://www.facebook.com/darshpatelofficial" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" alt="Facebook" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://twitter.com/pateldarsh10" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" alt="Twitter" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://instagram.com/pateldarsh_007" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" alt="Instagram" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" alt="E-Mail" width="32" height="32" /></a></td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <div style="color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; line-height: 1.5; padding: 10px;">
                                                            <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;">&copy; 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                                </table>
                                </body>
                                </html>                                   
                    '''
                try :
                    mail.send(msg)
                    mail_sent = 1
                except :
                    print("Error In Sending Mail.")

                if mail_sent == 1 :
                    
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '../../../association/view/event/"+str(event_id)+"';</script>"; 
                else :
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '../../../association/view/event/"+str(event_id)+"';</script>"; 
            except :
                print("Error In Sending payment F_R_P Details To email.")
                flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                return "<script>window.location = '../../../association/view/event/"+str(event_id)+"';</script>"; 
        
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Payment Details.</p>"))
            return "<script>window.location = '../../../association/view/event/"+str(event_id)+"';</script>"; 
    else :
        return "<script>window.location = '../../../association/view/event/"+str(event_id)+"';</script>"; 

    # res2 = json.dumps(res,indent=4)
    # con.close()
    # return res2

@app.route('/college/view/event/<int:event_id>',methods=['GET','POST'])
def college_view_event(event_id):
    event_details = []
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * from college_events WHERE event_id=%d" % (event_id)
        con.execute(sql)
        res = con.fetchall()
        event_details = res
    except :
        pass
    
    if len(event_details) == 0 :
        return redirect(url_for('index'))
    # print("ed :",event_details)
    
    isBookingAllowed = "NO"
    msg = ""
    login_type = ""
    shopping_order_id = ""
    isAllowedOtherCollege = "NO"
    isAlumniAllowed = "NO"
    my_college = ""
    
    if event_details[0][10] == "YES" :
        
        if event_details[0][11] == "YES" :
            
            if event_details[0][14] == "YES" :
                isAllowedOtherCollege = "YES"
                if 'alumni_login_id' in session :
                    login_type = "ALUMNI"
                    isAlumniAllowed = "YES"
                else :
                    isAlumniAllowed = "NO"
            else :
                if 'alumni_login_id' in session :
                    login_type = "ALUMNI"
                    isBookingAllowed = "YES"
                    
                    sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    
                    sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(event_details[0][1]))
                    con.execute(sql)
                    res = con.fetchall()
                    if str(res[0][8]) == str(my_college) :
                        isAlumniAllowed = "YES"
                else :
                    isAlumniAllowed = "NO"
                
        else :
            msg = "This Event Is Not Active."
            isBookingAllowed = "NO"
    else :
        msg = "Ticket Booking Is Not Allowed."
        isBookingAllowed = "NO"
    
    d_e = ""
    d_m_n = ""
    prepand = ""
    login_profile_id = 0
    if 'alumni_login_id' in session :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        login_profile_id = res[0][0]
        my_college = res[0][7]
        d_e = str(res[0][3])
        d_m_n = "+"+str(res[0][4])+str(res[0][5])
        prepand = "ALUMNI"
    
    print("isAlumniAllowed : ",isAlumniAllowed)
    print("'isAllowedOtherCollege : ",isAllowedOtherCollege)
    order_id = prepand+"_COLLEGE_EVENT_"+str(event_id)+"_"+str(uuid.uuid1()).replace("-","")
    payment_amount_inr = int(event_details[0][8]) * 100
    session['college_event_amount'] = int(event_details[0][8])
    session['college_event_id'] = event_id
    session['college_event_membership_type'] = login_type
    session['college_event_login_id'] = login_profile_id
    
    isEventStarted = "NO" 
    e_s_d_t = event_details[0][6].strftime("%Y-%m-%d %H:%M:%S")
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    if now < e_s_d_t :
        isEventStarted = "NO"
    else :
        isEventStarted =  "YES"
        
    con.close()
    return render_template('college_view_event.html',event_details=event_details,isBookingAllowed=isBookingAllowed,msg=msg,login_type=login_type,order_id=order_id,payment_amount_inr=payment_amount_inr,d_e=d_e,d_m_n=d_m_n,isAllowedOtherCollege=isAllowedOtherCollege,isAlumniAllowed=isAlumniAllowed,isEventStarted=isEventStarted)

@app.route('/college/event/payment/callback', methods=['POST'])
def app_charge_college_event_payment_callback():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    amount = int(session['college_event_amount']) * 100
    payment_id = request.form['razorpay_payment_id']
    
    razorpay_client.payment.capture(payment_id, amount)
    res = razorpay_client.payment.fetch(payment_id)
    isDetailsGot = 0
    isGeneratePDF = 0
    
    event_id = session['college_event_id']
    
    try :
    
        order_id = str(res["notes"]["shopping_order_id"])
        membership_type = session['college_event_membership_type'] 
        user_id = int(session['college_event_login_id'] )
        payment_id = str(res["id"])
        payment_amount = int(res["amount"]) / 100
        payment_status = str(res["status"])
        payment_method = str(res["method"])
        payment_email = str(res["email"])
        payment_contact = str(res["contact"])
        payment_fee = int(res["fee"]) / 100
        if payment_status == "captured" :
            payment_done = "DONE"
            isGeneratePDF = 1
            
        elif payment_status == "authorized" :
            payment_done = "PENDING"
        else :
            payment_done = "ERROR"
        
        isDetailsGot = 1
    except :
        print("Error In Getting Payment Details.")
    main_sent = 0
    isInserted = 0
    if isDetailsGot == 1 :
        print(payment_id)
        print(order_id)
        print(event_id)
        print(membership_type)
        print("User Id : ",user_id)
        print(payment_amount)
        print(payment_status)
        print(payment_method)
        print(payment_email)
        print(payment_contact)
        print(payment_fee)
        print(isDetailsGot)
        print(payment_done)
        total_payment_done = payment_amount - payment_fee
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S") 
        try :
            sql = "INSERT INTO college_event_attendees(event_id,membership_type,user_id,payment_id,order_id,payment_amount,payment_fee,payment_method,payment_email,payment_contact,payment_status,payment_done,ticket,date_time) VALUES (%d,'%s',%d,'%s','%s',%f,%f,'%s','%s',%d,'%s','%s','%s','%s')" % (int(event_id),str(membership_type),int(user_id),str(payment_id),str(order_id),float(payment_amount),float(payment_fee),str(payment_method),str(payment_email),int(payment_contact),str(payment_status),str(payment_done),"",d_t)
            print(sql)
            con.execute(sql)
            cnx.commit()
            
            sql = "UPDATE college_events SET event_tickets_to_sell=event_tickets_to_sell-1 WHERE event_id="+str(event_id)
            
            con.execute(sql)
            cnx.commit()
            
            isInserted = 1         
        except :
            print("Error In Inserting In College Attendee Payment Details.")
        
        if isInserted == 1 :
            sql = "SELECT * FROM college_events WHERE event_id=%d" % (int(event_id))
            con.execute(sql)
            res = con.fetchall()
            event_name = res[0][2]
            if membership_type == "ALUMNI" : 
                sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])
                
            if membership_type == "COLLEGE SPOC" :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][2]).capitalize()+" "+str(res[0][3]).capitalize()
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
            
            if membership_type == "ASSOCIATION" :
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])

            try :
                
                msg = Message('EVENT TICKET PAYMENT DETAILS', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [payment_email])
                    
                msg.html = '''
                                <!DOCTYPE html>
                                <html lang="en">
                                <head>
                                    <meta charset="UTF-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                    <title></title>
                                </head>
                                <body>
                                    <table class="nl-container" style="table-layout: fixed; vertical-align: top; min-width: 320px; margin: 0 
                                auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f5f5f5; width: 100%;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                        <tbody>
                                        <tr style="vertical-align: top;" valign="top">
                                            <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 5px 0px 5px 0px;">       
                                                                <table class="divider" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;" valign="top">
                                                                            <table class="divider_content" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
                                                                                <tbody>
                                                                                    <tr style="vertical-align: top;" valign="top">
                                                                                        <td style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" height="10">&nbsp;</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid two-up no-stack" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">     
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #ffffff;">
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 0px 25px 25px;">    
                                                                <div class="img-container left fixedwidth" style="padding-right: 0px; padding-left: 0px;" align="left">
                                                                    <img class="left fixedwidth" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" alt="Image Logo" width="195" border="0" />
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 25px 25px 0px;">    
                                                                <div class="button-container" style="padding: 10px 0px 10px 10px;" align="right">
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #d6e7f0;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #d6e7f0;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;background-color:white;padding:20px">
                                                        
                                                            <table bgcolor="#f9f9f9" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f9f9f9; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#f9f9f9"><![endif]-->
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 14px; line-height: 1.2; word-break: break-word; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 17px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Dear </span><span style="font-size: 17px; mso-ansi-font-size: 18px;"><b>'''+str(name)+'''</b> Your Payment For Event Ticket Booking Is Successful.Thank You</span></span><span style="font-size: 17px; color: #000000; mso-ansi-font-size: 18px;"> For Booking Ticket For <b>'''+str(event_name)+'''</b>.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 17px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 20px; mso-ansi-font-size: 18px; margin: 0;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Payment Details</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>PAYMENT ID : '''+str(payment_id)+'''</strong></span></span></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>ORDER ID : '''+str(order_id)+'''</strong></span></span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid three-up" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;">Total Amount Paid</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:0px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;"> '''+str(payment_amount)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Fee</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(payment_fee)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Received</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(total_payment_done)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:transparent;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:0px; padding-bottom:0px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:0px; padding-bottom:0px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Email</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_email)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Mobile No.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_contact)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="0" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 0px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td height="0" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                <div align="center" class="button-container" style="padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="" style="height:31.5pt; width:116.25pt; v-text-anchor:middle;" arcsize="10%" stroke="false" fillcolor="#ea5256"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, sans-serif; font-size:16px"><![endif]-->
                                                                <a href="'''+str(app_base_url)+'''college/event/receipt/'''+str(payment_id)+'''/'''+str(order_id)+'''"><div style="text-decoration:none;display:inline-block;color:#ffffff;background-color:#ea5256;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;width:auto; width:auto;;border-top:1px solid #ea5256;border-right:1px solid #ea5256;border-bottom:1px solid #ea5256;border-left:1px solid #ea5256;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;text-align:center;mso-border-alt:none;word-break:keep-all;"><span style="padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;">VIEW NOW</span></span></div></a>
                                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        <div style="background-color: transparent;">
                                            <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                            <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                    <div style="width: 100% !important;">
                                                        <div style="border: 0px solid transparent; padding: 20px 0px 60px 0px;">
                                                        <table class="social_icons" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                                            <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                    <td style="word-break: break-word; vertical-align: top; padding: 10px;" valign="top">
                                                                    <table class="social_table" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" role="presentation" cellspacing="0" cellpadding="0" align="center">
                                                                        <tbody>
                                                                            <tr style="vertical-align: top; display: inline-block; text-align: center;" align="center" valign="top">
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://www.facebook.com/darshpatelofficial" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" alt="Facebook" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://twitter.com/pateldarsh10" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" alt="Twitter" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://instagram.com/pateldarsh_007" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" alt="Instagram" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" alt="E-Mail" width="32" height="32" /></a></td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <div style="color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; line-height: 1.5; padding: 10px;">
                                                            <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;">&copy; 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                                </table>
                                </body>
                                </html>                                   
                    '''
                try :
                    mail.send(msg)
                    mail_sent = 1
                except :
                    print("Error In Sending Mail.")

                if mail_sent == 1 :
                    
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '../../../college/view/event/"+str(event_id)+"';</script>"; 
                else :
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '../../../college/view/event/"+str(event_id)+"';</script>"; 
            except :
                print("Error In Sending payment F_R_P Details To email.")
                flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                return "<script>window.location = '../../../college/view/event/"+str(event_id)+"';</script>"; 
        
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Payment Details.</p>"))
            return "<script>window.location = '../../../college/view/event/"+str(event_id)+"';</script>"; 
    else :
        return "<script>window.location = '../../../college/view/event/"+str(event_id)+"';</script>"; 

    # res2 = json.dumps(res,indent=4)
    # con.close()
    # return res2


@app.route('/chapters/')
def chapters():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    all_students = []
    # l_all_entrepreneurs = 0
    temp_places = []
    places = [["Ahmedabad",10,5],['Mumbai',12,3]]
    place_count = []
    l_places = 0
    dict_places = {}
    # try :
        # sql = "SELECT * FROM students"
        # con.execute(sql)
        # res = con.fetchall()
        # for i in res :
        #     all_students.append(i)
        #     # print("exe")
        #     if str(i[7]) not in temp_places :
        #         temp_places.append(str(i[7]))
        #         try :
        #             sql = "SELECT * FROM students WHERE id=%d AND isEmailVerified='YES' AND isMobileVerified='YES'" % (int(i[0]))
        #             con.execute(sql)
        #             res = con.fetchall()
        #             x = len(res)
        #             # print("exe2")
        #             sql = "SELECT * FROM students WHERE id=%d AND account_status='ACTIVATED'" % (int(i[0]))
        #             con.execute(sql)
        #             res = con.fetchall()
        #             y = len(res)
                    
        #             sql = "SELECT * FROM students WHERE id=%d AND account_status='REJECTED'" % (int(i[0]))
        #             con.execute(sql)
        #             res = con.fetchall()
        #             z = len(res)
                    
        #             places.append([i[7],str(x),str(y),str(z)])
        #         except :
        #             pass
        #     else :
        #         pass
        # print("temp places : ",temp_places)
        # print(places)
    # except :
    #     pass
    
   
    cnx.close()
    # return jsonify(o_details=o_details,p_details=p_details,b_details=b_details)
    return render_template('chapters.html',places=places)   


@app.route('/calendar')
def calendar():
    return render_template('alumni_calendar.html')

@app.route('/faq/')
def faq():
    return render_template('faq.html')

# Alumni Routes

@app.route('/alumni/signup/')
def alumni_signup():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isEmailExist = 0
    isMobileNoExist = 0
    session['signed_up_email'] = ""
    session['signed_up_f_name'] = ""
    session['signed_up_l_name'] = ""
    session['signed_up_url_part_1'] = ""
    inserted_into_db = 0
    mail_sent = 0
    if request.method=='GET':
        mode=request.args.get('mode')
        if mode == "3":
            college_id = request.args.get('v')
        
            sql = "SELECT * FROM college_degrees WHERE college_id=%d" % (int(college_id))
            con.execute(sql)
            res = con.fetchall()
            degrees = []
            for i in res:
                degrees.append(i[2])
                
            return jsonify(degrees=degrees)
        
        if mode == "2":
            country = request.args.get('v')
        
            sql = "SELECT * FROM countries WHERE name='%s'" % (country)
            con.execute(sql)
            res = con.fetchall()
            return str(res[0][3])
        
        if mode == "1" :
            f_name = request.args.get('f_name')
            l_name = request.args.get('l_name')
            email = request.args.get('email')
            country_code = int(request.args.get('country_code'))
            mobile_number = int(request.args.get('mobile_number'))
            password = request.args.get('password')
            college_id = int(request.args.get('college'))
            degree = request.args.get('degree')
            enrollment_number = int(request.args.get('enrollment_number'))
            entry_year = int(request.args.get('entry_year'))
            passout_year = int(request.args.get('passout_year'))
            
            sql = "SELECT * FROM colleges WHERE college_id=%d" % (college_id)
            con.execute(sql)
            res = con.fetchall()
            college = str(res[0][1])
            # Check For Student Added By College.
            inAddedStudent = 0
            try :
                #Checking Email or Mobile Exists Or Not
                sql = "SELECT * FROM students_added_by_college WHERE email='%s' AND isEmailVerified='NO'" % (email)
                con.execute(sql)
                res=con.fetchall()
                print("Email Exist : ",len(res))
                if len(res) == 1 :
                    try :
                        #Checking  Mobile Exists Or Not
                        sql = "SELECT * FROM students_added_by_college WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='NO'" % (country_code,mobile_number)
                        con.execute(sql)
                        res=con.fetchall()
                        
                        if len(res) == 1 :
                            try :   
                                #Checking For Student Record Exists Or Not
                                sql = "SELECT * FROM students_added_by_college WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='NO'" % (college,degree,enrollment_number,entry_year,passout_year)
                                con.execute(sql)
                                res=con.fetchall()
                                
                                if len(res) == 1 :
                                    inAddedStudent = 1
                                else :
                                    inAddedStudent = 0
                            except :
                                pass
                        else :
                            print("Erroor Mobile///////// students_added_by_college")
                    except :
                        pass
                else :
                    print("Error In Comparing Email in students_added_by_college ")
            except :
                pass
            
            
            
            print("\n"+str(inAddedStudent)+"\n")
            
            if inAddedStudent == 1 :
                try :   
                    #Checking For Student Record Exists Or Not
                    sql = "SELECT * FROM students_added_by_college WHERE first_name='%s' AND last_name='%s' AND email='%s' AND isEmailVerified='NO' AND country_code=%d AND mobile_number=%d AND isMobileVerified='NO' AND college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='NO'" % (str(f_name).lower(),str(l_name).lower(),email,country_code,mobile_number,college,degree,enrollment_number,entry_year,passout_year)
                    con.execute(sql)
                    res=con.fetchall()
                    if len(res) == 1 :
                        verification_code = str(res[0][16])
                    
                        now = datetime.now()
                        time = now.strftime("%Y-%m-%d %H:%M:%S")
                        
                    
                        url_part_1 = str(verification_code)
                        
                        sql = "INSERT INTO students(first_name,last_name, email,country_code, mobile_number, password, college, degree, enrollment_number, entry_year, passout_year, isEmailVerified, isMobileVerified,isStudentVerified, verification_code,otp, account_status, time) VALUES('%s','%s','%s',%d,%d,'%s','%s','%s',%d,%d,%d,'%s','%s','%s','%s',%d,'%s','%s')" % (str(f_name).lower(),str(l_name).lower(),email,country_code,mobile_number,password,college,degree,enrollment_number,entry_year,passout_year,"NO","NO","NO",verification_code,000000,"NOT ACTIVATED",time)
                    
                        try :
                            con.execute(sql)
                            cnx.commit()
                            inserted_into_db = 1
                        except :
                            print("Error In Inserting In Database.")
                    else :
                        pass
                except :
                    pass
            else :
                
                try :
                    #Checking Email or Mobile Exists Or Not
                    sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES'" % (email)
                    con.execute(sql)
                    res=con.fetchall()
                    print("Email Exist : ",len(res))
                    if len(res) == 1 :
                        print("Erroor Mail/////////")
                        return jsonify(res=0,error="EMailExist",msg="This Email Is Already Registered With Us.")
                except :
                    pass
                try :
                    #Checking  Mobile Exists Or Not
                    sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES'" % (country_code,mobile_number)
                    con.execute(sql)
                    res=con.fetchall()
                    print("Mobile Exist : ",len(res))
                    if len(res) == 1 :
                        print("Erroor Mobile/////////")
                        return jsonify(res=0,error="EMailExist",msg="This Mobile Number Is Already Registered With Us.")
                except :
                    pass
                
                try :   
                    #Checking For Student Record Exists Or Not
                    sql = "SELECT * FROM students WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='YES'" % (college,degree,enrollment_number,entry_year,passout_year)
                    con.execute(sql)
                    res=con.fetchall()
                    print("Student Exist : ",len(res))
                    if len(res) == 1 :
                        print("Erroor Student Exist/////////")
                        return jsonify(res=0,error="EMailExist",msg="A Student Record Is Already Registered With Us.")
                except :
                    pass   
                
                
                
                
                verification_code = str(uuid.uuid1())
                
                now = datetime.now()
                time = now.strftime("%Y-%m-%d %H:%M:%S")
                
                sql = "INSERT INTO students(first_name,last_name, email,country_code, mobile_number, password, college, degree, enrollment_number, entry_year, passout_year, isEmailVerified, isMobileVerified,isStudentVerified, verification_code,otp, account_status, time) VALUES('%s','%s','%s',%d,%d,'%s','%s','%s',%d,%d,%d,'%s','%s','%s','%s',%d,'%s','%s')" % (str(f_name).lower(),str(l_name).lower(),email,country_code,mobile_number,password,college,degree,enrollment_number,entry_year,passout_year,"NO","NO","NO",verification_code,000000,"NOT ACTIVATED",time)
                
                try :
                    con.execute(sql)
                    cnx.commit()
                    inserted_into_db = 1
                except :
                    print("Error In Inserting In Database.")
                    
            
                url_part_1 = str(verification_code)
                
            
            if inserted_into_db == 1 :
                msg = Message('VERIFY YOUR EMAIL', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
                
                msg.html = '''
                                                                <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

    <head>
        <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta content="width=device-width" name="viewport" />
        <!--[if !mso]><!-->
        <meta content="IE=edge" http-equiv="X-UA-Compatible" />
        <!--<![endif]-->
        <title></title>
        <!--[if !mso]><!-->
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
        <!--<![endif]-->
        <style type="text/css">
            body {
                margin: 0;
                padding: 0;
            }
            
            table,
            td,
            tr {
                vertical-align: top;
                border-collapse: collapse;
            }
            
            * {
                line-height: inherit;
            }
            
            a[x-apple-data-detectors=true] {
                color: inherit !important;
                text-decoration: none !important;
            }
        </style>
        <style id="media-query" type="text/css">
            @media (max-width: 670px) {
                .block-grid,
                .col {
                    min-width: 320px !important;
                    max-width: 100% !important;
                    display: block !important;
                }
                .block-grid {
                    width: 100% !important;
                }
                .col {
                    width: 100% !important;
                }
                .col>div {
                    margin: 0 auto;
                }
                img.fullwidth,
                img.fullwidthOnMobile {
                    max-width: 100% !important;
                }
                .no-stack .col {
                    min-width: 0 !important;
                    display: table-cell !important;
                }
                .no-stack.two-up .col {
                    width: 50% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num8 {
                    width: 66% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num3 {
                    width: 25% !important;
                }
                .no-stack .col.num6 {
                    width: 50% !important;
                }
                .no-stack .col.num9 {
                    width: 75% !important;
                }
                .video-block {
                    max-width: none !important;
                }
                .mobile_hide {
                    min-height: 0px;
                    max-height: 0px;
                    max-width: 0px;
                    display: none;
                    overflow: hidden;
                    font-size: 0px;
                }
                .desktop_hide {
                    display: block !important;
                    max-height: none !important;
                }
            }
        </style>
    </head>

    <body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
        <!--[if IE]><div class="ie-browser"><![endif]-->
        <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
            <tbody>
                <tr style="vertical-align: top;" valign="top">
                    <td style="word-break: break-word; vertical-align: top;" valign="top">
                        <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                                
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                    <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                    <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                        <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                            </strong>
                                                            </span>
                                                        </p>
                                                        <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                            </strong>
                                                            </span>
                                                        </p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                        <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Thanks for joiningto <strong>ALUMNI ASSOCIATION OF GOA</strong>. Please Click On The "VERIFY MY EMAIL" Button To Verify Your Account.</span></p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/verify/email/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>VERIFY MY EMAIL</strong></span></span></a>
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                    <tbody>
                                                                        <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                        <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
        <!--[if (IE)]></div><![endif]-->
    </body>

    </html>
                    '''
                try :
                    mail.send(msg)
                    mail_sent = 1
                except :
                    print("Error In Sending Mail.")
                session['signed_up_email'] = email
                session['signed_up_f_name'] = f_name
                session['signed_up_l_name'] = l_name
                session['signed_up_url_part_1'] = url_part_1
                return jsonify(res=1)
            
    
    sql = "SELECT * FROM colleges"
    con.execute(sql)
    res = con.fetchall()
    colleges = []
    for i in res :
        colleges.append([i[0],i[1]])
        
    print("college : ",colleges)
    
    
    sql = "SELECT * FROM countries"
    con.execute(sql)
    res = con.fetchall()
    countries = []
    for i in res :
        countries.append(i)
        
 
    con.close()
    return render_template('alumni_signup.html',colleges=colleges,total_colleges=len(colleges),countries=countries)

@app.route('/alumni/welcome_email/')
def alumni_welcome_email():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    mail_sent = 0
    if session['signed_up_email'] == "" or session['signed_up_f_name'] == "" or session['signed_up_l_name'] == "" :
        return redirect(url_for('alumni_signup'))
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = session['signed_up_email']
            f_name = session['signed_up_f_name']
            l_name = session['signed_up_l_name']
            url_part_1 = session['signed_up_url_part_1']
            msg = Message('VERIFY YOUR EMAIL', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                    <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Thanks for joiningto <strong>ALUMNI ASSOCIATION OF GOA</strong>. Please Click On The "VERIFY MY EMAIL" Button To Verify Your Account.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/verify/email/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>VERIFY MY EMAIL</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                print("Error In Sending Mail.")
                
            if mail_sent == 1 :
                return jsonify(res=1)
            else :
                return jsonify(res=0)
    
    con.close()
    return render_template('alumni_welcome_email.html')

@app.route('/alumni/custom/invitation/<verification_code>')
def alumni_college_signup(verification_code):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isEmailExist = 0
    isMobileNoExist = 0
    session['signed_up_email'] = ""
    session['signed_up_f_name'] = ""
    session['signed_up_l_name'] = ""
    session['signed_up_url_part_1'] = ""
    inserted_into_db = 0
    mail_sent = 0
    
    signedup_details = [] 
           
    sql = "SELECT * FROM students_added_by_college WHERE verification_code='%s' AND isEmailVerified='NO' AND isMobileVerified='NO' AND isStudentVerified='NO'" % (str(verification_code))
    con.execute(sql)
    signedup_details = con.fetchall()
    
    if len(signedup_details) == 1 :
        pass
    else :
        return redirect(url_for('alumni_signup'))
   
    
    if request.method=='GET':
        mode=request.args.get('mode')
        if mode == "3":
            college_id = request.args.get('v')
        
            sql = "SELECT * FROM college_degrees WHERE college_id=%d" % (int(college_id))
            con.execute(sql)
            res = con.fetchall()
            degrees = []
            for i in res:
                degrees.append(i[2])
                
            return jsonify(degrees=degrees)
        
        if mode == "2":
            country = request.args.get('v')
        
            sql = "SELECT * FROM countries WHERE name='%s'" % (country)
            con.execute(sql)
            res = con.fetchall()
            return str(res[0][3])
        
        if mode == "1" :
            password = request.args.get('password')
            college_id = int(request.args.get('college'))
            degree = request.args.get('degree')
            enrollment_number = int(request.args.get('enrollment_number'))
            entry_year = int(request.args.get('entry_year'))
            passout_year = int(request.args.get('passout_year'))

            email = str(signedup_details[0][4])
            country_code = int(signedup_details[0][5])
            mobile_number = int(signedup_details[0][6])
            college = str(signedup_details[0][7])
            try :
                #Checking Email or Mobile Exists Or Not
                sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isStudentVerified='YES' AND account_status='ACTIVATED'" % (email)
                con.execute(sql)
                res=con.fetchall()
                print("Email Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mail/////////")
                    return jsonify(res=0,error="EMailExist",msg="This Email Is Already Registered With Us.")
            except :
                pass
            try :
                #Checking  Mobile Exists Or Not
                sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND isStudentVerified='YES' AND account_status='ACTIVATED'" % (country_code,mobile_number)
                con.execute(sql)
                res=con.fetchall()
                print("Mobile Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mobile/////////")
                    return jsonify(res=0,error="EMailExist",msg="This Mobile Number Is Already Registered With Us.")
            except :
                pass
            
            try :   
                #Checking For Student Record Exists Or Not
                sql = "SELECT * FROM students WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='YES' AND account_status='ACTIVATED'" % (college,degree,enrollment_number,entry_year,passout_year)
                con.execute(sql)
                res=con.fetchall()
                print("Student Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Student Exist/////////")
                    return jsonify(res=0,error="EMailExist",msg="A Student Record Is Already Registered With Us.")
            except :
                pass   
            
            
            
            
            
            now = datetime.now()
            time = now.strftime("%Y-%m-%d %H:%M:%S")
            
            e_degree = str(signedup_details[0][8])
            e_enrollment_no = int(signedup_details[0][9])
            e_entry_year = int(signedup_details[0][10])
            e_passout_year = int(signedup_details[0][11])
    
            if degree != e_degree :
                return jsonify(res=0,msg="Please Check Your Degree.")
            
            if e_enrollment_no != enrollment_number :
                return jsonify(res=0,msg="Please Check Your Enrollment No.")
            
            if  e_entry_year != entry_year : 
                return jsonify(res=0,msg="Please Check Your Entry Year.")
            
            if e_passout_year != passout_year :
                return jsonify(res=0,msg="Please Check Your Pass-out Year.")
                
            sql = "SELECT * FROM students WHERE email='%s' AND country_code=%d AND mobile_number=%d AND college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isEmailVerified='YES' AND isMobileVerified='NO' AND isStudentVerified='YES' AND account_status='NOT ACTIVATED'" % (email,country_code,mobile_number,college,degree,enrollment_number,entry_year,passout_year)
            con.execute(sql)
            res = con.fetchall()
            if len(res) == 1 :
                sql = "UPDATE students SET first_name='%s',last_name='%s', email='%s',country_code=%d,mobile_number=%d,password='%s',college='%s', degree='%s', enrollment_number=%d, entry_year=%d, passout_year=%d, isEmailVerified='YES', isMobileVerified='NO',isStudentVerified='YES', verification_code='%s',otp=%d, account_status='%s', time='%s'" % (str(signedup_details[0][2]),str(signedup_details[0][3]),email,country_code,mobile_number,password,college,degree,enrollment_number,entry_year,passout_year,str(verification_code),000000,"NOT ACTIVATED",time)
                # print(sql)
                try :
                    con.execute(sql)
                    cnx.commit()
                    inserted_into_db = 1
                except :
                    print("Error In Updating In Database.")
            
            else :
                sql = "INSERT INTO students(first_name,last_name, email,country_code, mobile_number, password, college, degree, enrollment_number, entry_year, passout_year, isEmailVerified, isMobileVerified,isStudentVerified, verification_code,otp, account_status, time) VALUES('%s','%s','%s',%d,%d,'%s','%s','%s',%d,%d,%d,'%s','%s','%s','%s',%d,'%s','%s')" % (str(signedup_details[0][2]),str(signedup_details[0][3]),email,country_code,mobile_number,password,college,degree,enrollment_number,entry_year,passout_year,"YES","NO","YES",str(verification_code),000000,"NOT ACTIVATED",time)
                
                try :
                    con.execute(sql)
                    cnx.commit()
                    inserted_into_db = 1
                except :
                    print("Error In Inserting In Database.")
            
            if inserted_into_db == 1 :
                
                return jsonify(res=1,msg="Sign Up Successfull.")
            else :
                return jsonify(res=0,msg="Unable To Insert.")
     
    sql = "SELECT * FROM colleges"
    con.execute(sql)
    res = con.fetchall()
    colleges = []
    for i in res :
        colleges.append([i[0],i[1]])
        
    print("college : ",colleges)
    
    
    sql = "SELECT * FROM countries"
    con.execute(sql)
    res = con.fetchall()
    countries = []
    for i in res :
        countries.append(i)
 
    sql = "SELECT * FROM countries WHERE phonecode=%d" % (int(signedup_details[0][5]))       
    con.execute(sql)
    res = con.fetchall()
    s_country = res[0][2]
    
    sql = "SELECT * FROM colleges WHERE college_name='%s'" % (str(signedup_details[0][7]))
    con.execute(sql)
    res = con.fetchall()
    college_id = res[0][0]
    print(college_id)
    con.close()
    return render_template('alumni_custom_signup.html',colleges=colleges,total_colleges=len(colleges),countries=countries,signedup_details=signedup_details,s_country=s_country,college_id=college_id,verification_code=verification_code)

@app.route('/alumni/custom/verify/email/<string:verification_code>')
def alumni_custom_verify_email(verification_code):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    signedup_details = [] 
           
    sql = "SELECT * FROM students WHERE verification_code='%s' AND isEmailVerified='YES' AND isMobileVerified='NO' AND isStudentVerified='YES'" % (str(verification_code))
    con.execute(sql)
    signedup_details = con.fetchall()
    
    if len(signedup_details) == 1 :
        pass
    else :
        return redirect(url_for("alumni_signup"))
    
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            m_n = int(signedup_details[0][5])
            c_c = int(signedup_details[0][4])
            #Checking  Mobile Exists Or Not
            sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND verification_code='%s'" % (c_c,m_n,verification_code)
            con.execute(sql)
            res=con.fetchall()
            print("Mobile Exist : ",len(res))
            if len(res) == 1 :
                print("Erroor Mobile/////////")
                return jsonify(res=0,error="EMailExist",msg="This Mobile Number Is Already Registered With Us.")
            else :
                otp = random.randrange(111111,999999)
              
                sql = "UPDATE students SET country_code=%d,mobile_number=%d,isMobileVerified='NO',otp=%d WHERE verification_code='%s'" % (c_c,m_n,otp,verification_code)
                con.execute(sql)
                cnx.commit()
                
                country_code = "+"+str(c_c).strip()
                mobile_no = str(m_n)
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Welcome To Alumni Association Of Goa. Your OTP is '+str(otp)

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                    ms =  'The OTP is sent succssfully to '+str(final_mobile_no)+'.'
                    return jsonify(res=1,msg=ms)
                else :
                    return jsonify(res=0,error='UnableSMS',msg="Unable To Send SMS.\nPlease Try Again Later.")
        
        if mode == "2" :    
            
            m_n = int(signedup_details[0][5])
            c_c = int(signedup_details[0][4])
            otp = int(request.args.get("otp"))
            
            sql = "SELECT * FROM STUDENTS WHERE verification_code='%s'" % (verification_code)
            con.execute(sql)
            res = con.fetchall()
            d_otp = int(res[0][16])
            
            if otp == d_otp :
                sql = "UPDATE students SET isMobileVerified='YES',otp=%d,account_status='ACTIVATED' WHERE verification_code='%s'" % (0,verification_code)
                con.execute(sql)
                cnx.commit()
                
                sql = "UPDATE students_added_by_college SET isMobileVerified='YES',isEmailVerified='YES',isStudentVerified='YES',otp=%d,account_status='ACTIVATED' WHERE verification_code='%s'" % (0,verification_code)
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1)
            else :
                return jsonify(res=0,error="InvalidOTP",msg="Invalid OTP.")
                
                
            
            
    
    if len(verification_code) == 0 :
        return redirect(url_for('alumni_signup'))
    else :
        sql = "SELECT * FROM students WHERE verification_code='%s'" % (verification_code)
        con.execute(sql)
        res = con.fetchall()
        country_code = "+"+str(res[0][4])
        mobile_no = str(res[0][5])
        isEmailVerified = str(res[0][12])
        isMobileVerified = str(res[0][13])
        if len(res) == 1 :
            if isEmailVerified == "YES" :
                
                if isMobileVerified == "YES" :
                    flash("You Have Verified Email & Mobile Number Successfully.")
                else :
                    flash("Your Email Is Already Verified.")
            else :
                sql = "UPDATE students SET isEmailVerified='YES' WHERE verification_code='%s'" % (verification_code)
                con.execute(sql)
                cnx.commit()
                
                flash("Your Email Is Verified Successfully.")
                
    isBothVerified = 0
    if isEmailVerified == "YES" and isMobileVerified == "YES" :
        isBothVerified = 1
    else :
        isBothVerified = 0
    print(isBothVerified)
    con.close()
    return render_template('alumni_custom_email_verification.html',country_code=country_code,mobile_no=mobile_no,verification_code=verification_code,isBothVerified=isBothVerified)


@app.route('/alumni/verify/email/<string:verification_code>')
def alumni_verify_email(verification_code):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            m_n = int(request.args.get("mobile_no"))
            c_c = int(request.args.get("country_code"))
            #Checking  Mobile Exists Or Not
            sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND verification_code='%s'" % (c_c,m_n,verification_code)
            con.execute(sql)
            res=con.fetchall()
            print("Mobile Exist : ",len(res))
            if len(res) == 1 :
                print("Erroor Mobile/////////")
                return jsonify(res=0,error="EMailExist",msg="This Mobile Number Is Already Registered With Us.")
            else :
                otp = random.randrange(111111,999999)
              
                sql = "UPDATE students SET country_code=%d,mobile_number=%d,isMobileVerified='NO',otp=%d WHERE verification_code='%s'" % (c_c,m_n,otp,verification_code)
                con.execute(sql)
                cnx.commit()
                
                country_code = "+"+str(request.args.get("country_code")).strip()
                mobile_no = str(request.args.get("mobile_no"))
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Welcome To Alumni Association Of Goa. Your OTP is '+str(otp)

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                    return jsonify(res=1)
                else :
                    return jsonify(res=0,error='UnableSMS',msg="Unable To Send SMS.\nPlease Try Again Later.")
        
        if mode == "2" :    
            
            m_n = int(request.args.get("mobile_no"))
            c_c = int(request.args.get("country_code"))
            otp = int(request.args.get("otp"))
            
            sql = "SELECT * FROM STUDENTS WHERE verification_code='%s'" % (verification_code)
            con.execute(sql)
            res = con.fetchall()
            d_otp = int(res[0][16])
            
            
            
            if otp == d_otp :
                sql = "UPDATE students SET isMobileVerified='YES',otp=%d,account_status='NOT ACTIVATED' WHERE verification_code='%s'" % (0,verification_code)
                con.execute(sql)
                cnx.commit()
                try :
                    sql = "SELECT * FROM students_added_by_college WHERE verification_code='%s' AND country_code=%d AND mobile_number=%d AND isEmailVerified='NO' AND isMobileVerified='NO'" % (verification_code,c_c,m_n)
                    con.execute(sql)
                    res = con.fetchall()
                    if len(res) == 1 :
                        sql = "UPDATE students SET isStudentVerified='YES',account_status='ACTIVATED' WHERE verification_code='%s'" % (verification_code)
                        con.execute(sql)
                        cnx.commit()
                        
                        sql = "UPDATE students_added_by_college SET isEmailVerified='YES',isMobileVerified='YES',isStudentVerified='YES',account_status='ACTIVATED' WHERE verification_code='%s' AND country_code=%d AND mobile_number=%d" % (verification_code,c_c,m_n)
                        con.execute(sql)
                        cnx.commit()
                        
                    else :
                        pass
                    
                    return jsonify(res=1)
                except :
                    return jsonify(res=0,error="",msg="Eror In Updating Account Status.")
                    
            else :
                return jsonify(res=0,error="InvalidOTP",msg="Invalid OTP.")
                
                
            
            
    
    if len(verification_code) == 0 :
        return redirect(url_for('alumni_signup'))
    else :
        sql = "SELECT * FROM STUDENTS WHERE verification_code='%s'" % (verification_code)
        con.execute(sql)
        res = con.fetchall()
        country_code = "+"+str(res[0][4])
        mobile_no = str(res[0][5])
        isEmailVerified = str(res[0][12])
        isMobileVerified = str(res[0][13])
        if len(res) == 1 :
            if isEmailVerified == "YES" :
                
                if isMobileVerified == "YES" :
                    flash("You Have Verified Email & Mobile Number Successfully.")
                else :
                    flash("Your Email Is Already Verified.")
            else :
                sql = "UPDATE students SET isEmailVerified='YES' WHERE verification_code='%s'" % (verification_code)
                con.execute(sql)
                cnx.commit()
                
                flash("Your Email Is Verified Successfully.")
                
    isBothVerified = 0
    if isEmailVerified == "YES" and isMobileVerified == "YES" :
        isBothVerified = 1
    else :
        isBothVerified = 0
    print(isBothVerified)
    con.close()
    return render_template('alumni_email_verification.html',country_code=country_code,mobile_no=mobile_no,verification_code=verification_code,isBothVerified=isBothVerified)




@app.route('/alumni/login/')
def alumni_login():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    accountActivated = 0
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = request.args.get('email')
            password = request.args.get('password')
            
            print(email)
            print(password)
            
            sql = "SELECT * FROM students WHERE email='%s' AND password='%s'" % (email,password)
            con.execute(sql)
            res = con.fetchall()
            print("execured")
            if len(res) >= 1 :
                sql = "SELECT * FROM students WHERE email='%s' AND password='%s' AND isEmailVerified='YES'" % (email,password)
                con.execute(sql)
                res = con.fetchall()
                print("e2")
                if len(res) >= 1 :
                    sql = "SELECT * FROM students WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email,password)
                    con.execute(sql)
                    res = con.fetchall()
                    print("e3")
                    print(res)
                    if len(res) == 1 :
                        sql = "SELECT * FROM students WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (email,password)
                        con.execute(sql)
                        res = con.fetchall()
                        print("e4")
                        if len(res) == 1 :
                            sql = "SELECT * FROM students WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES' AND account_status='ACTIVATED'" % (email,password)
                            con.execute(sql)
                            res = con.fetchall()
                            print("e5")
                            if len(res) == 1 :
                                accountActivated = 1
                                session['alumni_login_id'] = int(res[0][0])
                                session['alumni_login_email'] = email
                                session['alumni_account_activated'] = 1
                                print("e5")
                                return jsonify(res=1,error="No",msg="Successfully Logged In.") 
                            else :
                                print("e6")
                                return jsonify(res=0,error="NoSpocSpocReject",msg="Your Application Is Rejected, Please Apply Again.")
                        else :
                            print("e6")
                            return jsonify(res=0,error="NoSpocVerified",msg="You Account Is Not Verified By College.")
                            # return redirect(url_for('association_home'))
                    else :
                      return jsonify(res=0,error="NoMobileVerified",msg="Please Verify Your Mobile No. To Login.")  
                    
                else :
                   return jsonify(res=0,error="NoEmailVerified",msg="Please Verify Your Email To Login.") 
            else :
                print("c1")
                return jsonify(res=0,error="NoAccountFound",msg="Please Enter Correct Username & Password.")     
        
        if mode == "2":
            email = request.args.get('email')
            
            print(email)
            
            sql = "SELECT * FROM students WHERE email='%s'" % (email)
            con.execute(sql)
            res = con.fetchall()
            print("execured")
            if len(res) >= 1 :
                sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES'" % (email)
                con.execute(sql)
                res = con.fetchall()
                print("e2")
                if len(res) >= 1 :
                    sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email)
                    con.execute(sql)
                    res = con.fetchall()
                    print("e3")
                    print(res)
                    if len(res) == 1 :
                        sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (email)
                        con.execute(sql)
                        res = con.fetchall()
                        print("e4")
                        if len(res) == 1 :
                            sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES' AND account_status='ACTIVATED'" % (email)
                            con.execute(sql)
                            res = con.fetchall()
                            print("e5")
                            if len(res) == 1 :
                                accountActivated = 1
                                session['alumni_login_id'] = int(res[0][0])
                                session['alumni_login_email'] = email
                                session['alumni_account_activated'] = 1
                                print("e5")
                                return jsonify(res=1,error="No",msg="Successfully Logged In.") 
                            else :
                                print("e6")
                                sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES' AND account_status='REJECTED'" % (email)
                                con.execute(sql)
                                res = con.fetchall()
                                print("e5")
                                if len(res) == 1 :
                                    return jsonify(res=0,error="NoSpocSpocReject",msg="Your Application Is Rejected, Please Apply Again.")
                                else :
                                    return jsonify(res=0,error="NoSpocSpocReject",msg="Your Account Is Not Activated Yet.")

                        else :
                            print("e6")
                            return jsonify(res=0,error="NoSpocVerified",msg="You Account Is Not Verified By College.")
                            # return redirect(url_for('association_home'))
                    else :
                      return jsonify(res=0,error="NoMobileVerified",msg="Please Verify Your Mobile No. To Login.")  
                    
                else :
                   return jsonify(res=0,error="NoEmailVerified",msg="Please Verify Your Email To Login.") 
            else :
                print("c1")
                return jsonify(res=0,error="NoAccountFound",msg="We Can't Find Account With This Email.")     
                  
    con.close()
    
    return render_template('alumni_login.html')

@app.route('/alumni/home/',methods=['GET','POST'])
def alumni_home():
    if 'alumni_login_id' not in session :
        return redirect(url_for('alumni_login'))
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    
    
    con.close()
    return render_template("alumni_home.html")

@app.route('/alumni/jobs/',methods=['GET','POST'])
def alumni_jobs():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if 'alumni_login_id' not in session :
        return redirct(url_for('alumni_login'))
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        
        if mode == 3 :
            work_id = int(request.form['work_id'])
            
            now = datetime.now()
            d_t = now.strftime("%Y-%m-%d %H:%M:%S")
            sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND work_id=%d" % (int(session['alumni_login_id']),int(work_id))
            con.execute(sql)
            res = con.fetchall()
            if len(res) == 0 :
                try :
                    sql = "INSERT INTO alumni_recruiters(alumni_id,work_id,isActive,date_time) VALUES(%d,%d,'NO','%s')" % (int(session['alumni_login_id']),int(work_id),d_t)
                    con.execute(sql)
                    cnx.commit()
                    flash(Markup("<p style='font-size:15px;color:green;'>You Have  Applied For This Company For Recruiter Successfully.</p>"))
                    return redirect(url_for('alumni_jobs'))
                except :
                    flash(Markup("<p style='font-size:15px;color:red;'>Error In Applying For This Company Recruiter.</p>"))
                    return redirect(url_for('alumni_jobs')) 
            else :
                sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND work_id=%d AND isActive='YES'" % (int(session['alumni_login_id']),int(work_id))
                con.execute(sql)
                res = con.fetchall()
                if len(res) == 1 :
                    flash(Markup("<p style='font-size:15px;color:green;'>You Have Already Accepted For This Company Recruiter.</p>"))
                    return redirect(url_for('alumni_jobs'))
                else :
                    flash(Markup("<p style='font-size:15px;color:red;'>You Have Already Applied For This Company Recruiter.</p>"))
                    return redirect(url_for('alumni_jobs'))
            
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM alumni_work_details WHERE alumni_id=%d AND isWorkingNow='YES'" % (int(session['alumni_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Alumni : Error In Getting Work Details Of Alumni For Recruiter")
        
    my_college = ""
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        my_college = res[0][7]
    except :
        print("Alumni : Error In Gettin College Details.")
        
    all_jobs = []
    try :
        sql = "SELECT * FROM jobs WHERE job_allowed_other_college='YES' ORDER BY date_time DESC"
        con.execute(sql)
        res = con.fetchall()

        for i in res :
            i = list(i)
            user_id = int(i[1]) 
            job_id = int(i[0])
            sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
            con.execute(sql)
            
            res2 = con.fetchall()
            f_date = datetime.now()
            l_date = i[11]
            c = f_date - l_date
            ago_days = c.days
            
            total_applied = 0
            
            sql = "SELECT * FROM job_applicants WHERE job_id=%d" % (int(job_id))
            con.execute(sql)
            
            res3 = con.fetchall()
            total_applied = len(res3)
            i.append(ago_days)
            i.append(total_applied)
            all_jobs.append(i)            
    except :
          print("Alumni Error In Getting All Job Details.")
          
    my_college_jobs = [] 
    
    try :
        sql = "SELECT * FROM jobs ORDER BY date_time DESC"
        con.execute(sql)
        res = con.fetchall()

        for i in res :
            i = list(i)
            user_id = int(i[1]) 
            job_id = int(i[0])
            sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
            con.execute(sql)
            
            res2 = con.fetchall()
            f_date = datetime.now()
            l_date = i[11]
            c = f_date - l_date
            ago_days = c.days
            
            sql = "SELECT * FROM job_applicants WHERE job_id=%d" % (int(job_id))
            con.execute(sql)
            
            res3 = con.fetchall()
            total_applied = len(res3)
            
               
            if str(res2[0][7]) == str(my_college) :
                print("same college")
                i.append(ago_days)
                i.append(total_applied)
                my_college_jobs.append(i) 
    
    except :
          print("Alumni Error In Getting Job Details.")

    print(my_college_jobs)
    con.close()
    return render_template("alumni_jobs.html",profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),all_jobs=all_jobs,l_all_jobs=len(all_jobs),my_college_jobs=my_college_jobs,l_my_college_jobs=len(my_college_jobs))
 
@app.route('/alumni/add/job/',methods=['GET','POST'])
def alumni_add_job():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if 'alumni_login_id' not in session :
        return redirct(url_for('alumni_login'))
    
    if request.method == "POST" :
        job_company_name = str(request.form['job_company_name'])
        job_desc = str(request.form['job_desc'])
        
        job_designation = str(request.form['job_designation']).strip()
        job_salary = str(request.form['job_salary']).strip()
        job_location = str(request.form['job_location']).strip()
        job_deadline = request.form['job_deadline']
        job_allowed_other_college = str(request.form['job_allowed_other_college'])
        job_special_requirements = str(request.form['job_special_requirements'])
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")
        
        session['job_company_name'] = job_company_name
        session['job_desc'] = job_desc
        
        session['job_designation'] = job_designation
        session['job_salary'] = job_salary
        session['job_location'] = job_location
        session['job_deadline'] = job_deadline
        session['job_special_requirements'] = job_special_requirements
        session['job_allowed_other_college'] = job_allowed_other_college
        
        
        if len(job_desc) == 0 or job_desc == "":
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Description.</p>"))
            return redirect(url_for('alumni_add_job'))
        if len(job_designation) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Designation.</p>"))
            return redirect(url_for('alumni_add_job'))
        
        if len(job_salary) == 0:
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Salary.</p>"))
            return redirect(url_for('alumni_add_job'))
        
        if len(job_location) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Location.</p>"))
            return redirect(url_for('alumni_add_job'))
        
        
        isInserted = 0
        j_a_d = datetime.strptime(job_deadline,"%m/%d/%Y")
        job_application_deadline = j_a_d.strftime("%Y-%m-%d")
        
        try :
            sql = "INSERT INTO jobs(alumni_id,job_company_name,job_desc,job_designation,job_salary,job_location,job_deadline,job_special_requirements,job_allowed_other_college,total_views,date_time) VALUES (%d,'%s','%s','%s','%s','%s','%s','%s','%s',%d,'%s')" % (int(session['alumni_login_id']),str(job_company_name),str(job_desc),str(job_designation),str(job_salary),str(job_location),job_application_deadline,str(job_special_requirements),str(job_allowed_other_college),0,d_t)
            con.execute(sql)
            cnx.commit()
            
            session['job_company_name'] = ""
            session['job_desc'] = ""   
            session['job_designation'] = ""
            session['job_salary'] = ""
            session['job_location'] = ""
            session['job_deadline'] = ""
            session['job_special_requirements'] = ""
            session['job_allowed_other_college'] = ""
            isInserted = 1
        except :
            print("Alumni : Error In Inserting Job Details.")
        
        if isInserted == 1 :
            flash(Markup("<p style='font-size:15px;color:green;'>Job Posted Successfully.</p>"))
            return redirect(url_for('alumni_jobs'))
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Posting Jobs.</p>"))
            return redirect(url_for('alumni_jobs'))
            
        
        
    isAlumniAllowedForJobPost = 0
    try :
        sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND isActive='YES'" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        if len(res) >= 1 :
            isAlumniAllowedForJobPost = 1
    except :
        print("Alumni : Error In Getting  Of Alumni For Recruiter")
        
    profile_work_details = []
    if isAlumniAllowedForJobPost == 0 :
        flash(Markup("<p style='font-size:15px;color:red;'>You Are Not Allowed To Post Job.</p>"))
        return redirect(url_for('alumni_jobs'))
    else :
        for i in res :
            sql = "SELECT * FROM alumni_work_details WHERE id=%d" % (int(i[2]))
            con.execute(sql)
            res2 = con.fetchall()
            profile_work_details.append(res2[0])
   
    con.close()
    today_date = datetime.now()
    today_date = today_date.strftime("%m/%d/%Y")
    # print(profile_work_details)
    return render_template("alumni_add_job.html",profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),today_date=today_date)
    
@app.route('/alumni/job/<int:job_id>',methods=['GET','POST'])
def alumni_view_jobs(job_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isloggedIn = "NO"
    isAllowedToApply = "NO"
    al_details = []
    if 'alumni_login_id' in session :
        isloggedIn = "YES"
        
 
    
    if request.method == "POST" :
        file = request.files['resume-file']
        c_dirName = "static/uploads/alumni_job_resumes/"

        try :
            os.mkdir(c_dirName)         
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")
        isUploaded = 0
        path = ""
        try : 
            r = str(uuid.uuid1()).replace("-","_")
            path = "static/uploads/alumni_job_resumes/"+str(session['alumni_login_id'])+"_"+str(r)+"_"+file.filename
            file.save(path)
            isUploaded = 1
            print("File Uploaded")
                
        except :
            print("Alumni : Error In Uploading C.V.")
            
        isInserted = 0
        if isUploaded == 1 :
            try :
               now = datetime.now()
               d_t = now.strftime("%Y-%m-%d %H:%M:%S")
               
               sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
               con.execute(sql)
               p_details = con.fetchall()
               name = p_details[0][1] + " " + p_details[0][2]
               m_n = str(p_details[0][4])+str(p_details[0][5])
               print((int(job_id),int(session['alumni_login_id']),str(name),str(p_details[0][3]),int(m_n),str(path),d_t))
               sql = "INSERT INTO job_applicants(job_id,alumni_id,name,email,mobile_no,resume,time) VALUES (%d,%d,'%s','%s',%d,'%s','%s')" % (int(job_id),int(session['alumni_login_id']),str(name),str(p_details[0][3]),int(m_n),str(path),d_t)
               con.execute(sql)
               cnx.commit()
               isInserted = 1
            except :
               print("Alumni : Error In Inserting Job Applicant Details.")
               
            if isInserted == 1 :
                flash(Markup("<p style='font-size:15px;color:green;'>You Applied For This Job Successfully.</p>"))
                return redirect(url_for("alumni_view_jobs",job_id=job_id))
            else :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Job Applicant Details.</p>"))
                return redirect(url_for("alumni_view_jobs",job_id=job_id))
            
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Uploading Resume.</p>"))
            return redirect(url_for("alumni_view_jobs",job_id=job_id))
    
    job_details = []
    sql = "SELECT * FROM jobs WHERE job_id=%d" % (int(job_id))          
    con.execute(sql)
    
    job_details = con.fetchall()
    if len(job_details) == 0 :
        return redirect(url_for('index'))
    my_college = ""
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        my_college = res[0][7]
    except :
        print("Alumni : Error In Gettin College Details.")
        
    
    alumni_id = job_details[0][1]
    alumni_profile = []
    
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (alumni_id)
        con.execute(sql)
        alumni_profile = con.fetchall()

    except :
        print("Error In Getting Job Poster Profile.")
        
    if job_details[0][9] == "YES" :
         isAllowedToApply = "YES" 
    else :
        if str(my_college) == str(alumni_profile[0][7]) :
            isAllowedToApply = "YES"
        else :
            isAllowedToApply = "NO"
    
    f_date = datetime.now()
    print(f_date)
    l_date = datetime(job_details[0][7].year,job_details[0][7].month,job_details[0][7].day)
    print(l_date)
    isOverdue = "NO"
    if f_date <= l_date :
        isOverdue = "NO"
    else :
        isOverdue = "YES"
        
    isAlreadyApplied = "NO"
    try :
        sql = "SELECT * FROM job_applicants WHERE job_id=%d AND alumni_id=%d" % (int(job_id),int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        if len(res) == 1 :
            isAlreadyApplied = "YES"
    except :
        print("Alumni Error In Comparing With job_applicants.")
    return render_template("alumni_view_job.html",isloggedIn=isloggedIn,isAllowedToApply=isAllowedToApply,job_details=job_details,alumni_profile=alumni_profile,isOverdue=isOverdue,isAlreadyApplied=isAlreadyApplied)

@app.route('/alumni/job/statistics/',methods=['GET','POST'])
def alumni_jobs_statistics():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isloggedIn = "NO"
    isAllowedToApply = "NO"
    al_details = []
    if 'alumni_login_id' in session :
        isloggedIn = "YES"
        
 
    
    if request.method == "POST" :
        file = request.files['resume-file']
        c_dirName = "static/uploads/alumni_job_resumes/"

        try :
            os.mkdir(c_dirName)         
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")
        isUploaded = 0
        path = ""
        try : 
            r = str(uuid.uuid1()).replace("-","_")
            path = "static/uploads/alumni_job_resumes/"+str(session['alumni_login_id'])+"_"+str(r)+"_"+file.filename
            file.save(path)
            isUploaded = 1
            print("File Uploaded")
                
        except :
            print("Alumni : Error In Uploading C.V.")
            
        isInserted = 0
        if isUploaded == 1 :
            try :
               now = datetime.now()
               d_t = now.strftime("%Y-%m-%d %H:%M:%S")
               
               sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
               con.execute(sql)
               p_details = con.fetchall()
               name = p_details[0][1] + " " + p_details[0][2]
               m_n = str(p_details[0][4])+str(p_details[0][5])
               print((int(job_id),int(session['alumni_login_id']),str(name),str(p_details[0][3]),int(m_n),str(path),d_t))
               sql = "INSERT INTO job_applicants(job_id,alumni_id,name,email,mobile_no,resume,time) VALUES (%d,%d,'%s','%s',%d,'%s','%s')" % (int(job_id),int(session['alumni_login_id']),str(name),str(p_details[0][3]),int(m_n),str(path),d_t)
               con.execute(sql)
               cnx.commit()
               isInserted = 1
            except :
               print("Alumni : Error In Inserting Job Applicant Details.")
               
            if isInserted == 1 :
                flash(Markup("<p style='font-size:15px;color:green;'>You Applied For This Job Successfully.</p>"))
                return redirect(url_for("alumni_view_jobs",job_id=job_id))
            else :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Job Applicant Details.</p>"))
                return redirect(url_for("alumni_view_jobs",job_id=job_id))
            
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Uploading Resume.</p>"))
            return redirect(url_for("alumni_view_jobs",job_id=job_id))
    
    job_details = []
    sql = "SELECT * FROM jobs WHERE alumni_id=%d" % (int(session['alumni_login_id']))          
    con.execute(sql)
    
    res = con.fetchall()
    participants = []
    k = 0
    for i in res :
        job_id = int(i[0])
        t = list(i)
        sql = "SELECT * FROM job_applicants WHERE job_id=%d" % (job_id)
        con.execute(sql)
        res2 = con.fetchall()
        participants.append(res2)
        t.append(len(res2))
        job_details.append(t)
        
    print(job_details)
    return render_template("alumni_job_statistics.html",job_details=job_details)

# alumni/job/statistics/download/{{i[0]}}
@app.route('/alumni/job/statistics/download/<int:job_id>',methods=['GET','POST'])
def alumni_download_job_reports(job_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()

    sql = "SELECT * FROM jobs WHERE job_id=%d" % (job_id)
    con.execute(sql)
    res = con.fetchall()
    
    if len(res) == 0 :
        return redirect(url_for('index'))
    else :
        alumni_id = res[0][1]
        if alumni_id != int(session['alumni_login_id']) :
            return redirect(url_for('index'))
    
    sql = "SELECT * FROM job_applicants WHERE job_id=%d" % (job_id)
    con.execute(sql)
    res = con.fetchall()
    
    if len(res) == 0 :
        flash(Markup("<p style='font-size:15px;color:red;'>No Applicants Found For The Job.</p>"))
        return redirect(url_for('alumni_jobs_statistics'))
    
    c_dirName = "static/uploads/alumni_job_applicant_reports/"

    try :
        os.mkdir(c_dirName)                
    except FileExistsError:
        print("Directory " + c_dirName + " already exists")

    path = c_dirName+"JOB_APPLICANTS_"+str(uuid.uuid1())+".xlsx"        
    workbook = xlsxwriter.Workbook(path) 
    worksheet = workbook.add_worksheet("Job Applicants") 
    worksheet.write('A1', 'Sr. No.') 
    worksheet.write('B1', 'Name') 
    worksheet.write('C1', 'Email') 
    worksheet.write('D1', 'Mobile No.') 
    worksheet.write('E1', 'Resume') 
    worksheet.write('F1', 'Date Time') 
    
    # for i in res :
    row = 1
    records = 1
    for i in res :
        column = 0
        worksheet.write(row, column, str(records)) 
        column += 1
        worksheet.write(row, column, str(i[3])) 
        column += 1
        worksheet.write(row, column, str(i[4]))
        column += 1
        worksheet.write(row, column, str("+")+str(i[5])) 
        column += 1
        worksheet.write(row, column, str("http://127.0.0.1:5000/")+str(i[6]))
        column += 1
        t = i[7].strftime("%Y-%m-%d %I:%M:%S %p")
        worksheet.write(row, column, str(t))
        row += 1
        records += 1
    workbook.close() 

    con.close()
    
    return redirect("../../../../"+path)

@app.route('/alumni/job/statistics/extract/<int:job_id>',methods=['GET','POST'])
def alumni_extract_job_reports(job_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    job_details = []    
    sql = "SELECT * FROM jobs WHERE job_id=%d" % (job_id)
    con.execute(sql)
    job_details = con.fetchall()
    
    if len(job_details) == 0 :
        return redirect(url_for('index'))
    else :
        alumni_id = job_details[0][1]
        if alumni_id != int(session['alumni_login_id']) :
            return redirect(url_for('index'))
    
    sql = "SELECT * FROM job_applicants WHERE job_id=%d" % (job_id)
    con.execute(sql)
    res = con.fetchall()
    
    if len(res) == 0 :
        flash(Markup("<p style='font-size:15px;color:red;'>No Job Applocants Found, Can't Extract Now.</p>"))
        return redirect(url_for('alumni_jobs_statistics'))
    
    if request.method == "POST" :
        keywords = str(request.form['post_tag_value'])[1:]
        if len(keywords) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Keywords To Extract.</p>"))
            return redirect(url_for('alumni_extract_job_reports',job_id=job_id))
            
        c_dirName = "static/uploads/alumni_job_applicant_extract_reports/"

        try :
            os.mkdir(c_dirName)                
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")
        path = ""
        isExcelCreated = 0
        try :
            path = c_dirName+"JOB_EXTRACT_APPLICANTS_"+str(uuid.uuid1())+".xlsx"        
            workbook = xlsxwriter.Workbook(path) 
            worksheet = workbook.add_worksheet("Job Applicants") 
            worksheet.write('A1', 'Sr. No.') 
            worksheet.write('B1', 'Name') 
            worksheet.write('C1', 'Email') 
            worksheet.write('D1', 'Mobile No.') 
            worksheet.write('E1', 'Resume') 
            worksheet.write('F1', 'Date Time') 
            
            # for i in res :
            row = 1
            records = 1
            for i in res :
                column = 0
                worksheet.write(row, column, str(records)) 
                column += 1
                worksheet.write(row, column, str(i[3])) 
                column += 1
                worksheet.write(row, column, str(i[4]))
                column += 1
                worksheet.write(row, column, str("+")+str(i[5])) 
                column += 1
                worksheet.write(row, column, str("http://127.0.0.1:5000/")+str(i[6]))
                column += 1
                t = i[7].strftime("%Y-%m-%d %I:%M:%S %p")
                worksheet.write(row, column, str(t))
                row += 1
                records += 1
            workbook.close()
            isExcelCreated = 1
        
        except :
            print("Unable To Create Report Please Try Again.")

        
        if isExcelCreated == 1 :
            now = datetime.now()
            d_t = now.strftime('%Y-%m-%d %H:%M:%S')
            try : 
                
                sql = "INSERT INTO cron_resume_extraction(job_id,alumni_id,keywords,path,result_path,status,isEmailSent,date_time) VALUES (%d,%d,'%s','%s','%s','%s','%s','%s')" % (int(job_id),int(session['alumni_login_id']),str(keywords),path,"","PENDING","NO",d_t)
                con.execute(sql)
                cnx.commit()
                flash(Markup("<p style='font-size:15px;color:green;'>Extraction Successful We'll Notify You By Email.</p>"))
                return redirect(url_for('alumni_extract_job_reports',job_id=job_id))
            except :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Keywords.</p>"))
                return redirect(url_for('alumni_extract_job_reports',job_id=job_id))
              
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Unable To Create Report Please Try Again.</p>"))
            return redirect(url_for('alumni_extract_job_reports',job_id=job_id))
    con.close()
    
    return render_template('alumni_job_extract.html',job_details=job_details)

@app.route('/alumni/job/edit/<int:job_id>',methods=['GET','POST'])
def alumni_edit_job(job_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    job_details = []
    
    sql = "SELECT * FROM jobs WHERE job_id=%d AND alumni_id=%d" % (job_id,int(session['alumni_login_id']))
    con.execute(sql)
    job_details= con.fetchall()
    
    if len(job_details) == 0 :
        return redirect(url_for('index'))
   
    if request.method == "POST" :
        job_desc = str(request.form['job_desc'])        
        job_salary = str(request.form['job_salary']).strip()
        job_location = str(request.form['job_location']).strip()
        job_deadline = request.form['job_deadline']
        job_allowed_other_college = str(request.form['job_allowed_other_college'])
        job_special_requirements = str(request.form['job_special_requirements'])
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")

        if len(job_desc) == 0 or job_desc == "":
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Description.</p>"))
            return redirect(url_for('alumni_edit_job',job_id=job_id))

        if len(job_salary) == 0:
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Salary.</p>"))
            return redirect(url_for('alumni_edit_job',job_id=job_id))
        
        if len(job_location) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Location.</p>"))
            return redirect(url_for('alumni_edit_job',job_id=job_id))
        
        
        isInserted = 0
        j_a_d = datetime.strptime(job_deadline,"%m/%d/%Y")
        job_application_deadline = j_a_d.strftime("%Y-%m-%d")
        
        try :
            sql = "UPDATE jobs SET job_desc='%s',job_salary='%s',job_location='%s',job_deadline='%s',job_special_requirements='%s',job_allowed_other_college='%s' WHERE job_id=%d AND alumni_id=%d" % (str(job_desc),str(job_salary),str(job_location),job_application_deadline,str(job_special_requirements),str(job_allowed_other_college),int(job_id),int(session['alumni_login_id']))
            con.execute(sql)
            cnx.commit()
            
            session['job_desc'] = ""   
            session['job_salary'] = ""
            session['job_location'] = ""
            session['job_deadline'] = ""
            session['job_special_requirements'] = ""
            session['job_allowed_other_college'] = ""
            isInserted = 1
        except :
            print("Alumni : Error In Updating Job Details.")
        
        if isInserted == 1 :
            flash(Markup("<p style='font-size:15px;color:green;'>Job Details Updated Successfully.</p>"))
            return redirect(url_for('alumni_edit_job',job_id=job_id))
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Updating Job Details.</p>"))
            return redirect(url_for('alumni_edit_job',job_id=job_id))
    
    
    return render_template("alumni_edit_job.html",job_details=job_details)


@app.route('/alumni/internships/',methods=['GET','POST'])
def alumni_internships():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if 'alumni_login_id' not in session :
        return redirct(url_for('alumni_login'))
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        
        if mode == 3 :
            work_id = int(request.form['work_id'])
            
            now = datetime.now()
            d_t = now.strftime("%Y-%m-%d %H:%M:%S")
            sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND work_id=%d" % (int(session['alumni_login_id']),int(work_id))
            con.execute(sql)
            res = con.fetchall()
            if len(res) == 0 :
                try :
                    sql = "INSERT INTO alumni_recruiters(alumni_id,work_id,isActive,date_time) VALUES(%d,%d,'NO','%s')" % (int(session['alumni_login_id']),int(work_id),d_t)
                    con.execute(sql)
                    cnx.commit()
                    flash(Markup("<p style='font-size:15px;color:green;'>You Have  Applied For This Company For Recruiter Successfully.</p>"))
                    return redirect(url_for('alumni_internships'))
                except :
                    flash(Markup("<p style='font-size:15px;color:red;'>Error In Applying For This Company Recruiter.</p>"))
                    return redirect(url_for('alumni_internships')) 
            else :
                sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND work_id=%d AND isActive='YES'" % (int(session['alumni_login_id']),int(work_id))
                con.execute(sql)
                res = con.fetchall()
                if len(res) == 1 :
                    flash(Markup("<p style='font-size:15px;color:green;'>You Have Already Accepted For This Company Recruiter.</p>"))
                    return redirect(url_for('alumni_internships'))
                else :
                    flash(Markup("<p style='font-size:15px;color:red;'>You Have Already Applied For This Company Recruiter.</p>"))
                    return redirect(url_for('alumni_internships'))
            
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM alumni_work_details WHERE alumni_id=%d AND isWorkingNow='YES'" % (int(session['alumni_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Alumni : Error In Getting Work Details Of Alumni For Recruiter")
        
    my_college = ""
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        my_college = res[0][7]
    except :
        print("Alumni : Error In Gettin College Details.")
        
    all_internships = []
    try :
        sql = "SELECT * FROM internships WHERE internship_allowed_other_college='YES' ORDER BY date_time DESC"
        con.execute(sql)
        res = con.fetchall()

        for i in res :
            i = list(i)
            user_id = int(i[1]) 
            internship_id = int(i[0])
            sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
            con.execute(sql)
            
            res2 = con.fetchall()
            f_date = datetime.now()
            l_date = i[11]
            c = f_date - l_date
            ago_days = c.days
            
            total_applied = 0
            
            sql = "SELECT * FROM internship_applicants WHERE internship_id=%d" % (int(internship_id))
            con.execute(sql)
            
            res3 = con.fetchall()
            total_applied = len(res3)
            i.append(ago_days)
            i.append(total_applied)
            all_internships.append(i)            
    except :
          print("Alumni Error In Getting All Internship Details.")
          
    my_college_internships = [] 
    
    try :
        sql = "SELECT * FROM internships ORDER BY date_time DESC"
        con.execute(sql)
        res = con.fetchall()

        for i in res :
            i = list(i)
            user_id = int(i[1]) 
            internship_id = int(i[0])
            sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
            con.execute(sql)
            
            res2 = con.fetchall()
            f_date = datetime.now()
            l_date = i[11]
            c = f_date - l_date
            ago_days = c.days
            
            sql = "SELECT * FROM internship_applicants WHERE internship_id=%d" % (int(internship_id))
            con.execute(sql)
            
            res3 = con.fetchall()
            total_applied = len(res3)
            
               
            if str(res2[0][7]) == str(my_college) :
                print("same college")
                i.append(ago_days)
                i.append(total_applied)
                my_college_internships.append(i) 
    
    except :
          print("Alumni Error In Getting Internship Details.")

    print(my_college_internships)
    con.close()
    return render_template("alumni_internships.html",profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),all_internships=all_internships,l_all_internships=len(all_internships),my_college_internships=my_college_internships,l_my_college_internships=len(my_college_internships))
 
@app.route('/alumni/add/internship/',methods=['GET','POST'])
def alumni_add_internship():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if 'alumni_login_id' not in session :
        return redirct(url_for('alumni_login'))
    
    if request.method == "POST" :
        job_company_name = str(request.form['job_company_name'])
        job_desc = str(request.form['job_desc'])
        
        job_designation = str(request.form['job_designation']).strip()
        job_duration = str(request.form['job_duration']).strip()
        job_location = str(request.form['job_location']).strip()
        job_deadline = request.form['job_deadline']
        job_allowed_other_college = str(request.form['job_allowed_other_college'])
        job_special_requirements = str(request.form['job_special_requirements'])
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")
        
        session['job_company_name'] = job_company_name
        session['job_desc'] = job_desc
        
        session['job_designation'] = job_designation
        session['job_duration'] = job_duration
        session['job_location'] = job_location
        session['job_deadline'] = job_deadline
        session['job_special_requirements'] = job_special_requirements
        session['job_allowed_other_college'] = job_allowed_other_college
        
        
        if len(job_desc) == 0 or job_desc == "":
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Internship Description.</p>"))
            return redirect(url_for('alumni_add_internship'))
        if len(job_designation) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Internship Designation.</p>"))
            return redirect(url_for('alumni_add_internship'))
        
        if len(job_duration) == 0:
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Internship Duration.</p>"))
            return redirect(url_for('alumni_add_internship'))
        
        if len(job_location) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Internship Location.</p>"))
            return redirect(url_for('alumni_add_internship'))
        
        
        isInserted = 0
        j_a_d = datetime.strptime(job_deadline,"%m/%d/%Y")
        job_application_deadline = j_a_d.strftime("%Y-%m-%d")
        
        try :
            print((int(session['alumni_login_id']),str(job_company_name),str(job_desc),str(job_designation),str(job_duration),str(job_location),job_application_deadline,str(job_special_requirements),str(job_allowed_other_college),0,d_t))
            sql = "INSERT INTO internships(alumni_id,internship_company_name,internship_desc,internship_designation,internship_duration,internship_location,internship_deadline,internship_special_requirement,internship_allowed_other_college,total_views,date_time) VALUES (%d,'%s','%s','%s','%s','%s','%s','%s','%s',%d,'%s')" % (int(session['alumni_login_id']),str(job_company_name),str(job_desc),str(job_designation),str(job_duration),str(job_location),job_application_deadline,str(job_special_requirements),str(job_allowed_other_college),0,d_t)
            con.execute(sql)
            cnx.commit()
            
            session['job_company_name'] = ""
            session['job_desc'] = ""   
            session['job_designation'] = ""
            session['job_duration'] = ""
            session['job_location'] = ""
            session['job_deadline'] = ""
            session['job_special_requirements'] = ""
            session['job_allowed_other_college'] = ""
            isInserted = 1
        except :
            print("Alumni : Error In Inserting Internship Details.")
        
        if isInserted == 1 :
            flash(Markup("<p style='font-size:15px;color:green;'>Internship Posted Successfully.</p>"))
            return redirect(url_for('alumni_internships'))
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Posting Internship.</p>"))
            return redirect(url_for('alumni_add_internship'))
            
        
        
    isAlumniAllowedForJobPost = 0
    try :
        sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND isActive='YES'" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        if len(res) >= 1 :
            isAlumniAllowedForJobPost = 1
    except :
        print("Alumni : Error In Getting  Of Alumni For Recruiter")
        
    profile_work_details = []
    if isAlumniAllowedForJobPost == 0 :
        flash(Markup("<p style='font-size:15px;color:red;'>You Are Not Allowed To Post Internship.</p>"))
        return redirect(url_for('alumni_internships'))
    else :
        for i in res :
            sql = "SELECT * FROM alumni_work_details WHERE id=%d" % (int(i[2]))
            con.execute(sql)
            res2 = con.fetchall()
            profile_work_details.append(res2[0])
   
    con.close()
    today_date = datetime.now()
    today_date = today_date.strftime("%m/%d/%Y")
    # print(profile_work_details)
    return render_template("alumni_add_internship.html",profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),today_date=today_date)
    
@app.route('/alumni/internship/<int:internship_id>',methods=['GET','POST'])
def alumni_view_internships(internship_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isloggedIn = "NO"
    isAllowedToApply = "NO"
    al_details = []
    if 'alumni_login_id' in session :
        isloggedIn = "YES"
        
 
    
    if request.method == "POST" :
        file = request.files['resume-file']
        c_dirName = "static/uploads/alumni_internship_resumes/"

        try :
            os.mkdir(c_dirName)         
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")
        isUploaded = 0
        path = ""
        try : 
            r = str(uuid.uuid1()).replace("-","_")
            path = "static/uploads/alumni_internship_resumes/"+str(session['alumni_login_id'])+"_"+str(r)+"_"+file.filename
            file.save(path)
            isUploaded = 1
            print("File Uploaded")
                
        except :
            print("Alumni : Error In Uploading C.V.")
            
        isInserted = 0
        if isUploaded == 1 :
            try :
               now = datetime.now()
               d_t = now.strftime("%Y-%m-%d %H:%M:%S")
               
               sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
               con.execute(sql)
               p_details = con.fetchall()
               name = p_details[0][1] + " " + p_details[0][2]
               m_n = str(p_details[0][4])+str(p_details[0][5])
               sql = "INSERT INTO internship_applicants(internship_id,alumni_id,name,email,mobile_no,resume,time) VALUES (%d,%d,'%s','%s',%d,'%s','%s')" % (int(internship_id),int(session['alumni_login_id']),str(name),str(p_details[0][3]),int(m_n),str(path),d_t)
               con.execute(sql)
               cnx.commit()
               isInserted = 1
            except :
               print("Alumni : Error In Inserting Internship Applicant Details.")
               
            if isInserted == 1 :
                flash(Markup("<p style='font-size:15px;color:green;'>You Applied For This Internship Successfully.</p>"))
                return redirect(url_for("alumni_view_internships",internship_id=internship_id))
            else :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Internship Applicant Details.</p>"))
                return redirect(url_for("alumni_view_internships",internship_id=internship_id))
            
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Uploading Resume.</p>"))
            return redirect(url_for("alumni_view_internships",internship_id=internship_id))
    
    internship_details = []
    sql = "SELECT * FROM internships WHERE internship_id=%d" % (int(internship_id))          
    con.execute(sql)
    
    internship_details = con.fetchall()
    if len(internship_details) == 0 :
        return redirect(url_for('index'))
    my_college = ""
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        my_college = res[0][7]
    except :
        print("Alumni : Error In Getting College Details.")
        
    
    alumni_id = internship_details[0][1]
    alumni_profile = []
    
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (alumni_id)
        con.execute(sql)
        alumni_profile = con.fetchall()

    except :
        print("Error In Getting Internship Poster Profile.")
        
    if internship_details[0][9] == "YES" :
         isAllowedToApply = "YES" 
    else :
        if str(my_college) == str(alumni_profile[0][7]) :
            isAllowedToApply = "YES"
        else :
            isAllowedToApply = "NO"
    
    f_date = datetime.now()
    print(f_date)
    l_date = datetime(internship_details[0][7].year,internship_details[0][7].month,internship_details[0][7].day)
    print(l_date)
    isOverdue = "NO"
    if f_date <= l_date :
        isOverdue = "NO"
    else :
        isOverdue = "YES"
        
    isAlreadyApplied = "NO"
    try :
        sql = "SELECT * FROM internship_applicants WHERE internship_id=%d AND alumni_id=%d" % (int(internship_id),int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        if len(res) == 1 :
            isAlreadyApplied = "YES"
    except :
        print("Alumni Error In Comparing With job_applicants.")
        
    alumni_profile_image = ""
    try :
        sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(alumni_id))
        con.execute(sql)
        res = con.fetchall()
        alumni_profile_image = res[0][0]
    except :
        print("Error In Getting Alumni Profile Image")
       
    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    random_bg_color = color[0] 
    
    return render_template("alumni_view_internship.html",isloggedIn=isloggedIn,isAllowedToApply=isAllowedToApply,internship_details=internship_details,alumni_profile=alumni_profile,isOverdue=isOverdue,isAlreadyApplied=isAlreadyApplied,alumni_profile_image=alumni_profile_image,random_bg_color=random_bg_color)

@app.route('/alumni/internship/statistics/',methods=['GET','POST'])
def alumni_internship_statistics():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isloggedIn = "NO"
    isAllowedToApply = "NO"
    al_details = []
    if 'alumni_login_id' in session :
        isloggedIn = "YES"
        
 
    internship_details = []
    sql = "SELECT * FROM internships WHERE alumni_id=%d" % (int(session['alumni_login_id']))          
    con.execute(sql)
    
    res = con.fetchall()
    participants = []
    k = 0
    for i in res :
        internship_id = int(i[0])
        t = list(i)
        sql = "SELECT * FROM internship_applicants WHERE internship_id=%d" % (internship_id)
        con.execute(sql)
        res2 = con.fetchall()
        participants.append(res2)
        t.append(len(res2))
        internship_details.append(t)
        
    print(internship_details)
    return render_template("alumni_internship_statistics.html",internship_details=internship_details,l_internship_details=len(internship_details))

# alumni/job/statistics/download/{{i[0]}}
@app.route('/alumni/internship/statistics/download/<int:internship_id>',methods=['GET','POST'])
def alumni_download_internship_reports(internship_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()

    sql = "SELECT * FROM internships WHERE internship_id=%d" % (internship_id)
    con.execute(sql)
    res = con.fetchall()
    
    if len(res) == 0 :
        return redirect(url_for('index'))
    else :
        alumni_id = res[0][1]
        if alumni_id != int(session['alumni_login_id']) :
            return redirect(url_for('index'))
    
    sql = "SELECT * FROM internship_applicants WHERE internship_id=%d" % (internship_id)
    con.execute(sql)
    res = con.fetchall()
    
    if len(res) == 0 :
        flash(Markup("<p style='font-size:15px;color:red;'>No Applicants Found For The Internship.</p>"))
        return redirect(url_for('alumni_internship_statistics'))
    
    c_dirName = "static/uploads/alumni_internship_applicant_reports/"

    try :
        os.mkdir(c_dirName)                
    except FileExistsError:
        print("Directory " + c_dirName + " already exists")

    path = c_dirName+"INTERNSHIP_APPLICANTS_"+str(uuid.uuid1())+".xlsx"        
    workbook = xlsxwriter.Workbook(path) 
    worksheet = workbook.add_worksheet("Internship Applicants") 
    worksheet.write('A1', 'Sr. No.') 
    worksheet.write('B1', 'Name') 
    worksheet.write('C1', 'Email') 
    worksheet.write('D1', 'Mobile No.') 
    worksheet.write('E1', 'Resume') 
    worksheet.write('F1', 'Date Time') 
    
    # for i in res :
    row = 1
    records = 1
    for i in res :
        column = 0
        worksheet.write(row, column, str(records)) 
        column += 1
        worksheet.write(row, column, str(i[3])) 
        column += 1
        worksheet.write(row, column, str(i[4]))
        column += 1
        worksheet.write(row, column, str("+")+str(i[5])) 
        column += 1
        worksheet.write(row, column, str("http://127.0.0.1:5000/")+str(i[6]))
        column += 1
        t = i[7].strftime("%Y-%m-%d %I:%M:%S %p")
        worksheet.write(row, column, str(t))
        row += 1
        records += 1
    workbook.close() 

    
    return redirect("../../../../"+path)

@app.route('/alumni/internship/edit/<int:internship_id>',methods=['GET','POST'])
def alumni_edit_internship(internship_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if 'alumni_login_id' not in session :
        return redirect(url_for('index'))
    
    internship_details = []
    
    sql = "SELECT * FROM internships WHERE internship_id=%d AND alumni_id=%d" % (internship_id,int(session['alumni_login_id']))
    con.execute(sql)
    internship_details = con.fetchall()
    
    if len(internship_details) == 0 :
        return redirect(url_for('index'))
   
    if request.method == "POST" :
        job_desc = str(request.form['job_desc'])       
        # job_location = str(request.form['job_location']).strip() 
        job_duration = str(request.form['job_duration']).strip()
        job_location = str(request.form['job_location']).strip()
        job_deadline = request.form['job_deadline']
        job_allowed_other_college = str(request.form['job_allowed_other_college'])
        job_special_requirements = str(request.form['job_special_requirements'])
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")

        if len(job_desc) == 0 or job_desc == "":
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Job Description.</p>"))
            return redirect(url_for('alumni_edit_internship',internship_id=internship_id))

        if len(job_duration) == 0:
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Internship Duration.</p>"))
            return redirect(url_for('alumni_edit_internship',internship_id=internship_id))
        
        if len(job_location) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Internship Location.</p>"))
            return redirect(url_for('alumni_edit_internship',internship_id=internship_id))
        
        
        isInserted = 0
        j_a_d = datetime.strptime(job_deadline,"%m/%d/%Y")
        job_application_deadline = j_a_d.strftime("%Y-%m-%d")
        
        try :
            print((str(job_desc),str(job_duration),str(job_location),job_application_deadline,str(job_special_requirements),str(job_allowed_other_college),int(internship_id),int(session['alumni_login_id'])))
            sql = "UPDATE internships SET internship_desc='%s',internship_duration='%s',internship_location='%s',internship_deadline='%s',internship_special_requirement='%s',internship_allowed_other_college='%s' WHERE internship_id=%d AND alumni_id=%d" % (str(job_desc),str(job_duration),str(job_location),job_application_deadline,str(job_special_requirements),str(job_allowed_other_college),int(internship_id),int(session['alumni_login_id']))
            print(sql)
            con.execute(sql)
            cnx.commit()
            
            session['job_desc'] = ""   
            session['job_duration'] = ""
            session['job_location'] = ""
            session['job_deadline'] = ""
            session['job_special_requirements'] = ""
            session['job_allowed_other_college'] = ""
            isInserted = 1
        except :
            print("Alumni : Error In Updating internship Details.")
        
        if isInserted == 1 :
            flash(Markup("<p style='font-size:15px;color:green;'>Internship Details Updated Successfully.</p>"))
            return redirect(url_for('alumni_edit_internship',internship_id=internship_id))
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Updating Internship Details.</p>"))
            return redirect(url_for('alumni_edit_internship',internship_id=internship_id))
    
    
    return render_template("alumni_edit_internship.html",internship_details=internship_details)


@app.route('/alumni/fund-raising-project/',methods=['GET','POST'])
def alumni_fund_raising_project():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        f_r_p_title = str(request.form['f_r_p_title']).strip()
        f_r_p_desc = str(request.form['f_r_p_desc']).strip()
        f_r_p_poster_file = request.files['f_r_p_poster_file']
        f_r_p_amount = 0
        if f_r_p_poster_file.filename == "" or len(f_r_p_poster_file.filename) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Upload Featured Image For Project.</p>"))
            return redirect(url_for('alumni_fund_raising_project'))
        try :
            f_r_p_amount = int(request.form['f_r_p_amount'])
            if f_r_p_amount <= 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Amount To Raise.</p>"))
                return redirect(url_for('alumni_fund_raising_project'))
        except :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Amount To Raise .</p>"))
            return redirect(url_for('alumni_fund_raising_project'))
    
        f_r_p_documents = request.files.getlist('f_r_p_documents')
        isDocument = 0
        print(f_r_p_title)
        print(f_r_p_desc)
        print(f_r_p_poster_file.filename)
        print(f_r_p_amount)
        print(f_r_p_documents)
        
        session['f_r_p_title'] = f_r_p_title
        session['f_r_p_desc'] = f_r_p_desc
        session['f_r_p_amount'] = f_r_p_amount
        
        total_docs = 0
        total_uploaded_docs = 0
        for i in f_r_p_documents :
            if i.filename != "" or len(i.filename) != 0 :
                isDocument = 1
                total_docs += 1
            else :
                isDocument = 0
                break
        isPosterUploaded = 0
        c_dirName = "static/uploads/fund_raising_projects/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
        verification_code = str(uuid.uuid1())
        try :
            path_poster = "static/uploads/fund_raising_projects/"+str(session['alumni_login_id'])+"_f_r_p_poster_"+verification_code+f_r_p_poster_file.filename
            f_r_p_poster_file.save(path_poster)
            isPosterUploaded = 1
        except :
            print("Error FIle Upload.")
        doc_paths = []
        if isPosterUploaded == 1 :     

            if isDocument == 1 :
                    
                try :
                    for i in f_r_p_documents :
                        verification_code = str(uuid.uuid1())
                        isDocUploaded = 0
                        try :
                            path = "static/uploads/fund_raising_projects/"+str(session['alumni_login_id'])+"_f_r_p_poster_"+verification_code+i.filename
                            i.save(path)
                            isDocUploaded = 1
                            total_uploaded_docs += 1
                        except :
                            print("Error In Uploading "+str(i.filename))
                        if isDocUploaded == 1 :
                            doc_paths.append(path) 
                except :
                    print("Error FIle Upload.")
                print(total_uploaded_docs, total_docs)
                print(doc_paths)
                if total_uploaded_docs == total_docs :
                    print("All FRP Docs Uploaded.")
                else :
                    flash(Markup("<p style='font-size:15px;color:red;'>Error In Uploading All Documents.</p>"))
                    return redirect(url_for('alumni_fund_raising_project'))
            
            now = datetime.now()
            d_t = now.strftime("%Y-%m-%d %H:%M:%S")
            
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = str(res[0][7])
            
            isInserted = 0
            if len(doc_paths) == 0 :
                sql = "INSERT INTO fund_raising_projects(membership_type,user_id,college,project_title,project_description,project_poster,project_documents,project_goal_amount,project_collected_amount,isVerifiedByCollege,verifiedBySpocId,isVerifiedByAssociation,verifiedByAssociationId,status,date_time) VALUES ('%s',%d,'%s','%s','%s','%s','%s',%d,%d,'%s',%d,'%s',%d,'%s','%s')" % ("ALUMNI",int(session['alumni_login_id']),str(my_college),str(f_r_p_title),str(f_r_p_desc),str(path_poster),"NO",int(f_r_p_amount),0,"NO",0,"NO",0,"NOT ACTIVATED",d_t)
                con.execute(sql)
                cnx.commit()
                isInserted = 1
            else :
                d_c_p = ""
                for i in range(len(doc_paths)) :
                    if i == len(doc_paths)-1 :
                        d_c_p += str(doc_paths[i])
                    else :
                        d_c_p += str(doc_paths[i])+","
                print(d_c_p)
                sql = "INSERT INTO fund_raising_projects(membership_type,user_id,college,project_title,project_description,project_poster,project_documents,project_goal_amount,project_collected_amount,isVerifiedByCollege,verifiedBySpocId,isVerifiedByAssociation,verifiedByAssociationId,status,date_time) VALUES ('%s',%d,'%s','%s','%s','%s','%s',%d,%d,'%s',%d,'%s',%d,'%s','%s')" % ("ALUMNI",int(session['alumni_login_id']),str(my_college),str(f_r_p_title),str(f_r_p_desc),str(path_poster),str(d_c_p),int(f_r_p_amount),0,"NO",0,"NO",0,"NOT ACTIVATED",d_t)
                con.execute(sql)
                cnx.commit()
                isInserted = 1
                
            if isInserted == 1 :
                session['f_r_p_title'] = ""
                session['f_r_p_desc'] = ""
                session['f_r_p_amount'] = ""
                flash(Markup("<p style='font-size:15px;color:green;'>Fund Raising Project Is Added Successfully.</p>"))
                return redirect(url_for('alumni_fund_raising_project'))
            else :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Adding Fund Raising Project.</p>"))
                return redirect(url_for('alumni_fund_raising_project'))
    
    con.close()
    return render_template("alumni_fund_raising_projects.html")


@app.route('/alumni/view/fund-raising-project/<int:project_id>',methods=['GET','POST'])
def alumni_view_fund_raising_project(project_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    now = datetime.now()
    d_t = now.strftime("%Y-%m-%d %H:%M:%S")
    order_id = str(uuid.uuid1()).replace("-","")
    

    project_details = []
    sql = "SELECT * FROM fund_raising_projects WHERE id=%d AND membership_type='ALUMNI'" % (int(project_id))
    con.execute(sql)
    project_details = con.fetchall()
    if len(project_details) == 0 :
        return redirect(url_for('index'))
    
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])

    
    if request.method == "GET" :
        mode = request.args.get("mode")
        if mode == "1" :
            to_pay_amount = request.args.get('amount')
            if int(to_pay_amount) <= amount_remaining_to_collect :
                session['to_pay_amount'] = int(to_pay_amount)
                session['f_r_p_project_id'] = int(project_details[0][0])
                return jsonify(res=1)
            else :
                return jsonify(res=0,msg="Anount Must Be Less Than "+str(amount_remaining_to_collect))
            
    
    p_d = []
    project_docs =[]
    for i in range(len(project_details)) :
        if project_details[i][7] != "NO" :
            x = str(project_details[i][7]).split(",")
            for j in x :
                project_docs.append(j)

    isAllowedForCollege = "NO"
    isAllowedForAssociation = "NO"
    isAllowedForAlumni = "NO"
    isRejected = 0
    isActivated = 0
    if project_details[0][10] == "YES" and project_details[0][12] == "YES" and project_details[0][14] == "ACTIVATED BY ASSOCIATION" :
        isAllowedForAssociation = "YES"
        isAllowedForCollege = "YES"
        isAllowedForAlumni = "YES"
        isActivated = 1

    else :
        if project_details[0][10] == "YES" and project_details[0][12] == "NO" and project_details[0][14] == "ACTIVATED BY COLLEGE" :
            isAllowedForAssociation = "NO"
            isAllowedForCollege = "YES"
            isAllowedForAlumni = "YES"
        else :
            if project_details[0][10] == "NO" and project_details[0][12] == "NO" and project_details[0][14] == "REJECTED BY COLLEGE" :
                isAllowedForCollege = "NO"
                isAllowedForAlumni = "NO"
                isAllowedForAssociation = "NO"
                isRejected = 1
            else :
                if project_details[0][12] == "NO" and project_details[0][10] == "YES" and project_details[0][14] == "REJECTED BY ASSOCIATION" :
                    isAllowedForCollege = "YES"
                    isAllowedForAlumni = "YES"
                    isAllowedForAssociation = "NO"
                else :
                    isAllowedForAssociation = "NO"
                    isAllowedForCollege = "NO"
                    isAllowedForAlumni = "NO"

    print(isAllowedForCollege)
    print(isAllowedForAssociation)
    print(isAllowedForAlumni)
    print(isRejected)
    print(isActivated)
    isPersonDonate = "NO"
    my_college = ""
    d_e = ""
    d_m_n = ""
    if isActivated != 1 :
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            if str(my_college) == str(project_details[0][3]) and isAllowedForAlumni == "YES":
                isPersonDonate = "YES"
            
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                if str(my_college) == str(project_details[0][3]) and isAllowedForCollege == "YES":
                    isPersonDonate = "YES"
            
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    if isAllowedForAssociation == "YES" :
                        isPersonDonate = "YES"
    
    else :    
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            isPersonDonate = "YES"
            
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                isPersonDonate = "YES"
            
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    isPersonDonate = "YES"
                                 
                  
            
    
        
    
    session['f_r_p_project_id'] = project_id
    session['to_pay_amount'] = 0
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    percent_collected = (100 * int(project_details[0][9])) // int(project_details[0][8])
    
    gifts = []
    sql = "SELECT * FROM fund_raising_projects_payments WHERE project_id=%d AND payment_status='captured' AND payment_done='DONE' ORDER BY date_time DESC LIMIT 5" % (int(project_details[0][0]))
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        print(i)
        if i[2] == "ALUMNI" :
            sql = "SELECT first_name,last_name FROM students WHERE id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
                
        if i[2] == "COLLEGE SPOC" :
            sql = "SELECT first_name,last_name FROM colle_spoc WHERE spoc_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
            
            
        if i[2] == "ASSOCIATION" :
            sql = "SELECT first_name,last_name FROM association WHERE association_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM association_basic_profile_details WHERE association_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]

        # print("This : "+res2[0])
        random_bg_color = color[0]
        gifts.append([res2[0][0],res2[0][1],i[2],i[6],image,random_bg_color])
    print(gifts)
    #
    bar_percent = (400 * int(project_details[0][9])) // int(project_details[0][8])
    
    con.close()
    return render_template("alumni_view_fund_raising_projects.html",project_details=project_details,project_docs=project_docs,isAllowedForAlumni=isAllowedForAlumni,isAllowedForCollege=isAllowedForCollege,isAllowedForAssociation=isAllowedForAssociation,isPersonDonate=isPersonDonate,my_college=my_college,d_e=d_e,d_m_n=d_m_n,amount_remaining_to_collect=amount_remaining_to_collect,order_id=order_id,percent_collected=percent_collected,gifts=gifts,l_gifts=len(gifts),bar_percent=bar_percent,isRejected=isRejected)

@app.route('/alumni/view/fund-raising-project/payment/', methods=['GET','POST'])
def alumni_fund_raising_project_payment():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    now = datetime.now()
    d_t = now.strftime("%Y-%m-%d %H:%M:%S")
    order_id = str(uuid.uuid1()).replace("-","")
    
    project_id =  session['f_r_p_project_id']
    project_details = []
    sql = "SELECT * FROM fund_raising_projects WHERE id=%d AND membership_type='ALUMNI'" % (int(project_id))
    con.execute(sql)
    project_details = con.fetchall()
    if len(project_details) == 0 :
        return redirect(url_for('index'))
    
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])

    p_d = []
    project_docs =[]
    for i in range(len(project_details)) :
        if project_details[i][7] != "NO" :
            x = str(project_details[i][7]).split(",")
            for j in x :
                project_docs.append(j)

    isAllowedForCollege = "NO"
    isAllowedForAssociation = "NO"
    isAllowedForAlumni = "NO"
    isRejected = 0
    isActivated = 0
    if project_details[0][10] == "YES" and project_details[0][12] == "YES" and project_details[0][14] == "ACTIVATED BY ASSOCIATION" :
        isAllowedForAssociation = "YES"
        isAllowedForCollege = "YES"
        isAllowedForAlumni = "YES"
        isActivated = 1

    else :
        if project_details[0][10] == "YES" and project_details[0][12] == "NO" and project_details[0][14] == "ACTIVATED BY COLLEGE" :
            isAllowedForAssociation = "NO"
            isAllowedForCollege = "YES"
            isAllowedForAlumni = "YES"
        else :
            if project_details[0][10] == "NO" and project_details[0][12] == "NO" and project_details[0][14] == "REJECTED BY COLLEGE" :
                isAllowedForCollege = "NO"
                isAllowedForAlumni = "NO"
                isAllowedForAssociation = "NO"
                isRejected = 1
            else :
                if project_details[0][12] == "NO" and project_details[0][10] == "YES" and project_details[0][14] == "REJECTED BY ASSOCIATION" :
                    isAllowedForCollege = "YES"
                    isAllowedForAlumni = "YES"
                    isAllowedForAssociation = "NO"
                else :
                    isAllowedForAssociation = "NO"
                    isAllowedForCollege = "NO"
                    isAllowedForAlumni = "NO"

    print(isAllowedForCollege)
    print(isAllowedForAssociation)
    print(isAllowedForAlumni)
    print(isRejected)
    print(isActivated)
    
    isPersonDonate = "NO"
    my_college = ""
    d_e = ""
    d_m_n = ""
    logged_in_type = ""
    if isActivated != 1 :
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            if str(my_college) == str(project_details[0][3]) and isAllowedForAlumni == "YES":
                isPersonDonate = "YES"
                logged_in_type = "ALUMNI"
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                if str(my_college) == str(project_details[0][3]) and isAllowedForCollege == "YES":
                    isPersonDonate = "YES"
                    logged_in_type = "COLLEGE SPOC"
            
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    if isAllowedForAssociation == "YES" :
                        isPersonDonate = "YES"
                        logged_in_type = "ASSOCIATION"
    
    else :    
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            isPersonDonate = "YES"
            logged_in_type = "ALUMNI"
            
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                isPersonDonate = "YES"
                logged_in_type = "COLLEGE SPOC"
                
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    isPersonDonate = "YES"
                    logged_in_type = "ASSOCIATION"
                            
                  
            
    
        
    
    session['f_r_p_project_id'] = project_id

    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    percent_collected = (100 * int(project_details[0][9])) // int(project_details[0][8])
    
    gifts = []
    sql = "SELECT * FROM fund_raising_projects_payments WHERE project_id=%d AND payment_status='captured' AND payment_done='DONE' ORDER BY date_time DESC LIMIT 5" % (int(project_details[0][0]))
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        if i[2] == "ALUMNI" :
            sql = "SELECT first_name,last_name FROM students WHERE id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
                
        if i[2] == "COLLEGE SPOC" :
            sql = "SELECT first_name,last_name FROM colle_spoc WHERE spoc_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
            
            
        if i[2] == "ASSOCIATION" :
            sql = "SELECT first_name,last_name FROM association WHERE association_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM association_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
        random_bg_color = color[0]
        gifts.append([res2[0][0],res2[0][1],i[2],i[6],image,random_bg_color])
    # print(gifts)
    #
    bar_percent = (400 * int(project_details[0][9])) // int(project_details[0][8])
    
    
        
    
    if 'to_pay_amount' not in session :
        return redirect(url_for('index'))
    pay_amt_inr = 0
    pay_amt = 0
    try :
        pay_amt = int(session['to_pay_amount'])
        pay_amt_inr = int(session['to_pay_amount']) * 100
    except :
        pass
    
    session['f_r_p_project_id'] = project_id
    if logged_in_type == "ALUMNI" :
        session['f_r_p_user_id'] = session['alumni_login_id']
        session['f_r_p_user_type'] = "ALUMNI"
        
    if logged_in_type == "COLLEGE SPOC" :
        session['f_r_p_user_id'] = session['college_login_id']
        session['f_r_p_user_type'] = "COLLEGE SPOC"

        
    if logged_in_type == "ASSOCIATION" :
        session['f_r_p_user_id'] = session['association_login_id']
        session['f_r_p_user_type'] = "ASSOCIATION"

    session['f_r_p_order_id'] = order_id
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    percent_collected = (100 * int(project_details[0][9])) // int(project_details[0][8])
    
    gifts = []
    sql = "SELECT * FROM fund_raising_projects_payments WHERE project_id=%d AND payment_status='captured' AND payment_done='DONE' ORDER BY date_time DESC LIMIT 5" % (int(project_details[0][0]))
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        if i[2] == "ALUMNI" :
            sql = "SELECT first_name,last_name FROM students WHERE id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
                
        if i[2] == "COLLEGE SPOC" :
            sql = "SELECT first_name,last_name FROM colle_spoc WHERE spoc_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
            
            
        if i[2] == "ASSOCIATION" :
            sql = "SELECT first_name,last_name FROM association WHERE association_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM association_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
        random_bg_color = color[0]
        gifts.append([res2[0][0],res2[0][1],i[2],i[6],image,random_bg_color])
    # print(gifts)
    #
    bar_percent = (400 * int(project_details[0][9])) // int(project_details[0][8])
    
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    con.close()
    
    return render_template("alumni_fundraising_projects_payment.html",project_details=project_details,project_docs=project_docs,isAllowedForCollege=isAllowedForCollege,isAllowedForAssociation=isAllowedForAssociation,isPersonDonate=isPersonDonate,my_college=my_college,d_e=d_e,d_m_n=d_m_n,amount_remaining_to_collect=amount_remaining_to_collect,order_id=order_id,pay_amt_inr=pay_amt_inr,pay_amt=pay_amt,logged_in_type=logged_in_type,percent_collected=percent_collected,gifts=gifts,l_gifts=len(gifts),bar_percent=bar_percent,isRejected=isRejected)

@app.route('/alumni/view/fund-raising-project/payment/callback', methods=['POST'])
def app_charge():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    amount = int(session['to_pay_amount']) * 100
    payment_id = request.form['razorpay_payment_id']
    
    razorpay_client.payment.capture(payment_id, amount)
    res = razorpay_client.payment.fetch(payment_id)
    isDetailsGot = 0
    isGeneratePDF = 0
    
    project_id = session['f_r_p_project_id']
    
    try :
        
        user_id = session['f_r_p_user_id']
        order_id = str(res["notes"]["shopping_order_id"])
        membership_type = session['f_r_p_user_type']
        payment_id = str(res["id"])
        payment_amount = int(res["amount"]) / 100
        payment_status = str(res["status"])
        payment_method = str(res["method"])
        payment_email = str(res["email"])
        payment_contact = str(res["contact"])
        payment_fee = int(res["fee"]) / 100
        if payment_status == "captured" :
            payment_done = "DONE"
            isGeneratePDF = 1
            
        elif payment_status == "authorized" :
            payment_done = "PENDING"
        else :
            payment_done = "ERROR"
        
        isDetailsGot = 1
    except :
        print("Error In Getting Payment Details.")
    main_sent = 0
    isInserted = 0
    if isDetailsGot == 1 :
        print(payment_id)
        print(order_id)
        print(project_id)
        print(membership_type)
        print("User Id : ",user_id)
        print(payment_amount)
        print(payment_status)
        print(payment_method)
        print(payment_email)
        print(payment_contact)
        print(payment_fee)
        print(isDetailsGot)
        print(payment_done)
        total_payment_done = payment_amount - payment_fee
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S") 
        try :
            sql = "INSERT INTO fund_raising_projects_payments(project_id,membership_type,user_id,payment_id,order_id,payment_amount,payment_fee,payment_method,payment_email,payment_contact,payment_status,payment_done,date_time) VALUES (%d,'%s',%d,'%s','%s',%f,%f,'%s','%s',%d,'%s','%s','%s')" % (int(project_id),str(membership_type),int(user_id),str(payment_id),str(order_id),float(payment_amount),float(payment_fee),str(payment_method),str(payment_email),int(payment_contact),str(payment_status),str(payment_done),d_t)
            print(sql)
            con.execute(sql)
            cnx.commit()
            
            sql = "UPDATE fund_raising_projects SET project_collected_amount=project_collected_amount+"+str(int(payment_amount))+" WHERE id="+str(project_id)
            
            con.execute(sql)
            cnx.commit()
            
            isInserted = 1         
        except :
            print("Error In Inserting In Fund Raising Project Payment Details.")
        
        if isInserted == 1 :
            sql = "SELECT * FROM fund_raising_projects WHERE id=%d" % (int(project_id))
            con.execute(sql)
            res = con.fetchall()
            project_title = res[0][4]
            if membership_type == "ALUMNI" : 
                sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])
                
            if membership_type == "COLLEGE SPOC" :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][2]).capitalize()+" "+str(res[0][3]).capitalize()
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
            
            if membership_type == "ASSOCIATION" :
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])

            try :
                
                msg = Message('FUND RAISING PROJECT PAYMENT DETAILS', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [payment_email])
                    
                msg.html = '''
                                <!DOCTYPE html>
                                <html lang="en">
                                <head>
                                    <meta charset="UTF-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                    <title></title>
                                </head>
                                <body>
                                    <table class="nl-container" style="table-layout: fixed; vertical-align: top; min-width: 320px; margin: 0 
                                auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f5f5f5; width: 100%;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                        <tbody>
                                        <tr style="vertical-align: top;" valign="top">
                                            <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 5px 0px 5px 0px;">       
                                                                <table class="divider" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;" valign="top">
                                                                            <table class="divider_content" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
                                                                                <tbody>
                                                                                    <tr style="vertical-align: top;" valign="top">
                                                                                        <td style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" height="10">&nbsp;</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid two-up no-stack" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">     
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #ffffff;">
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 0px 25px 25px;">    
                                                                <div class="img-container left fixedwidth" style="padding-right: 0px; padding-left: 0px;" align="left">
                                                                    <img class="left fixedwidth" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" alt="Image Logo" width="195" border="0" />
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 25px 25px 0px;">    
                                                                <div class="button-container" style="padding: 10px 0px 10px 10px;" align="right">
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #d6e7f0;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #d6e7f0;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;background-color:white;padding:20px">
                                                        
                                                            <table bgcolor="#f9f9f9" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f9f9f9; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#f9f9f9"><![endif]-->
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 14px; line-height: 1.2; word-break: break-word; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 17px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Dear </span><span style="font-size: 17px; mso-ansi-font-size: 18px;"><b>'''+str(name)+'''</b> Your Payment For Fund Raising Project Is Successful.Thank You</span></span><span style="font-size: 17px; color: #000000; mso-ansi-font-size: 18px;"> For Making Gift To <b>'''+str(project_title)+'''</b> Project.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 17px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 20px; mso-ansi-font-size: 18px; margin: 0;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Payment Details</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>PAYMENT ID : '''+str(payment_id)+'''</strong></span></span></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>ORDER ID : '''+str(order_id)+'''</strong></span></span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid three-up" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;">Total Amount Paid</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:0px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;"> '''+str(payment_amount)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Fee</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(payment_fee)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Received</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(total_payment_done)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:transparent;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:0px; padding-bottom:0px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:0px; padding-bottom:0px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Email</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_email)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Mobile No.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_contact)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="0" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 0px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td height="0" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                <div align="center" class="button-container" style="padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="" style="height:31.5pt; width:116.25pt; v-text-anchor:middle;" arcsize="10%" stroke="false" fillcolor="#ea5256"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, sans-serif; font-size:16px"><![endif]-->
                                                                <a href="'''+str(app_base_url)+'''fund_raising_project/receipt/'''+str(payment_id)+'''/'''+str(order_id)+'''"><div style="text-decoration:none;display:inline-block;color:#ffffff;background-color:#ea5256;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;width:auto; width:auto;;border-top:1px solid #ea5256;border-right:1px solid #ea5256;border-bottom:1px solid #ea5256;border-left:1px solid #ea5256;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;text-align:center;mso-border-alt:none;word-break:keep-all;"><span style="padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;">VIEW NOW</span></span></div></a>
                                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        <div style="background-color: transparent;">
                                            <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                            <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                    <div style="width: 100% !important;">
                                                        <div style="border: 0px solid transparent; padding: 20px 0px 60px 0px;">
                                                        <table class="social_icons" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                                            <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                    <td style="word-break: break-word; vertical-align: top; padding: 10px;" valign="top">
                                                                    <table class="social_table" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" role="presentation" cellspacing="0" cellpadding="0" align="center">
                                                                        <tbody>
                                                                            <tr style="vertical-align: top; display: inline-block; text-align: center;" align="center" valign="top">
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://www.facebook.com/darshpatelofficial" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" alt="Facebook" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://twitter.com/pateldarsh10" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" alt="Twitter" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://instagram.com/pateldarsh_007" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" alt="Instagram" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" alt="E-Mail" width="32" height="32" /></a></td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <div style="color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; line-height: 1.5; padding: 10px;">
                                                            <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;">&copy; 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                                </table>
                                </body>
                                </html>                                   
                    '''
                try :
                    mail.send(msg)
                    mail_sent = 1
                except :
                    print("Error In Sending Mail.")

                if mail_sent == 1 :
                    
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '/alumni/view/fund-raising-project/"+str(project_id)+"';</script>"; 
                else :
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '/alumni/view/fund-raising-project/"+str(project_id)+"';</script>"; 
                
            except :
                print("Error In Sending payment F_R_P Details To email.")
                flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                return "<script>window.location = '/alumni/view/fund-raising-project/"+str(project_id)+"';</script>"; 
        
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Payment Details.</p>"))
            return "<script>window.location = '/alumni/view/fund-raising-project/"+str(project_id)+"';</script>"; 
           
    else :
        return "<script>window.location = '/alumni/view/fund-raising-project/"+str(project_id)+"';</script>"; 
    
    # res2 = json.dumps(res,indent=4)
    # con.close()
    # return res2

@app.route('/generate/certificate')
def gen_certificate():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    if 'alumni_login_id' not in session :
        return redirect(url_for('alumni_login'))
    
    sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
    con.execute(sql)
    res = con.fetchall()
    
    if len(res) == 1 :
        name = str(res[0][1]).capitalize()+ " " + str(res[0][2]).capitalize()
        college = str(res[0][7])
        d_t = res[0][18].strftime("%d/%m/%Y")
        
        font_type = ImageFont.truetype('D:/ALUMNI_TRACKING_SYSTEM/certificate/Vera.ttf',30)

        img = Image.open('D:/ALUMNI_TRACKING_SYSTEM/certificate/AAG_Certificate.JPG')

        name = name.center(115," ")
        pos = d_t.center(20," ") # 10
        event = college.center(140," ")
        
        draw = ImageDraw.Draw(img)
        
        font_type = ImageFont.truetype('D:/ALUMNI_TRACKING_SYSTEM/certificate/Vera.ttf',30)
        draw.text(xy=(50,380),text=name,fill=(0,0,0),font=font_type)
        
        font_type = ImageFont.truetype('D:/ALUMNI_TRACKING_SYSTEM/certificate/Vera.ttf',26)
        draw.text(xy=(10,498),text=event,fill=(0,0,0),font=font_type)

        font_type = ImageFont.truetype('D:/ALUMNI_TRACKING_SYSTEM/certificate/Vera.ttf',22)
        draw.text(xy=(620,623),text=pos,fill=(0,0,0),font=font_type)

        random_id = str(uuid.uuid1()).replace("-","")

        c_dirName = "static/uploads/alumni_certificates/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")


        path = c_dirName +str(random_id)+".jpg"
        
        img.save(path)

        sql = "SELECT * FROM alumni_certificates WHERE alumni_id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        
        isIns = 0
        if len(res) == 1 :
            sql = "UPDATE alumni_certificates SET path='%s' WHERE alumni_id=%d" % (path,int(session['alumni_login_id']))
            con.execute(sql)
            cnx.commit()
            
            exist_path = res[0][2]
            print(exist_path)
            try :
                os.remove(exist_path)
            except :
                print("Error In Removing Existing Path.")
            isIns = 1
        else :
            sql = "INSERT INTO alumni_certificates(alumni_id,path) VALUES('%d','%s')" % (int(session['alumni_login_id']),path)
            con.execute(sql)
            cnx.commit()
            isIns = 1
            
        if isIns == 1 :
            # flash(Markup("<p style='font-size:15px;color:green;'>Your Certificate Is Ready Now.</p>"))
            return redirect("../../"+path)
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Generating Certificate.</p>"))
            return redirect(url_for('alumni_profile'))
            
    else :
        return redirect(url_for('alumni_login'))
    con.close()
    return 'certificate'            
    
@app.route('/alumni/profile/',methods=['GET','POST'])
def alumni_profile():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    if 'alumni_login_id' not in session :
        return redirect(url_for('alumni_login'))
                
        
    main_profile_details = []
    basic_profile_details = []
    
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("Alumni : Error In Getting Main Profile Details.")
        pass
    
    try :
        sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("Alumni : Error In Getting Basic Profile Details.")
        pass
    
    # print(basic_profile_details)
    
    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
    random_bg_color = color[0]
    # print(random_bg_color)
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("Alumni : No Expertise or Error In Getting Expertise")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
            
            
    # profile_blog_posts = []
    
    # try :
    #     sql = "SELECT * FROM blog_post_alumni WHERE spoc_id=%d ORDER BY date_time" % (int(session['college_login_id']))
    #     con.execute(sql)
    #     res = con.fetchall()
    #     for i in range(len(res)) :
    #         t = []
    #         for j in range(len(res[i])):
    #             if j == 4 :
    #                 soup = BeautifulSoup(res[i][j],features="html.parser")
    #                 t.append(soup.get_text())
    #             else :
    #                 t.append(res[i][j])
                    
    #         profile_blog_posts.append(t)
            
    # except :
    #     print("college : Error In Getting Profile Blog Post Details.")
    
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM alumni_education_details WHERE alumni_id=%d ORDER BY id DESC" % (int(session['alumni_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("Alumni: Error In Getting Education Details Of Profile")
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM alumni_work_details WHERE alumni_id=%d ORDER BY id DESC" % (int(session['alumni_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Alumni : Error In Getting Education Details Of Profile")
    try :
        profile_pic = basic_profile_details[0][9]
        l_profile_pic = len(profile_pic)
    except :
        profile_pic = ""
        l_profile_pic = len(profile_pic)
    
    profile_network_details = []
    try :
        sql = "SELECT * FROM network WHERE from_id=%d AND from_type='ALUMNI' ORDER BY date_time DESC" % (int(session['alumni_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            user_id = int(i[4])
            if i[3] == "ASSOCIATION MEMBER" :
                try :
                    sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("College : Error In Getting Network Profile Details.")
                        
            if i[3] == "COLLEGE SPOC" :
                try :
                    sql = "SELECT college_spoc.first_name,college_spoc.last_name,college_basic_profile_details.profile_image FROM college_spoc,college_basic_profile_details WHERE college_spoc.spoc_id=%d AND college_basic_profile_details.spoc_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["College SPOC",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["College SPOC",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("College : Error In Getting Network Profile Details.")
                        
            if i[3] == "ALUMNI" :
                try :
                    sql = "SELECT students.first_name,students.last_name,alumni_basic_profile_details.profile_image FROM students,alumni_basic_profile_details WHERE students.id=%d AND alumni_basic_profile_details.alumni_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Alumni",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT students.first_name,students.last_name FROM students WHERE students.id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Alumni",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("Alumni : Error In Getting Network Profile Details.")
                        
    except :
        print("Alumni : Error In Getting Education Details Of Profile")
        
    print(profile_network_details)
    
    return render_template("alumni_profile.html",main_profile_details=main_profile_details,random_bg_color=random_bg_color,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises),profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details),profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),profile_pic=profile_pic,l_profile_pic=l_profile_pic,profile_network_details=profile_network_details,l_profile_network_details=len(profile_network_details))

@app.route('/alumni/profile/edit/<int:section_id>',methods=['GET','POST'])
def alumni_edit_profile(section_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
       
    if request.method == "POST" :
        mode = int(request.form['mode'])
        
        if mode == 2 :
            f_name = str(request.form['profile_first_name']).strip()
            l_name = str(request.form['profile_last_name']).strip()
            email = str(request.form['profile_email']).strip()
            mobile_no = str(request.form['profile_mobile_no']).strip()
            address = str(request.form['profile_main_address'])
            summary = str(request.form['profile_main_summary']).strip()
            expertise = str(request.form['post_tag_value'])[1:]
            
            if len(f_name) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter First Name.</p>"))
                return
            
            if len(l_name) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Last Name.</p>"))
                return
            
            if len(email) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Email Address.</p>"))
                return
            
            if len(mobile_no) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Mobile Number.</p>"))
                return
                        
            
            print("Ex : ",expertise)
            
            isNameUpdated = 0
            isAddressUpdated = 0
            isEmailRequestUpdated = 0
            isEmailSent = 0
            email_sent = 0
            isEmailUpdated = 0
            resx = 0
            resy = 0
            isMobileUpdated = 0
            sms_sent = 0
            try :
                sql = "UPDATE students SET first_name='%s',last_name='%s' WHERE id=%d" % (f_name,l_name,int(session['alumni_login_id']))
                con.execute(sql)
                cnx.commit()
                isNameUpdated = 1
            except :
                print("Alumni : Error In Updating f_name & l_name.")
            
            if isNameUpdated == 1 :
                try :
                    sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(session['alumni_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    if len(res) == 0 :
                        sql = "INSERT INTO alumni_basic_profile_details(alumni_id,address,summary,expertise) VALUES(%d,'%s','%s','%s')" % (int(session['alumni_login_id']),str(address),str(summary),str(expertise))
                        con.execute(sql)
                        cnx.commit()
                        isAddressUpdated = 1
                    else :
                        sql = "UPDATE alumni_basic_profile_details SET address='%s',summary='%s',expertise='%s' WHERE alumni_id=%d" % (str(address),str(summary),str(expertise),int(session['alumni_login_id']))
                        con.execute(sql)
                        cnx.commit()
                        isAddressUpdated = 1
                except :
                    print("Alumni : Error In Updating Address.")
                    
            if isAddressUpdated == 1 :
                try :
                    sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    old_email = str(res[0][3])
                        
                    if old_email != email :
                        verification_code = str(uuid.uuid1())
                            
                        try :
                            sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isStudentVerified='YES'" % (email)
                            con.execute(sql)
                            res = con.fetchall()
                            resx = len(res)
                        except :
                            print("Alumni : Profile Email Compare Error.")
                            
                        if resx == 0 :
                            try :
                                sql = "UPDATE alumni_basic_profile_details,students SET alumni_basic_profile_details.isEmailUpdateRequested='YES',students.verification_code='%s' WHERE alumni_basic_profile_details.alumni_id=%d AND students.id=%d" % (str(verification_code),int(session['alumni_login_id']),int(session['alumni_login_id']))
                                print(sql)
                                con.execute(sql)
                                cnx.commit()
                                isEmailRequestUpdated = 1
                            except :
                                print("Alumni : Error In Updating isEmailUpdateRequested")
                                
                            url_part_1 = "alumni/update/"+str(session['alumni_login_id'])+"/"+str(verification_code)+"/"+str(email)
                        
                            if isEmailRequestUpdated == 1 :
                                msg = Message('Alumni Association Of Goa : Alumni Email Update', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
                                msg.html = '''
                                                                <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

    <head>
        <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta content="width=device-width" name="viewport" />
        <!--[if !mso]><!-->
        <meta content="IE=edge" http-equiv="X-UA-Compatible" />
        <!--<![endif]-->
        <title></title>
        <!--[if !mso]><!-->
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
        <!--<![endif]-->
        <style type="text/css">
            body {
                margin: 0;
                padding: 0;
            }
            
            table,
            td,
            tr {
                vertical-align: top;
                border-collapse: collapse;
            }
            
            * {
                line-height: inherit;
            }
            
            a[x-apple-data-detectors=true] {
                color: inherit !important;
                text-decoration: none !important;
            }
        </style>
        <style id="media-query" type="text/css">
            @media (max-width: 670px) {
                .block-grid,
                .col {
                    min-width: 320px !important;
                    max-width: 100% !important;
                    display: block !important;
                }
                .block-grid {
                    width: 100% !important;
                }
                .col {
                    width: 100% !important;
                }
                .col>div {
                    margin: 0 auto;
                }
                img.fullwidth,
                img.fullwidthOnMobile {
                    max-width: 100% !important;
                }
                .no-stack .col {
                    min-width: 0 !important;
                    display: table-cell !important;
                }
                .no-stack.two-up .col {
                    width: 50% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num8 {
                    width: 66% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num3 {
                    width: 25% !important;
                }
                .no-stack .col.num6 {
                    width: 50% !important;
                }
                .no-stack .col.num9 {
                    width: 75% !important;
                }
                .video-block {
                    max-width: none !important;
                }
                .mobile_hide {
                    min-height: 0px;
                    max-height: 0px;
                    max-width: 0px;
                    display: none;
                    overflow: hidden;
                    font-size: 0px;
                }
                .desktop_hide {
                    display: block !important;
                    max-height: none !important;
                }
            }
        </style>
    </head>

    <body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
        <!--[if IE]><div class="ie-browser"><![endif]-->
        <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
            <tbody>
                <tr style="vertical-align: top;" valign="top">
                    <td style="word-break: break-word; vertical-align: top;" valign="top">
                        <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                                
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                    <div style="font-size:1px;line-height:45px"></div>
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                    <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                        <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;">Dear <span style="font-size: 18px; color: #000000;"><b>'''+str(f_name).capitalize()+''' '''+str(l_name).capitalize()+'''</b></strong></span>, We Received Request For Email Change From Your Account.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CHANGE MY EMAIL</strong></span></span></a>
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                    <tbody>
                                                                        <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                        <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
        <!--[if (IE)]></div><![endif]-->
    </body>

    </html>
                    '''
                                try :
                                    mail.send(msg)
                                    isEmailSent = 1
                                    email_sent = 1
                                except :
                                    isEmailSent = 1
                                    print("Alumni : Error In Sending Mail.")
                            else :
                                print("Alumni : Error In Updating Status Of Email Change To Yes.")
                        
                        
                        else :
                            flash(Markup("<p style='font-size:15px;color:red;'>This Email Is Already Linked With Another Accont.</p>"))
                            
                        if email_sent == 1 and isEmailSent == 1 :
                            flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated Successfully.\nPlease Verify Your New Email Address.</p>"))
                        if email_sent == 0 and isEmailSent == 1 :
                            flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated But Unable To Send Email To  New Email Address.</p>"))        
                                        
                    else :
                        flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated Successfully.</p>"))
                            
            
                except :
                    print("Error In Updating Email.")
            
            
            try :
                sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                con.execute(sql)
                res = con.fetchall()
                old_mobile_no = int(res[0][5])
                country_code = str(res[0][4])       
                mobile_no = int(mobile_no)
                otp = random.randrange(111111,999999)                       
                if old_mobile_no != mobile_no :
                    try :
                        # #####################################################################################################
                        sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND isStudentVerified='YES'" % (int(country_code),int(mobile_no))
                        con.execute(sql)
                        res = con.fetchall()
                        resy = 1
                        resy = len(res)
                    except :
                        print("Alumni : Error In Comparing Mobile No. In Alumni Profile")
                        pass
                    
                    if resy == 0 :
                        try :
                            sql = "UPDATE alumni_basic_profile_details SET isMobileUpdateRequested='YES' WHERE alumni_id=%d" % (int(session['alumni_login_id']))
                            con.execute(sql)
                            cnx.commit()
                            print("Update Status Of isMobileUpdateRequested To YES.")
                        except :
                            print("alumni : Error In Updating 	isMobileUpdateRequested In Association Profile")
                        pass
                        
                        headers = {
                                                        'Content-Type': 'application/json',
                                                        'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
                                                    }
                                                
                        msg = 'Dear '+str(f_name)+' '+str(l_name)+',\\nWe Received Your Request For Change Of Mobile Number For Alumni Account. Use '+str(otp)+' As OTP To Change Mobile Number.'

                        data = '{"message": "'+msg+'","binary": false,  "destinations": ["+'+str(country_code)+str(mobile_no)+'"]}'

                        response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                        res = json.loads(response.text)
                        print(res)
                        try :
                            if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                                sms_sent = 1
                                                            # return jsonify(res=1)
                            else :
                                sms_sent = 0
                        except :
                            sms_sent = 0
                            
                        if sms_sent == 1 :
                            try :
                                sql = "UPDATE students SET otp=%d WHERE id=%d" % (int(otp),int(session['alumni_login_id']))
                                con.execute(sql)
                                cnx.commit()
                                session['alumni_profile_country_code'] = country_code
                                session['alumni_profile_mobile_no'] = mobile_no
                                session['alumni_profile_otp'] = otp
                                return redirect(url_for('alumni_profile_update_mobile'))
                            except :
                                print("Error In Updating OTP.")
                    
                    else :
                        flash(Markup("<p style='font-size:15px;color:red;'>This Mobile No. Is Already Registered.</p>"))
                        print("Mobile No. Already Registered WIth Us.")
        
            except :
                print("college : Profile Error Getting Mobile No.")
                # flash("<p style='color:green;font-size:15px;'>Profile Updated Successfully. Please Verify Your New Email.</p>")
                
        if mode == 3 :
            profile_current_location = str(request.form['profile_current_location']).strip()
            profile_hometown = str(request.form['profile_hometown'])
            profile_gender = str(request.form['profile_gender'])
            profile_dob = request.form['profile_dob']
            
            
            print(profile_current_location)
            print(profile_hometown)
            print(profile_gender)
            print(profile_dob)
            
            
            profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            profile_dob = profile_dob.strftime("%Y-%m-%d")
            print(profile_dob)
            isProfileContactInfoUpdated = 0
            try :
                sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(session['alumni_login_id']))
                con.execute(sql)
                res = con.fetchall()
                if len(res) == 0 :
                    sql = "INSERT INTO alumni_basic_profile_details(alumni_id,hometown,current_location,date_of_birth,gender) VALUES(%d,'%s','%s','%s','%s')" % (int(session['alumni_login_id']),profile_hometown,profile_current_location,profile_dob,profile_gender)
                    con.execute(sql)
                    cnx.commit()
                    isProfileContactInfoUpdated = 1
                else :
                    sql = "UPDATE alumni_basic_profile_details SET hometown='%s',current_location='%s',date_of_birth='%s',gender='%s' WHERE alumni_id=%d" % (profile_hometown,profile_current_location,profile_dob,profile_gender,int(session['alumni_login_id']))
                    con.execute(sql)
                    cnx.commit()
                    isProfileContactInfoUpdated = 1
            except :
                print("Alumni : Error In Updating Basic Information Of Profile.")
                
            
            if isProfileContactInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Profile Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Basic Information.</p>"))  
                
        
        if mode == 4 :
            institute_name = str(request.form['institute_name']).strip()
            starting_year = request.form['starting_year']
            graduation_year = request.form['graduation_year']
            degree = str(request.form['degree']).strip()
            department = str(request.form['department']).strip()
            
            
            print(institute_name)
            print(starting_year)
            print(graduation_year)
            print(degree)
            print(department)
            
            
            if starting_year > graduation_year :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Graduation Year.</p>"))
                print("Association : Profile Graducation : Please Enter Valid Graduation Year.")
                return redirect("../../../alumni/profile/edit/3")
                
            
            
            # profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            # profile_dob = profile_dob.strftime("%Y-%m-%d")
            # print(profile_dob)
            isProfileEducationInfoUpdated = 0
            try :
                sql = "INSERT INTO alumni_education_details(alumni_id,name_of_institute,start_year,graduation_year,degree,department) VALUES(%d,'%s',%d,%d,'%s','%s')" % (int(session['alumni_login_id']),institute_name,int(starting_year),int(graduation_year),str(degree),str(department))
                con.execute(sql)
                cnx.commit()
                isProfileEducationInfoUpdated= 1
                
            except :
                print("Alumni : Error In Inserting Education Information Of Profile.")
                
            
            if isProfileEducationInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Education Details Added Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding Education Information.</p>"))  
                
         
        if mode == 5 :
            work_title = str(request.form['work_title']).strip()
            company_name = str(request.form['company_name'])
            work_industry = str(request.form['work_industry'])
            from_month = request.form['from_month']
            from_year = request.form['from_year']
            to_month = request.form['to_month']
            to_year = request.form['to_year']
            try :
                isWorking = request.form.getlist('isWorking')[0]
                if isWorking == "on" :
                    isWorking = "YES"
                else :
                    isWorking = "NO"
            except :
                isWorking = "NO"
                
            achievement = str(request.form['achievement']).strip()
            
            
            
            # print(isWorking)
            
            
            isProfileWorkInfoUpdated = 0
            try :
                sql = "INSERT INTO alumni_work_details(alumni_id,work_title,company_name,work_industry,from_month,from_year,isWorkingNow,to_year,to_month,achievement) VALUES(%d,'%s','%s','%s','%s',%d,'%s',%d,'%s','%s')" % (int(session['alumni_login_id']),str(work_title),str(company_name),str(work_industry),str(from_month),int(from_year),isWorking,int(to_year),str(to_month),str(achievement))
                con.execute(sql)
                cnx.commit()
                isProfileWorkInfoUpdated = 1
                
            except :
                print("Alumni : Error In Inserting Work Information Of Profile.")
                
            
            if isProfileWorkInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Work Details Added Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding Work Information.</p>"))  
               
                      
        
       
    if 'alumni_login_id' not in session :
        return redirect(url_for('alumni_login'))
                
        
    main_profile_details = []
    
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("alumni : Error In Getting Main Profile Details.")
        pass
    
    basic_profile_details = []
    try :
        sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(session['alumni_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("alumni : Error In Getting Basic Profile Details.")
        pass
    
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("Error In Tag")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
    
    # print(expertises)
    # print(main_profile_details)
    if section_id == 1 :
        return render_template("alumni_profile_contact_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises))
    if section_id == 2 :
       
        return render_template("alumni_profile_basic_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details))
    if section_id == 3 :
        return render_template("alumni_profile_education_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details))
    if section_id == 4 :
        month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"]
        year_list = []
        
        for i in range(1960,2021):
            # print(i)
            year_list.append(int(i))
            
        
        return render_template("alumni_profile_work_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),month_list=month_list,year_list=year_list)

@app.route("/alumni/update/<int:alumni_id>/<verification_code>/<new_email>")
def alumni_change_email(alumni_id,verification_code,new_email):
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * FROM students,alumni_basic_profile_details WHERE students.id=%d AND students.verification_code='%s' AND alumni_basic_profile_details.isEmailUpdateRequested='YES'" % (int(alumni_id),str(verification_code))
        con.execute(sql)
        res = con.fetchall()
        print(res)
        if len(res) == 1 :
            try :
                sql = "UPDATE students,alumni_basic_profile_details SET students.email='%s',students.verification_code='',alumni_basic_profile_details.isEmailUpdateRequested='NO' WHERE students.id=%d AND alumni_basic_profile_details.alumni_id=%d" % (str(new_email),int(alumni_id),int(alumni_id))
                print(sql)
                con.execute(sql)
                cnx.commit()
                flash(Markup("<p style='color:green;font-size:15px;'>Email Is Changed Successfully.</p>"))  
                return redirect(url_for('alumni_logout'))
            except :
                print("college : Error In Updating Email Change")
                
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Email Change.</p>"))  
                return "Error In Email Update"
        else :
            return "Error"

    except :
        return "Error"
        print("alumni : Error : Email Change Not Found / Lost.")
    con.close()

@app.route('/alumni/profile/edit/education/<int:id>',methods=['GET','POST'])
def alumni_profile_edit_education_profile(id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 4 :
            institute_name = str(request.form['institute_name']).strip()
            starting_year = request.form['starting_year']
            graduation_year = request.form['graduation_year']
            degree = str(request.form['degree']).strip()
            department = str(request.form['department']).strip()
                        
            
            if starting_year > graduation_year :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Starting Year & Graduation Year.</p>"))
                print("Association : Profile Graducation : Please Enter Valid Graduation Year.")
                return redirect("../../../../alumni/profile/edit/education/"+str(id))
                
            
            
            # profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            # profile_dob = profile_dob.strftime("%Y-%m-%d")
            # print(profile_dob)
            isProfileEducationInfoUpdated = 0
            try :
                sql = "UPDATE alumni_education_details SET name_of_institute='%s',start_year=%d,graduation_year=%d,degree='%s',department='%s' WHERE alumni_id=%d AND id=%d" % (institute_name,int(starting_year),int(graduation_year),str(degree),str(department),int(session['alumni_login_id']),int(id))
                con.execute(sql)
                cnx.commit()
                isProfileEducationInfoUpdated= 1
                
            except :
                print("alumni : Error In UpdatingEducation Information Of Profile.")
                
            
            if isProfileEducationInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Education Details Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Education Information.</p>"))  
           
        if mode == 2 :
            edu_id = int(request.form['id'])
            
            try :
                sql = "DELETE FROM alumni_education_details WHERE id=%d AND alumni_id=%d" % (int(edu_id),int(session['alumni_login_id']))
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Education Details Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Education.")
        
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM alumni_education_details WHERE id=%d AND alumni_id=%d" % (id,int(session['alumni_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("alumni : Error In Getting Education Details To Edit Profile.")
    con.close()
    
    if len(profile_education_details) == 0 :
        return redirect(url_for('alumni_profile'))
    
    return render_template('alumni_profile_education_edit.html',profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details))    
    
@app.route('/alumni/profile/edit/work/<int:id>',methods=['GET','POST'])
def alumni_profile_edit_work_profile(id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 5 :
            work_title = str(request.form['work_title']).strip()
            company_name = str(request.form['company_name'])
            work_industry = str(request.form['work_industry'])
            from_month = request.form['from_month']
            from_year = request.form['from_year']
            to_month = request.form['to_month']
            to_year = request.form['to_year']
            try :
                isWorking = request.form.getlist('isWorking')[0]
                if isWorking == "on" :
                    isWorking = "YES"
                else :
                    isWorking = "NO"
            except :
                isWorking = "NO"
                
            achievement = str(request.form['achievement']).strip()
            
            isProfileWorkInfoUpdated = 0
            try :
                sql = "UPDATE alumni_work_details SET work_title='%s',company_name='%s',work_industry='%s',from_month='%s',from_year=%d,isWorkingNow='%s',to_year=%d,to_month='%s',achievement='%s' WHERE id=%d AND alumni_id=%d" % (str(work_title),company_name,work_industry,str(from_month),int(from_year),isWorking,int(to_year),str(to_month),achievement,int(id),int(session['alumni_login_id']))
                con.execute(sql)
                cnx.commit()
                isProfileWorkInfoUpdated = 1
                
            except :
                print("alumni : Error In Updating Work Information Of Profile.")
                
            
            if isProfileWorkInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Work Details Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Work Information.</p>"))  
           
        if mode == 2 :
            work_id = int(request.form['id'])
            
            try :
                sql = "DELETE FROM alumni_work_details WHERE id=%d AND alumni_id=%d" % (int(work_id),int(session['alumni_login_id']))
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Work Details Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Work Details.")
        
    
    profile_work_details = []
    try :
        sql = "SELECT * FROM alumni_work_details WHERE id=%d AND alumni_id=%d" % (id,int(session['alumni_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("alumni : Error In Getting Work Details To Edit Profile.")
    con.close()
    
    if len(profile_work_details) == 0 :
        return redirect(url_for('alumni_profile'))
    
    month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"]
    year_list = []
        
    for i in range(1960,2021):
            # print(i)
        year_list.append(int(i))
        
        
    return render_template('alumni_profile_work_edit.html',profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),month_list=month_list,year_list=year_list)
    
@app.route("/alumni/profile/update/mobile/",methods=['GET','POST'])
def alumni_profile_update_mobile():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "GET" :
        mode = request.args.get('mode')
        if mode == "1" :
            r_otp = request.args.get('otp')
            x = 0
            y = 0
            try :
                # association_basic_profile_details
                # isMobileUpdateRequested
                sql = "SELECT * FROM students,alumni_basic_profile_details WHERE students.id=%d AND alumni_basic_profile_details.alumni_id=%d AND alumni_basic_profile_details.isMobileUpdateRequested='YES' AND students.otp=%d" % (int(session['alumni_login_id']),int(session['alumni_login_id']),int(r_otp))
                con.execute(sql)
                res = con.fetchall()
                x = len(res)
            except :
                print("alumni : Profile Error In Comparing OTP.")
                
            if x == 1 :
                try :
                    # association_basic_profile_details
                    # isMobileUpdateRequested
                    sql = "UPDATE students,alumni_basic_profile_details SET students.mobile_number=%d,alumni_basic_profile_details.isMobileUpdateRequested='NO',students.otp=0 WHERE students.id=%d AND alumni_basic_profile_details.alumni_id=%d" % (int(session['alumni_profile_mobile_no']),int(session['alumni_login_id']),int(session['alumni_login_id']))
                    con.execute(sql)
                    cnx.commit()
                    y = 1
                except :
                    print("alumni : Profile Error In Comparing OTP.")
            else :
                return jsonify(res=0,msg="Invalid OTP.")
            
            if y == 1 :
                session['alumni_profile_country_code'] = ""
                session['alumni_profile_mobile_no'] = ""
                return jsonify(res=1,msg="Mobile No. Updated Successfully.")
            else :
                return jsonify(res=0,msg="Unable To Update, Please Try Again.")

        if mode == "2" :
            country_code = session['alumni_profile_country_code']
            mobile_no =  session['alumni_profile_mobile_no']
            otp = session['alumni_profile_otp']
            sms_sent = 0
            headers = {
                                                        'Content-Type': 'application/json',
                                                        'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
                                                    }
                                                
            msg = 'Hey ! We Received Your Request For Change Of Mobile Number For Alumni Account. Use '+str(otp)+' As OTP To Change Mobile Number.'

            data = '{"message": "'+msg+'","binary": false,  "destinations": ["+'+str(country_code)+str(mobile_no)+'"]}'

            response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
            res = json.loads(response.text)
            print(res)
            try :
                if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                    sms_sent = 1
                                                            # return jsonify(res=1)
                else :
                    sms_sent = 0
            except :
                sms_sent = 0
                
            if sms_sent == 1 :
                m = "SMS Is Sent To +"+str(country_code)+str(mobile_no)
                return jsonify(res=1,msg=str(m))
            else :
                return jsonify(res=0,msg="Unable To Send SMS, Please Try Again.")
                
         
    if request.method == "POST" :
         pass              
    
    con.close()
    if len(str(session['alumni_profile_country_code']))== 0 or len(str(session['alumni_profile_mobile_no'])) == 0 :
        return redirect(url_for('alumni_profile'))
    
    return render_template("alumni_profile_update_mobile_no.html")


@app.route('/alumni/profile/<int:profile_id>',methods=['GET','POST'])
def alumni_view_profile(profile_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    main_profile_details = []
    basic_profile_details = []
    
    try :
        sql = "SELECT * FROM students WHERE id=%d" % (int(profile_id))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("Alumni : View Error In Getting Main Profile Details.")
        pass
    
    try :
        sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(profile_id))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("Alumni : View Error In Getting Basic Profile Details.")
        pass
    
    # print(basic_profile_details)
    
    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
    random_bg_color = color[0]
    # print(random_bg_color)
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("Alumni : No Expertise or Error In Getting Expertise")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
    
    profile_education_details = []
    edu_d = [main_profile_details[0][7],main_profile_details[0][8],main_profile_details[0][10],main_profile_details[0][11]]
    
    try :
        sql = "SELECT * FROM alumni_education_details WHERE alumni_id=%d ORDER BY id DESC" % (int(profile_id))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            profile_education_details.append(list(i))
    except :
        print("Alumni: View Error In Getting Education Details Of Profile")
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM alumni_work_details WHERE alumni_id=%d ORDER BY id DESC" % (int(profile_id))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Alumni : View Error In Getting Education Details Of Profile")
    try :
        profile_pic = basic_profile_details[0][9]
        l_profile_pic = len(profile_pic)
    except :
        profile_pic = ""
        l_profile_pic = len(profile_pic)
    
    profile_network_details = []
    try :
        sql = "SELECT * FROM network WHERE from_id=%d AND from_type='ALUMNI' ORDER BY date_time DESC LIMIT 5" % (int(profile_id))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            user_id = int(i[4])
            if i[3] == "ASSOCIATION MEMBER" :
                try :
                    sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("College : Error In Getting Network Profile Details.")
                        
            if i[3] == "COLLEGE SPOC" :
                try :
                    sql = "SELECT college_spoc.first_name,college_spoc.last_name,college_basic_profile_details.profile_image FROM college_spoc,college_basic_profile_details WHERE college_spoc.spoc_id=%d AND college_basic_profile_details.spoc_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["College SPOC",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["College SPOC",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("College : Error In Getting Network Profile Details.")
                        
            if i[3] == "ALUMNI" :
                try :
                    sql = "SELECT students.first_name,students.last_name,alumni_basic_profile_details.profile_image FROM students,alumni_basic_profile_details WHERE students.id=%d AND alumni_basic_profile_details.alumni_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Alumni",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT students.first_name,students.last_name FROM students WHERE students.id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Alumni",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("Alumni : View Error In Getting Network Profile Details.")
                        
    except :
        print("Alumni : ViewError In Getting Education Details Of Profile")
        
    # print(profile_network_details)
    
    
    
    return render_template("alumni_view_profile.html",main_profile_details=main_profile_details,random_bg_color=random_bg_color,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises),profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details),profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),profile_pic=profile_pic,l_profile_pic=l_profile_pic,profile_network_details=profile_network_details,l_profile_network_details=len(profile_network_details),edu_d=edu_d)



@app.route('/alumni/logout/')
def alumni_logout():
    if 'alumni_login_id' in session and 'alumni_login_email' in session and 'alumni_account_activated' in session :
        session['alumni_login_id'] = ""
        session['alumni_login_email'] = ""
        session['alumni_account_activated'] = ""
        session.pop('alumni_login_id',None)
        session.pop('alumni_login_email',None)
        session.pop('alumni_account_activated',None)
        return "<script>   window.location = '/alumni/login';</script>"
    else :
        return "<script>   window.location = '/alumni/login';</script>"

# College Routes

@app.route('/college/signup/',methods=['GET','POST'])
def college_signup():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isEmailExist = 0
    isMobileNoExist = 0
    session['college_signed_up_email'] = ""
    session['college_signed_up_f_name'] = ""
    session['college_signed_up_l_name'] = ""
    session['college_signed_up_url_part_1'] = ""
    session['college_signed_up_college'] = ""
        
    inserted_into_db = 0
    mail_sent = 0
    file_uploaded = 0
    if request.method=='GET':
        mode=request.args.get('mode')
        if mode == "3":
            college_id = request.args.get('v')
        
            sql = "SELECT * FROM college_degrees WHERE college_id=%d" % (int(college_id))
            con.execute(sql)
            res = con.fetchall()
            degrees = []
            for i in res:
                degrees.append(i[2])
                
            return jsonify(degrees=degrees)
        
        if mode == "2":
            country = request.args.get('v')
        
            sql = "SELECT * FROM countries WHERE name='%s'" % (country)
            con.execute(sql)
            res = con.fetchall()
            return str(res[0][3])
        
        
    if request.method == 'POST' :
        
        f_name = str(request.form['first_name']).lower()
        l_name = str(request.form['last_name']).lower()
        email = request.form['email']
        country_code = int(request.form['country_code'])
        mobile_number = int(request.form['mobile_number'])
        password = request.form['password']
        college_id = int(request.form['college'])
        # consent_letter = request.args.get('consent_letter')
            
            
        sql = "SELECT * FROM colleges WHERE college_id=%d" % (college_id)
        con.execute(sql)
        res = con.fetchall()
        college = str(res[0][1])
        try :
            #Checking Email or Mobile Exists Or Not
            sql = "SELECT * FROM college_spoc WHERE email='%s' AND isEmailVerified='YES'" % (email)
            con.execute(sql)
            res=con.fetchall()
            print("College Email Exist : ",len(res))
            if len(res) == 1 :
                print("College Erroor Mail/////////")
                flash(Markup("<p style='color:red;font-size:15px;'>This Email Is Already Registered With Us.</p>"))
                return redirect(url_for('college_signup'))
        except :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Comparing Email.</p>"))
            return redirect(url_for('college_signup'))
        
        try :
            #Checking  Mobile Exists Or Not
            sql = "SELECT * FROM college_spoc WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES'" % (country_code,mobile_number)
            con.execute(sql)
            res=con.fetchall()
            print("Mobile Exist : ",len(res))
            if len(res) == 1 :
                print("Erroor Mobile/////////")
                flash(Markup("<p style='color:red;font-size:15px;'>This Mobile Number Is Already Registered With Us.</p>"))
                return redirect(url_for('college_signup'))
        except :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Comparing Mobile Number.</p>"))
            return redirect(url_for('college_signup'))
            pass
            
            
            
        verification_code = str(uuid.uuid1())
            
        now = datetime.now()
        time = now.strftime("%Y-%m-%d %H:%M:%S")
            
            
        p_dirName = "/static/uploads/"

        try :
            os.mkdir(p_dirName)
                    
        except FileExistsError:
            print("Directory " + p_dirName + " already exists")
                    
        c_dirName = "static/uploads/consent_letters/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        c_dirName = "static/uploads/consent_letters/colleges/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
      
        try :
            
            
            
            file = request.files['file-upload']
            if file.filename == "" :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Upload Consent Letter.</p>"))
                return redirect(url_for('college_signup'))
            path = "uploads/consent_letters"+"/"
            # p = path+secure_filename(file.filename)
            p = "static/uploads/consent_letters/colleges/"+str(college_id)+"_"+verification_code+file.filename
            file.save(p)
            
            
        except :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading Consent Letter.</p>"))
            return redirect(url_for('college_signup'))  
           
        url_part_1 = str(verification_code)
            
        sql = "INSERT INTO college_spoc(college_id,first_name,last_name, email,country_code, mobile_number, password, college, consent_letter, isEmailVerified, isMobileVerified,isSpocVerified, verification_code,otp, account_status, time) VALUES(%d,'%s','%s','%s',%d,%d,'%s','%s','%s','%s','%s','%s','%s',%d,'%s','%s')" % (college_id,f_name,l_name,email,country_code,mobile_number,password,college,p,"NO","NO","NO",verification_code,000000,"NOT ACTIVATED",time)
            
        try :
            con.execute(sql)
            cnx.commit()
            inserted_into_db = 1
        except :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting Record In Database.</p>"))
            return redirect(url_for('college_signup'))
            print("College Error In Inserting In Database.")
            
            
        
            
        if inserted_into_db == 1 :
            msg = Message('VERIFY YOUR EMAIL', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                    <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Thanks for joiningto <strong>ALUMNI ASSOCIATION OF GOA</strong>\nOn Behalf Of <b>'''+college+'''</b>.\n Please Click On The "VERIFY MY EMAIL" Button To Verify Your Account.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''college/verify/email/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>VERIFY MY EMAIL</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Sending Mail.</p>"))
                return redirect(url_for('college_signup'))
                print("Error In Sending Mail.")
                    
            session['college_signed_up_email'] = email
            session['college_signed_up_f_name'] = f_name
            session['college_signed_up_l_name'] = l_name
            session['college_signed_up_url_part_1'] = url_part_1
            session['college_signed_up_college'] = college
        
            if mail_sent == 1 :
                return redirect(url_for("college_welcome_email"))
            else :
                return redirect(url_for("college_signup"))
            
        
        
        
        
    sql = "SELECT * FROM colleges"
    con.execute(sql)
    res = con.fetchall()
    colleges = []
    for i in res :
        colleges.append([i[0],i[1]])
        
    print("college : ",colleges)
    
    
    sql = "SELECT * FROM countries"
    con.execute(sql)
    res = con.fetchall()
    countries = []
    for i in res :
        countries.append(i)
        
    con.close()

    return render_template('college_signup.html',colleges=colleges,total_colleges=len(colleges),countries=countries)


@app.route('/college/welcome_email/')
def college_welcome_email():
    mail_sent = 0
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if session['college_signed_up_email'] == "" or session['college_signed_up_f_name'] == "" or session['college_signed_up_l_name'] == "" :
        return redirect(url_for('college_signup'))
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = session['college_signed_up_email']
            f_name = session['college_signed_up_f_name']
            l_name = session['college_signed_up_l_name']
            url_part_1 = session['college_signed_up_url_part_1']
            college = session['college_signed_up_college']
        
            msg = Message('VERIFY YOUR EMAIL', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                    <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Thanks for joiningto <strong>ALUMNI ASSOCIATION OF GOA</strong>.\nOn Behalf Of <b>'''+college+'''</b>.\nPlease Click On The "VERIFY MY EMAIL" Button To Verify Your Account.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''college/verify/email/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>VERIFY MY EMAIL</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                print("Error In Sending Mail.")
                
            if mail_sent == 1 :
                return jsonify(res=1)
            else :
                return jsonify(res=0)
    con.close()
    
    return render_template('college_welcome_email.html')



@app.route('/college/verify/email/<string:verification_code>')
def college_verify_email(verification_code):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            m_n = int(request.args.get("mobile_no"))
            c_c = int(request.args.get("country_code"))
            #Checking  Mobile Exists Or Not
            sql = "SELECT * FROM college_spoc WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND verification_code='%s'" % (c_c,m_n,verification_code)
            con.execute(sql)
            res=con.fetchall()
            print("Mobile Exist : ",len(res))
            if len(res) == 1 :
                print("Erroor Mobile/////////")
                return jsonify(res=0,error="EMailExist",msg="This Mobile Number Is Already Registered With Us.")
            else :
                otp = random.randrange(111111,999999)
              
                sql = "UPDATE college_spoc SET country_code=%d,mobile_number=%d,isMobileVerified='NO',otp=%d WHERE verification_code='%s'" % (c_c,m_n,otp,verification_code)
                con.execute(sql)
                cnx.commit()
                
                country_code = "+"+str(request.args.get("country_code")).strip()
                mobile_no = str(request.args.get("mobile_no"))
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Welcome To Alumni Association Of Goa. Your OTP is '+str(otp)

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        return jsonify(res=1)
                    else :
                        return jsonify(res=0,error='UnableSMS',msg="Unable To Send SMS.\nPlease Try Again Later.")
                except :
                    return jsonify(res=0,error='UnableSMS',msg="Unable To Send SMS.\nPlease Try Again Later.")
        
        if mode == "2" :    
            
            m_n = int(request.args.get("mobile_no"))
            c_c = int(request.args.get("country_code"))
            otp = int(request.args.get("otp"))
            
            sql = "SELECT * FROM college_spoc WHERE verification_code='%s'" % (verification_code)
            con.execute(sql)
            res = con.fetchall()
            d_otp = int(res[0][14])
            
            if otp == d_otp :
                sql = "UPDATE college_spoc SET isMobileVerified='YES',otp=%d WHERE verification_code='%s'" % (0,verification_code)
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1)
            else :
                return jsonify(res=0,error="InvalidOTP",msg="Invalid OTP.")
                
                
            
            
    
    if len(verification_code) == 0 :
        return redirect(url_for('college_signup'))
    else :
        sql = "SELECT * FROM college_spoc WHERE verification_code='%s'" % (verification_code)
        con.execute(sql)
        res = con.fetchall()
        country_code = "+"
        country_code += str(res[0][5])
        mobile_no = str(res[0][6])
        isEmailVerified = str(res[0][10])
        isMobileVerified = str(res[0][11])
        if len(res) == 1 :
            if isEmailVerified == "YES" :
                
                if isMobileVerified == "YES" :
                    flash("You Have Verified Email & Mobile Number Successfully.")
                else :
                    flash("Your Email Is Already Verified.")
            else :
                sql = "UPDATE college_spoc SET isEmailVerified='YES' WHERE verification_code='%s'" % (verification_code)
                con.execute(sql)
                cnx.commit()
                
                flash("Your Email Is Verified Successfully.")
                
    isBothVerified = 0
    if isEmailVerified == "YES" and isMobileVerified == "YES" :
        isBothVerified = 1
    else :
        isBothVerified = 0
    print(isBothVerified)
    con.close()
    return render_template('college_email_verification.html',country_code=country_code,mobile_no=mobile_no,verification_code=verification_code,isBothVerified=isBothVerified)




@app.route('/college/login/')
def college_login():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    accountActivated = 0
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = request.args.get('email')
            password = request.args.get('password')
            
            print(email)
            print(password)
            
            sql = "SELECT * FROM college_spoc WHERE email='%s' AND password='%s'" % (email,password)
            con.execute(sql)
            res = con.fetchall()
            print("execured")
            if len(res) >= 1 :
                sql = "SELECT * FROM college_spoc WHERE email='%s' AND password='%s' AND isEmailVerified='YES'" % (email,password)
                con.execute(sql)
                res = con.fetchall()
                print("e2")
                if len(res) >= 1 :
                    sql = "SELECT * FROM college_spoc WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email,password)
                    con.execute(sql)
                    res = con.fetchall()
                    print("e3")
                    print(res)
                    if len(res) == 1 :
                        sql = "SELECT * FROM college_spoc WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isSpocVerified='YES'" % (email,password)
                        con.execute(sql)
                        res = con.fetchall()
                        print("e4")
                        if len(res) == 1 :
                            sql = "SELECT * FROM college_spoc WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isSpocVerified='YES' AND account_status='ACTIVATED'" % (email,password)
                            con.execute(sql)
                            res = con.fetchall()
                            print("e5")
                            if len(res) == 1 :
                                accountActivated = 1
                                session['college_login_id'] = int(res[0][0])
                                session['college_login_email'] = email
                                session['college_account_activated'] = 1
                                print("e5")
                                return jsonify(res=1,error="No",msg="Successfully Logged In.") 
                            else :
                                print("e6")
                                return jsonify(res=0,error="NoSpocSpocReject",msg="Your Application Is Rejected, Please Apply Again.")
                        else :
                            print("e6")
                            return jsonify(res=0,error="NoSpocVerified",msg="You Account Is Not Verified By Alumni Association Of Goa.")
                            # return redirect(url_for('association_home'))
                    else :
                      return jsonify(res=0,error="NoMobileVerified",msg="Please Verify Your Mobile No. To Login.")  
                    
                else :
                   return jsonify(res=0,error="NoEmailVerified",msg="Please Verify Your Email To Login.") 
            else :
                print("c1")
                return jsonify(res=0,error="NoAccountFound",msg="Please Enter Correct Username & Password.")     
                
    con.close()
    return render_template('college_login.html')


@app.route('/college/home/')
def college_home():
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    
    
    con.close()
    return render_template("college_home.html")


@app.route("/college/alumni_applications")
def college_alumni_applications():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    applications = []
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
    else :
 
        sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        res = con.fetchall()
        account_details = res[0]
     
        
        sql = "SELECT * FROM students WHERE college='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='NO' AND account_status='NOT ACTIVATED'" % (account_details[8])
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            applications.append(i)
            
    if request.method=='GET':
        mode=request.args.get('mode')
        isUpdated = 0
        mail_sent = 0
        sms_sent = 0
        if mode == "1":
            alumni_id = int(request.args.get('alumni_id'))
            print("alumni id : ",alumni_id)
            sql = "UPDATE students SET isStudentVerified='YES',account_status='ACTIVATED' WHERE id=%d" % (alumni_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM students WHERE id=%d" % (alumni_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][3])
            name = str(res[0][1]) + " " + str(res[0][2])
            college = str(res[0][7])
            
        if isUpdated == 1 :
            msg = Message('Alumni Application Approved', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                         <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_confirmed_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Congratulations <b>'''+name+'''</b> ! Your application has been accepted by <b>'''+str(college)+'''</b>. Now you are officially part of ALUMNI ASSOCIATION OF GOA.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/login" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>LOGIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>            
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Confirmation Mail.")
            
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][4])
                mobile_no = str(res[0][5])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
              
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Congratulations '+name+' ! Your Application For Alumni has been approved by your college.'
                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
            
                
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    
                    if sms_sent == 1 :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.")
                    else :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.\nBut Unable To Send Confirmation SMS.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is accepted successfully but unable to send confirmation email.")
            else :
                return jsonify(res=0,error="AcceptUpdateError",msg="Unable To Accept Application.")
        
        if mode == "2":
            alumni_id = int(request.args.get('alumni_id'))
            print("alumni id : ",alumni_id)
            sql = "UPDATE students SET isStudentVerified='NO',account_status='REJECTED' WHERE id=%d" % (alumni_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM students WHERE id=%d" % (alumni_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][3])
            college = str(res[0][7])
            name = str(res[0][1]) + " " + str(res[0][2])
            
        if isUpdated == 1 :
            msg = Message('Alumni Application Rejected', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_rejected_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;text-align:left !important;word-wrap:break-word"><span style="font-size: 18px; color: #000000;;">
                                                      Thank you <b>'''+name+'''</b> for your alumni application at <b>'''+str(college)+'''</b>. We really appreciate your interest in joining our association and we want to thank you for the time and energy you invested in applying for this application.
                                                      <br><br>
                                                      <b>After carefully reviewing all of them, unfortunately, we have to inform you that this time we wont be able to invite you to ALUMNI ASSOCIATION OF GOA.</b> We hope youll keep us in mind and apply again in the future.

                                                      <br><br>If you have any questions or need additional information, please dont hesitate to contact us.
                                                      
We wish you every personal and professional success in your future endeavors.
                                                      
Once again, thank you for showing interest.

                                                      
                                                      </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''contact" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CONTACT US</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>                                     
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Rejection College Mail.")
                
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][4])
                mobile_no = str(res[0][5])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Unfortunately, Alumni Application for '+str(name)+' has been rejected. Better Luck Next Time.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
                
            
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    return jsonify(res=1,error="No",msg="Application Is Rejected Successfully.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is rejected successfully but unable to send rejection email.")
            
            else :
                return jsonify(res=0,error="RejectUpdateError",msg="Unable To Reject Application.")

    con.close()
    return render_template('college_alumni_applications.html',applications=applications,account_details=account_details,total_applications=len(applications))

@app.route("/college/alumni-recruiters-applications/")
def college_alumni_recruiters_applications():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    applications = []
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
    else :
 
        sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        res = con.fetchall()
        account_details = res[0]
        print(account_details)
        my_college = str(account_details[8])
        
        sql = "SELECT * FROM alumni_recruiters WHERE isActive='NO'"
        con.execute(sql)
        res = con.fetchall()
        applications = []
        for i in res :
            alumni_id = int(i[1])
            sql = "SELECT * FROM students WHERE id=%d" % (int(alumni_id))
            con.execute(sql)
            res2 = con.fetchall()
            print(res2)
            sql = "SELECT * FROM alumni_work_details WHERE id=%d AND alumni_id=%d" % (int(i[2]),int(alumni_id))
            con.execute(sql)
            res3 = con.fetchall()
            print(res3)
            if str(res2[0][7]) == my_college :
                applications.append([int(i[0]),int(res2[0][0]),str(res2[0][1]).capitalize(),str(res2[0][2]).capitalize(),str(res2[0][3]),int(res2[0][4]),int(res2[0][5]),str(res3[0][3]),str(res3[0][2]),str(res3[0][4]),str(res3[0][5]),int(res3[0][6]),i[4]])
            
    if request.method=='GET':
        mode=request.args.get('mode')
        isUpdated = 0
        mail_sent = 0
        sms_sent = 0
        if mode == "1":
            alumni_id = int(request.args.get('alumni_id'))
            recruit_id = int(request.args.get('recruit_id'))
            print("alumni id : ",alumni_id)
            sql = "UPDATE alumni_recruiters SET isActive='YES' WHERE id=%d AND alumni_id=%d" % (recruit_id,alumni_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM students WHERE id=%d" % (alumni_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][3])
            name = str(res[0][1]).capitalize() + " " + str(res[0][2]).capitalize()
            college = str(res[0][7])
            
        if isUpdated == 1 :
            msg = Message('Alumni Recruiter Application Approved', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                         <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_confirmed_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Congratulations <b>'''+name+'''</b> ! Your application for Alumni Recruiter has been accepted by <b>'''+str(college)+'''</b>.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/login" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>LOGIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>            
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Confirmation Mail.")
            
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][4])
                mobile_no = str(res[0][5])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
              
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Congratulations '+name+' ! Your Application For Alumni Recruiter has been approved by your college.'
                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
            
                
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    
                    if sms_sent == 1 :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.")
                    else :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.\nBut Unable To Send Confirmation SMS.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is accepted successfully but unable to send confirmation email.")
            else :
                return jsonify(res=0,error="AcceptUpdateError",msg="Unable To Accept Application.")
        
        if mode == "2":
            alumni_id = int(request.args.get('alumni_id'))
            recruit_id = int(request.args.get('recruit_id'))
            print("alumni id : ",alumni_id)
            sql = "DELETE FROM alumni_recruiters WHERE isActive='NO' AND  id=%d AND alumni_id=%d" % (recruit_id,alumni_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM students WHERE id=%d" % (alumni_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][3])
            college = str(res[0][7])
            name = str(res[0][1]).capitalize() + " " + str(res[0][2]).capitalize()
            
        if isUpdated == 1 :
            msg = Message('Alumni Recruiter Application Rejected', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_rejected_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;text-align:left !important;word-wrap:break-word"><span style="font-size: 18px; color: #000000;;">
                                                      Thank you <b>'''+name+'''</b> for your Alumni Recruiter Application at <b>'''+str(college)+'''</b>. We really appreciate your interest in joining our association and we want to thank you for the time and energy you invested in applying for this application.
                                                      <br><br>
                                                      <b>After carefully reviewing all of them, unfortunately, we have to inform you that this time we wont be able to accept your alumni recruiter application.</b> We hope youll keep us in mind and apply again in the future.

                                                      <br><br>If you have any questions or need additional information, please dont hesitate to contact us.
                                                      
We wish you every personal and professional success in your future endeavors.
                                                      
Once again, thank you for showing interest.

                                                      
                                                      </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''contact" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CONTACT US</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>                                     
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Rejection College Mail.")
                
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][4])
                mobile_no = str(res[0][5])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Unfortunately, Alumni Recruiter Application for '+str(name)+' has been rejected. Better Luck Next Time.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
                
            
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    return jsonify(res=1,error="No",msg="Application Is Rejected Successfully.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is rejected successfully but unable to send rejection email.")
            
            else :
                return jsonify(res=0,error="RejectUpdateError",msg="Unable To Reject Application.")

    con.close()
    print(applications)
    return render_template('college_alumni_recruitment_applications.html',applications=applications,account_details=account_details,total_applications=len(applications))



@app.route("/college/add_alumni/",methods=['GET','POST'])
def college_add_alumni():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    
    if request.method=='GET':
        mode = request.args.get('mode')

        if mode == "1" :
            print("Hellow")
            f_name = request.args.get('f_name')
            l_name = request.args.get('l_name')
            email = request.args.get('email')
            country_code = int(request.args.get('country_code'))
            mobile_number = int(request.args.get('mobile_number'))
            college_id = int(request.args.get('college'))
            degree = request.args.get('degree')
            enrollment_number = int(request.args.get('enrollment_number'))
            entry_year = int(request.args.get('entry_year'))
            passout_year = int(request.args.get('passout_year'))
            
            sql = "SELECT * FROM colleges WHERE college_id=%d" % (college_id)
            con.execute(sql)
            res = con.fetchall()
            college = str(res[0][1])
            # print(college)
            
            try :
                #Checking Email In The students_added_by_college Exists Or Not
                sql = "SELECT * FROM students_added_by_college WHERE email='%s'" % (email)
                con.execute(sql)
                res=con.fetchall()
                print("students_added_by_college Email Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mail/////////")
                    return jsonify(res=0,error="EMailExist",msg="This Email Record Is Already Added.")
            except :
                pass
            
            try :
                #Checking  Mobile  students_added_by_college Exists Or Not
                sql = "SELECT * FROM students_added_by_college WHERE country_code=%d AND mobile_number=%d" % (country_code,mobile_number)
                con.execute(sql)
                res=con.fetchall()
                print("students_added_by_college Mobile Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mobile/////////")
                    return jsonify(res=0,error="MobileExist",msg="This Mobile Number Is Already Added.")
            except :
                pass
            
            
            try :   
                #Checking For Student Record Exists Or Not in students_added_by_college
                sql = "SELECT * FROM students_added_by_college WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d" % (college,degree,enrollment_number,entry_year,passout_year)
                con.execute(sql)
                res=con.fetchall()
                print("students_added_by_college Student Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Student Exist/////////")
                    return jsonify(res=0,error="EMailExist",msg="A Student Record Is Already Added.")
            except :
                pass   
            
            
            try :
                #Checking Email or Mobile Exists Or Not
                sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isStudentVerified='YES'" % (email)
                con.execute(sql)
                res=con.fetchall()
                print("Email Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mail/////////")
                    return jsonify(res=0,error="EMailExist",msg="This Email Is Already Registered With Us.")
            except :
                pass
            try :
                #Checking  Mobile Exists Or Not
                sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES'  AND isStudentVerified='YES'" % (country_code,mobile_number)
                con.execute(sql)
                res=con.fetchall()
                print("Mobile Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mobile/////////")
                    return jsonify(res=0,error="MobileExist",msg="This Mobile Number Is Already Registered With Us.")
            except :
                pass
            
            try :   
                #Checking For Student Record Exists Or Not
                sql = "SELECT * FROM students WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='YES'  AND isMobileVerified='YES'  AND isEmailVerified='YES'" % (college,degree,enrollment_number,entry_year,passout_year)
                con.execute(sql)
                res=con.fetchall()
                print("Student Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Student Exist/////////")
                    return jsonify(res=0,error="EMailExist",msg="A Student Record Is Already Registered With Us.")
            except :
                pass   
            
            
            
            
            verification_code = str(uuid.uuid1())
            
            now = datetime.now()
            time = now.strftime("%Y-%m-%d %H:%M:%S")
            
            mail_sent = 0
            
            url_part_1 = str(verification_code)
            isIns = 0
            sql = "INSERT INTO students_added_by_college(spoc_id,first_name,last_name,email,country_code,mobile_number,college,degree,enrollment_number,entry_year,passout_year,isEmailVerified,isMobileVerified,isStudentVerified,isEmailSent,verification_code,otp,account_status,date_time) VALUES (%d,'%s','%s','%s',%d,%d,'%s','%s',%d,%d,%d,'%s','%s','%s','%s','%s',%d,'%s','%s')" % (int(session['college_login_id']),str(f_name).lower(),str(l_name).lower(),email,country_code,mobile_number,college,degree,enrollment_number,entry_year,passout_year,"NO","NO","NO","NO",verification_code,000000,"NOT ACTIVATED",time)
            # sql = "INSERT INTO students_added_by_college(first_name,last_name, email,country_code, mobile_number, college, degree, enrollment_number, entry_year, passout_year, isEmailVerified, isMobileVerified,isStudentVerified,isEmailSent, verification_code,otp, account_status, time) VALUES('%s','%s','%s',%d,%d,'%s','%s',%d,%d,%d,'%s','%s','%s','%s','%s',%d,'%s','%s')" 
            
            try :
                con.execute(sql)
                cnx.commit()
                isIns = 1
            except :
                return jsonify(res=0,msg="Error In Inserting In DB.")
                print("Error In Inserting In Database.")
            
            if isIns == 1 :
                msg = Message('INVITATION TO JOIN ALUMNI ASSOCIATION OF GOA', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
                msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                    <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">You Are Invited To Join Alumni Association Of Goa From <b>'''+str(college)+'''</b>. Please Click On The "JOIN NOW" Button To Join.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/custom/invitation/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>JOIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>
                '''
                try :
                    mail.send(msg)
                    mail_sent = 1
                except :
                    print("Error In Sending Mail.")
            
            if mail_sent == 1 : 
                sql = "UPDATE students_added_by_college SET isEmailSent='YES' WHERE verification_code='%s'" % (verification_code)
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Invitation Sent To Join.")
            else :   
                return jsonify(res=0,msg="Error In Sending Invitation Email.")
            
     
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 1 :
            c_dirName = "static/uploads/bulk-registration-uploads/"

            try :
                os.mkdir(c_dirName)
                        
            except FileExistsError:
                print("Directory " + c_dirName + " already exists")

      
            try :
            
            
                r = str(uuid.uuid1()).replace("-","_")
                file = request.files['bulk-registration-file']
                path = "static/uploads/bulk-registration-uploads/"+str(session['college_login_id'])+"_"+str(r)+"_"+file.filename
                file.save(path)
            
                print("File Uploaded")
                
                file_loc = path
                
                file = xlrd.open_workbook(file_loc)
                sheet = file.sheet_by_index(0)
                    
                main_content = []
                k = 0
                for i in range(1,sheet.nrows):   
                    cont = [] 
                    isError = 0
                    for j in range(11):
                      
                        try :
                            t = sheet.cell_value(i,j) // 1
                            t = str(t).replace(".0","")
                               
                        except :
                            t = str(sheet.cell_value(i,j))
                        
                        
                        if len(t) == 0 :
                            cont.append("")
                            isError = 1
                        else :
                            cont.append(t)
                            
                    if isError == 1 :
                        cont.append("NO")
                    else :
                        cont.append("YES")
                        
                    main_content.append(cont)    
                    
                print(main_content)  
                # con.close()
               
                # session['excel-file-content'] = ans
                session['excel-file-sheet-rows'] = sheet.nrows
                session['excel-file-sheet-columns'] = 11
                if sheet.nrows < 2 :
                    print("Please Enter Record In Sheet.")
                
                if sheet.ncols != 11 :
                    print("Please Uplaod In Proper Format.")
                 
                ans = "<table id='example' class='display nowrap' style='width:100%;'>"
                
                for i in range(sheet.nrows):    
                    if i == 0 :
                        ans += "<thead><tr>"
                    for j in range(11):
                        if i == 0 :
                            ans += "<th style='padding:10px;'>"+str(sheet.cell_value(i,j))+"</th>"
                    if i == 0 :
                        ans += "</thead></tr>"            
                
                for i in range(len(main_content)) :
                    if i == 0 :
                        ans += "<tbody>"
                    ans += "<tr>"
                    for j in range(len(main_content[i])) :
                        
                        if j == 6 :
                            c_id = str(main_content[i][j]).replace("College_","")
                            print(c_id)
                            sql = "SELECT * FROM colleges WHERE college_id=%d" % (int(c_id))
                            con.execute(sql)
                            res = con.fetchall()
                            print(res)
                            main_content[i][j] = res[0][1]
                            
                        ans += "<td style='text-align:center;padding:10px;'>"+main_content[i][j]+"</td>"
                    
                    ans += "</tr>"   
                            
                ans += "</tbody>"
                ans += "</table>"
                      
                # print(main_content)
                session['excel-file-ans'] = ans
                session['excel-file-content'] = main_content
                
                return redirect(url_for("college_read_file"))
            
                
            except :
                print("Error FIle Upload.")
        
    
    sql = "SELECT * FROM colleges"
    con.execute(sql)
    res = con.fetchall()
    colleges = []
    for i in res :
        colleges.append([i[0],i[1]])
            
    
    sql = "SELECT * FROM countries"
    con.execute(sql)
    res = con.fetchall()
    countries = []
    for i in res :
        countries.append(i)
        
    con.close()
    
    session['excel-file-ans'] = ""
    session['excel-file-content'] = ""
    session['excel-file-sheet-rows'] = 0
    session['excel-file-sheet-columns'] = 0 
    
    return render_template("college_add_alumni.html",colleges=colleges,total_colleges=len(colleges),countries=countries)

@app.route('/college/readfile',methods=['GET','POST'])
def college_read_file():

    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    html_con = session['excel-file-ans']
    main_content = session['excel-file-content']
    total_rows = session['excel-file-sheet-rows']
    total_columns = session['excel-file-sheet-columns']
    
    print(main_content)
    for i in range(len(main_content)) :
        main_content[i].append("")
        main_content[i][1] = str(main_content[i][1]).lower()
        main_content[i][2] = str(main_content[i][2]).lower()
        main_content[i][12] = "X"
        if main_content[i][11] == "YES" :
            main_content[i][12] = "X"
            try :
                #Checking Email In The students_added_by_college Exists Or Not
                sql = "SELECT * FROM students_added_by_college WHERE email='%s'" % (main_content[i][3])
                con.execute(sql)
                res=con.fetchall()
                print("students_added_by_college Email Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mail/////////")
                    main_content[i][12] = "This Email Record Is Already Added."
            except :
                pass
            
            try :
                #Checking  Mobile  students_added_by_college Exists Or Not
                sql = "SELECT * FROM students_added_by_college WHERE country_code=%d AND mobile_number=%d" % (int(main_content[i][4]),int(main_content[i][5]))
                con.execute(sql)
                res=con.fetchall()
                print("students_added_by_college Mobile Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mobile/////////")
                    main_content[i][12] = "This Mobile Number Is Already Added."
            except :
                pass
            
            
            try :   
                #Checking For Student Record Exists Or Not in students_added_by_college
                sql = "SELECT * FROM students_added_by_college WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d" % (str(main_content[i][6]),str(main_content[i][7]),int(main_content[i][8]),int(main_content[i][9]),main_content[i][10])
                con.execute(sql)
                res=con.fetchall()
                print("students_added_by_college Student Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Student Exist/////////")
                    main_content[i][12] = "A Student Record Is Already Added."
            except :
                pass   
            
            
            try :
                #Checking Email or Mobile Exists Or Not
                sql = "SELECT * FROM students WHERE email='%s' AND isEmailVerified='YES' AND isStudentVerified='YES'" % (main_content[i][3])
                con.execute(sql)
                res=con.fetchall()
                print("Email Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mail/////////")
                    main_content[i][12] = "This Email Is Already Registered With Us."
            except :
                pass
            try :
                #Checking  Mobile Exists Or Not
                sql = "SELECT * FROM students WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES'  AND isStudentVerified='YES'" % (int(main_content[i][4]),int(main_content[i][5]))
                con.execute(sql)
                res=con.fetchall()
                print("Mobile Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Mobile/////////")
                    main_content[i][12] = "This Mobile Number Is Already Registered With Us."
            except :
                pass
            
            try :   
                #Checking For Student Record Exists Or Not
                sql = "SELECT * FROM students WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='YES'  AND isMobileVerified='YES'  AND isEmailVerified='YES'" % (str(main_content[i][6]),str(main_content[i][7]),int(main_content[i][8]),int(main_content[i][9]),int(main_content[i][10]))
                con.execute(sql)
                res=con.fetchall()
                print("Student Exist : ",len(res))
                if len(res) == 1 :
                    print("Erroor Student Exist/////////")
                    main_content[i][12] = "A Student Record Is Already Registered With Us."
            except :
                pass   
        
        else :
            main_content[i][12] = "Y"
            
    
    # print(main_content)
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 1 :
            
            total_added = 0
            for i in main_content : 
                if str(i[11]) == "YES" and str(i[12]) == "X" :
                    verification_code = str(uuid.uuid1())
                        
                    now = datetime.now()
                    time = now.strftime("%Y-%m-%d %H:%M:%S")
                        
                    mail_sent = 0
                        
                    url_part_1 = str(verification_code)
                    isIns = 0
                
                    sql = "INSERT INTO students_added_by_college(spoc_id,first_name,last_name,email,country_code,mobile_number,college,degree,enrollment_number,entry_year,passout_year,isEmailVerified,isMobileVerified,isStudentVerified,isEmailSent,verification_code,otp,account_status,date_time) VALUES (%d,'%s','%s','%s',%d,%d,'%s','%s',%d,%d,%d,'%s','%s','%s','%s','%s',%d,'%s','%s')" % (int(session['college_login_id']),str(i[1]),str(i[2]),str(i[3]),int(i[4]),int(i[5]),str(i[6]),str(i[7]),int(i[8]),int(i[9]),int(i[10]),"NO","NO","NO","NO",verification_code,000000,"NOT ACTIVATED",time)

                    try :
                        con.execute(sql)
                        cnx.commit()
                        total_added += 1   
                    except :
                        return jsonify(res=0,msg="Error In Inserting.")
                        print("colege bulk : Error In Inserting In Database.")
                
            
            c_msg = str(total_added)+" Records Added."
            return jsonify(res=1,msg=c_msg)
            
        
    
    
    con.close()
    
    return render_template("college_bulk_registration_read.html",main_content=main_content,html_con=html_con,total_rows=total_rows,total_columns=total_columns)


@app.route('/college/fund-raising-project/',methods=['GET','POST'])
def college_fund_raising_project():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        f_r_p_title = str(request.form['f_r_p_title']).strip()
        f_r_p_desc = str(request.form['f_r_p_desc']).strip()
        f_r_p_poster_file = request.files['f_r_p_poster_file']
        f_r_p_amount = 0
        if f_r_p_poster_file.filename == "" or len(f_r_p_poster_file.filename) == 0 :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Upload Featured Image For Project.</p>"))
            return redirect(url_for('college_fund_raising_project'))
        try :
            f_r_p_amount = int(request.form['f_r_p_amount'])
            if f_r_p_amount <= 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Amount To Raise.</p>"))
                return redirect(url_for('college_fund_raising_project'))
        except :
            flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Amount To Raise .</p>"))
            return redirect(url_for('college_fund_raising_project'))
    
        f_r_p_documents = request.files.getlist('f_r_p_documents')
        isDocument = 0
        print(f_r_p_title)
        print(f_r_p_desc)
        print(f_r_p_poster_file.filename)
        print(f_r_p_amount)
        print(f_r_p_documents)
        
        session['f_r_p_title'] = f_r_p_title
        session['f_r_p_desc'] = f_r_p_desc
        session['f_r_p_amount'] = f_r_p_amount
        
        total_docs = 0
        total_uploaded_docs = 0
        for i in f_r_p_documents :
            if i.filename != "" or len(i.filename) != 0 :
                isDocument = 1
                total_docs += 1
            else :
                isDocument = 0
                break
        isPosterUploaded = 0
        c_dirName = "static/uploads/fund_raising_projects/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
        verification_code = str(uuid.uuid1())
        try :
            path_poster = "static/uploads/fund_raising_projects/"+str(session['college_login_id'])+"_f_r_p_poster_"+verification_code+f_r_p_poster_file.filename
            f_r_p_poster_file.save(path_poster)
            isPosterUploaded = 1
        except :
            print("Error FIle Upload.")
        doc_paths = []
        if isPosterUploaded == 1 :     

            if isDocument == 1 :
                    
                try :
                    for i in f_r_p_documents :
                        verification_code = str(uuid.uuid1())
                        isDocUploaded = 0
                        try :
                            path = "static/uploads/fund_raising_projects/"+str(session['college_login_id'])+"_f_r_p_poster_"+verification_code+i.filename
                            i.save(path)
                            isDocUploaded = 1
                            total_uploaded_docs += 1
                        except :
                            print("Error In Uploading "+str(i.filename))
                        if isDocUploaded == 1 :
                            doc_paths.append(path) 
                except :
                    print("Error FIle Upload.")
                print(total_uploaded_docs, total_docs)
                print(doc_paths)
                if total_uploaded_docs == total_docs :
                    print("All FRP Docs Uploaded.")
                else :
                    flash(Markup("<p style='font-size:15px;color:red;'>Error In Uploading All Documents.</p>"))
                    return redirect(url_for('college_fund_raising_project'))
            
            now = datetime.now()
            d_t = now.strftime("%Y-%m-%d %H:%M:%S")
            
            isInserted = 0
            
            sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = str(res[0][8])
            if len(doc_paths) == 0 :
                sql = "INSERT INTO fund_raising_projects(membership_type,user_id,college,project_title,project_description,project_poster,project_documents,project_goal_amount,project_collected_amount,isVerifiedByCollege,verifiedBySpocId,isVerifiedByAssociation,	verifiedByAssociationId,status,date_time) VALUES ('%s',%d,'%s','%s','%s','%s','%s',%d,%d,'%s',%d,'%s',%d,'%s','%s')" % ("COLLEGE SPOC",int(session['college_login_id']),str(my_college),str(f_r_p_title),str(f_r_p_desc),str(path_poster),"NO",int(f_r_p_amount),0,"YES",int(session['college_login_id']),"NO",0,"ACTIVATED BY COLLEGE",d_t)
                con.execute(sql)
                cnx.commit()
                isInserted = 1
            else :
                d_c_p = ""
                for i in range(len(doc_paths)) :
                    if i == len(doc_paths)-1 :
                        d_c_p += str(doc_paths[i])
                    else :
                        d_c_p += str(doc_paths[i])+","
                print(d_c_p)
                sql = "INSERT INTO fund_raising_projects(membership_type,user_id,college,project_title,project_description,project_poster,project_documents,project_goal_amount,project_collected_amount,isVerifiedByCollege,verifiedBySpocId,isVerifiedByAssociation,verifiedByAssociationId,status,date_time) VALUES ('%s',%d,'%s','%s','%s','%s','%s',%d,%d,'%s',%d,'%s',%d,'%s','%s')" % ("COLLEGE SPOC",int(session['college_login_id']),str(my_college),str(f_r_p_title),str(f_r_p_desc),str(path_poster),str(d_c_p),int(f_r_p_amount),0,"YES",int(session['college_login_id']),"NO",0,"ACTIVATED BY COLLEGE",d_t)
                con.execute(sql)
                cnx.commit()
                isInserted = 1
                
            if isInserted == 1 :
                session['f_r_p_title'] = ""
                session['f_r_p_desc'] = ""
                session['f_r_p_amount'] = ""
                flash(Markup("<p style='font-size:15px;color:green;'>Fund Raising Project Is Added Successfully.</p>"))
                return redirect(url_for('college_fund_raising_project'))
            else :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Adding Fund Raising Project.</p>"))
                return redirect(url_for('college_fund_raising_project'))
    
    con.close()
    return render_template("college_fund_raising_projects.html")

@app.route("/college/fund-raising-projects/applications",methods=['GET','POST'])
def college_fund_raising_projects_alumni_applications():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    applications = []
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
  
 
        
    if request.method=='GET':
        mode=request.args.get('mode')
        isUpdated = 0
        mail_sent = 0
        sms_sent = 0
        if mode == "1":
            project_id = int(request.args.get('project_id'))
            name = str(request.args.get('name'))
            email = str(request.args.get('email'))
            mobile_no = str(request.args.get('mobile_no')).replace(" ","")
            mobile_no = int(mobile_no)
            college = str(request.args.get('college'))
            sql = "UPDATE fund_raising_projects SET isVerifiedByCollege='YES',verifiedBySpocId=%d,status='ACTIVATED BY COLLEGE' WHERE id=%d" % (int(session['college_login_id']),project_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            
        if isUpdated == 1 :
            msg = Message('Fund Raising Project Application Approved', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                         <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_confirmed_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Congratulations <b>'''+name+'''</b> ! Your application for fund raising project has been accepted by <b>'''+str(college)+'''</b>. </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/login" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>LOGIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>            
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Confirmation Mail.")
            
            if mail_sent == 1 :    
        
                final_mobile_no = str(mobile_no)
              
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Congratulations '+str(name)+' ! Your Application For Fund Raising Project has been approved by your college.'
                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
            
                
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    
                    if sms_sent == 1 :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.")
                    else :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.\nBut Unable To Send Confirmation SMS.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is accepted successfully but unable to send confirmation email.")
            else :
                return jsonify(res=0,error="AcceptUpdateError",msg="Unable To Accept Application.")
        else :
            print("Error In Updating FRP Status At College.")
            
        if mode == "2":
            project_id = int(request.args.get('project_id'))
            name = str(request.args.get('name'))
            email = str(request.args.get('email'))
            mobile_no = str(request.args.get('mobile_no')).replace(" ","")
            mobile_no = int(mobile_no)
            college = str(request.args.get('college'))
            sql = "UPDATE fund_raising_projects SET isVerifiedByCollege='NO',verifiedBySpocId=%d,status='REJECTED BY COLLEGE' WHERE id=%d" % (int(session['college_login_id']),project_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
        if isUpdated == 1 :
            msg = Message('Fund Raising Project Application Rejected', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_rejected_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;text-align:left !important;word-wrap:break-word"><span style="font-size: 18px; color: #000000;;">
                                                      Thank you <b>'''+name+'''</b> for your fund raising project application at <b>'''+str(college)+'''</b>. We really appreciate your interest in applying for fund raising project application and we want to thank you for the time and energy you invested in applying for this application.
                                                      <br><br>
                                                      <b>After carefully reviewing all of them, unfortunately, we have to inform you that this time we wont be able to accept your application of fund raising project.</b> We hope youll keep us in mind and apply again in the future.

                                                      <br><br>If you have any questions or need additional information, please dont hesitate to contact us.
                                                      
We wish you every personal and professional success in your future endeavors.
                                                      
Once again, thank you for showing interest.

                                                      
                                                      </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''contact" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CONTACT US</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>                                     
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Rejection College Mail.")
                
            if mail_sent == 1 :    
              
            
                final_mobile_no = str(mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Unfortunately, Fund Raising Project Application for '+str(name)+' has been rejected. Better Luck Next Time.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
                
            
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    return jsonify(res=1,error="No",msg="Application Is Rejected Successfully.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is rejected successfully but unable to send rejection email.")
            
            else :
                return jsonify(res=0,error="RejectUpdateError",msg="Unable To Reject Application.")
            
            
            
    sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
    con.execute(sql)
    res = con.fetchall()
    account_details = res[0]
     
        
    sql = "SELECT * FROM fund_raising_projects WHERE college='%s' AND membership_type='ALUMNI' AND isVerifiedByCollege='NO' AND status='NOT ACTIVATED'" % (account_details[8])
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        applications.append(list(i))

        
    for i in range(len(applications)) :
        sql = "SELECT * FROM students WHERE id=%d" % (int(applications[i][2]))
        con.execute(sql)
        res = con.fetchall()
        nam = str(res[0][1]).capitalize() + " " + str(res[0][2]).capitalize()
        applications[i].append(str(nam))
        applications[i].append(str(res[0][3]))
        m_n = str(res[0][4]) + " " + str(res[0][5])
        applications[i].append(str(m_n))

  
    print(applications)
    con.close()
    return render_template('college_alumni_fund_raising_projects_applications.html',applications=applications,account_details=account_details,total_applications=len(applications))

@app.route('/college/view/fund-raising-project/<int:project_id>',methods=['GET','POST'])
def college_view_fund_raising_project(project_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    now = datetime.now()
    d_t = now.strftime("%Y-%m-%d %H:%M:%S")
    order_id = str(uuid.uuid1()).replace("-","")
    

    project_details = []
    sql = "SELECT * FROM fund_raising_projects WHERE id=%d AND membership_type='COLLEGE SPOC'" % (int(project_id))
    con.execute(sql)
    project_details = con.fetchall()
    if len(project_details) == 0 :
        return redirect(url_for('index'))
    
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])

    
    if request.method == "GET" :
        mode = request.args.get("mode")
        if mode == "1" :
            to_pay_amount = request.args.get('amount')
            if int(to_pay_amount) <= amount_remaining_to_collect :
                session['to_pay_amount'] = int(to_pay_amount)
                session['f_r_p_project_id'] = int(project_details[0][0])
                return jsonify(res=1)
            else :
                return jsonify(res=0,msg="Anount Must Be Less Than "+str(amount_remaining_to_collect))
            
    
    p_d = []
    project_docs =[]
    for i in range(len(project_details)) :
        if project_details[i][7] != "NO" :
            x = str(project_details[i][7]).split(",")
            for j in x :
                project_docs.append(j)

    isAllowedForCollege = "NO"
    isAllowedForAssociation = "NO"
    isAllowedForAlumni = "NO"
    isRejected = 0
    isActivated = 0
    if project_details[0][10] == "YES" and project_details[0][12] == "YES" and project_details[0][14] == "ACTIVATED BY ASSOCIATION" :
        isAllowedForAssociation = "YES"
        isAllowedForCollege = "YES"
        isAllowedForAlumni = "YES"
        isActivated = 1

    else :
        if project_details[0][10] == "YES" and project_details[0][12] == "NO" and project_details[0][14] == "ACTIVATED BY COLLEGE" :
            isAllowedForAssociation = "NO"
            isAllowedForCollege = "YES"
            isAllowedForAlumni = "YES"
        else :
            if project_details[0][10] == "NO" and project_details[0][12] == "NO" and project_details[0][14] == "REJECTED BY COLLEGE" :
                isAllowedForCollege = "NO"
                isAllowedForAlumni = "NO"
                isAllowedForAssociation = "NO"
                isRejected = 1
            else :
                if project_details[0][12] == "NO" and project_details[0][10] == "YES" and project_details[0][14] == "REJECTED BY ASSOCIATION" :
                    isAllowedForCollege = "YES"
                    isAllowedForAlumni = "YES"
                    isAllowedForAssociation = "NO"
                else :
                    isAllowedForAssociation = "NO"
                    isAllowedForCollege = "NO"
                    isAllowedForAlumni = "NO"

    print(isAllowedForCollege)
    print(isAllowedForAssociation)
    print(isAllowedForAlumni)
    print(isRejected)
    print(isActivated)
    isPersonDonate = "NO"
    my_college = ""
    d_e = ""
    d_m_n = ""
    if isActivated != 1 :
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            if str(my_college) == str(project_details[0][3]) and isAllowedForAlumni == "YES":
                isPersonDonate = "YES"
            
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                if str(my_college) == str(project_details[0][3]) and isAllowedForCollege == "YES":
                    isPersonDonate = "YES"
            
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    if isAllowedForAssociation == "YES" :
                        isPersonDonate = "YES"
    
    else :    
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            isPersonDonate = "YES"
            
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                isPersonDonate = "YES"
            
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    isPersonDonate = "YES"
                                 
                  
            
    
        
    
    session['f_r_p_project_id'] = project_id
    session['to_pay_amount'] = 0
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    percent_collected = (100 * int(project_details[0][9])) // int(project_details[0][8])
    
    gifts = []
    sql = "SELECT * FROM fund_raising_projects_payments WHERE project_id=%d AND payment_status='captured' AND payment_done='DONE' ORDER BY date_time DESC LIMIT 5" % (int(project_details[0][0]))
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        if i[2] == "ALUMNI" :
            sql = "SELECT first_name,last_name FROM students WHERE id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
                
        if i[2] == "COLLEGE SPOC" :
            sql = "SELECT first_name,last_name FROM colle_spoc WHERE spoc_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
            
            
        if i[2] == "ASSOCIATION" :
            sql = "SELECT first_name,last_name FROM association WHERE association_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM association_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
        random_bg_color = color[0]
        gifts.append([res2[0][0],res2[0][1],i[2],i[6],image,random_bg_color])
    # print(gifts)
    #
    bar_percent = (400 * int(project_details[0][9])) // int(project_details[0][8])
    
    con.close()
    return render_template("college_view_fund_raising_projects.html",project_details=project_details,project_docs=project_docs,isAllowedForAlumni=isAllowedForAlumni,isAllowedForCollege=isAllowedForCollege,isAllowedForAssociation=isAllowedForAssociation,isPersonDonate=isPersonDonate,my_college=my_college,d_e=d_e,d_m_n=d_m_n,amount_remaining_to_collect=amount_remaining_to_collect,order_id=order_id,percent_collected=percent_collected,gifts=gifts,l_gifts=len(gifts),bar_percent=bar_percent,isRejected=isRejected)

@app.route('/college/view/fund-raising-project/payment/', methods=['GET','POST'])
def college_fund_raising_project_payment():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    now = datetime.now()
    d_t = now.strftime("%Y-%m-%d %H:%M:%S")
    order_id = str(uuid.uuid1()).replace("-","")
    
    project_id =  session['f_r_p_project_id']
    project_details = []
    sql = "SELECT * FROM fund_raising_projects WHERE id=%d AND membership_type='COLLEGE SPOC'" % (int(project_id))
    con.execute(sql)
    project_details = con.fetchall()
    if len(project_details) == 0 :
        return redirect(url_for('index'))
    
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])

    p_d = []
    project_docs =[]
    for i in range(len(project_details)) :
        if project_details[i][7] != "NO" :
            x = str(project_details[i][7]).split(",")
            for j in x :
                project_docs.append(j)

    isAllowedForCollege = "NO"
    isAllowedForAssociation = "NO"
    isAllowedForAlumni = "NO"
    isRejected = 0
    isActivated = 0
    if project_details[0][10] == "YES" and project_details[0][12] == "YES" and project_details[0][14] == "ACTIVATED BY ASSOCIATION" :
        isAllowedForAssociation = "YES"
        isAllowedForCollege = "YES"
        isAllowedForAlumni = "YES"
        isActivated = 1

    else :
        if project_details[0][10] == "YES" and project_details[0][12] == "NO" and project_details[0][14] == "ACTIVATED BY COLLEGE" :
            isAllowedForAssociation = "NO"
            isAllowedForCollege = "YES"
            isAllowedForAlumni = "YES"
        else :
            if project_details[0][10] == "NO" and project_details[0][12] == "NO" and project_details[0][14] == "REJECTED BY COLLEGE" :
                isAllowedForCollege = "NO"
                isAllowedForAlumni = "NO"
                isAllowedForAssociation = "NO"
                isRejected = 1
            else :
                if project_details[0][12] == "NO" and project_details[0][10] == "YES" and project_details[0][14] == "REJECTED BY ASSOCIATION" :
                    isAllowedForCollege = "YES"
                    isAllowedForAlumni = "YES"
                    isAllowedForAssociation = "NO"
                else :
                    isAllowedForAssociation = "NO"
                    isAllowedForCollege = "NO"
                    isAllowedForAlumni = "NO"

    print(isAllowedForCollege)
    print(isAllowedForAssociation)
    print(isAllowedForAlumni)
    print(isRejected)
    print(isActivated)
    
    isPersonDonate = "NO"
    my_college = ""
    d_e = ""
    d_m_n = ""
    logged_in_type = ""
    if isActivated != 1 :
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            if str(my_college) == str(project_details[0][3]) and isAllowedForAlumni == "YES":
                isPersonDonate = "YES"
                logged_in_type = "ALUMNI"
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                if str(my_college) == str(project_details[0][3]) and isAllowedForCollege == "YES":
                    isPersonDonate = "YES"
                    logged_in_type = "COLLEGE SPOC"
            
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    if isAllowedForAssociation == "YES" :
                        isPersonDonate = "YES"
                        logged_in_type = "ASSOCIATION"
    
    else :    
        if 'alumni_login_id' in session :
            sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            my_college = res[0][7]
            d_e = str(res[0][3])
            d_m_n = "+"+str(res[0][4])+str(res[0][5])
            isPersonDonate = "YES"
            logged_in_type = "ALUMNI"
            
        else :
            if 'college_login_id' in session :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                my_college = res[0][8]
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
                isPersonDonate = "YES"
                logged_in_type = "COLLEGE SPOC"
                
            else :
                if 'association_login_id' in session :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    my_college = res[0][7]
                    d_e = str(res[0][3])
                    d_m_n = "+"+str(res[0][4])+str(res[0][5])
                    isPersonDonate = "YES"
                    logged_in_type = "ASSOCIATION"
                            
                  
            
    
        
    
    session['f_r_p_project_id'] = project_id

    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    percent_collected = (100 * int(project_details[0][9])) // int(project_details[0][8])
    
    gifts = []
    sql = "SELECT * FROM fund_raising_projects_payments WHERE project_id=%d AND payment_status='captured' AND payment_done='DONE' ORDER BY date_time DESC LIMIT 5" % (int(project_details[0][0]))
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        if i[2] == "ALUMNI" :
            sql = "SELECT first_name,last_name FROM students WHERE id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
                
        if i[2] == "COLLEGE SPOC" :
            sql = "SELECT first_name,last_name FROM colle_spoc WHERE spoc_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
            
            
        if i[2] == "ASSOCIATION" :
            sql = "SELECT first_name,last_name FROM association WHERE association_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM association_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
        random_bg_color = color[0]
        gifts.append([res2[0][0],res2[0][1],i[2],i[6],image,random_bg_color])
    # print(gifts)
    #
    bar_percent = (400 * int(project_details[0][9])) // int(project_details[0][8])
    
    
        
    
    if 'to_pay_amount' not in session :
        return redirect(url_for('index'))
    pay_amt_inr = 0
    pay_amt = 0
    try :
        pay_amt = int(session['to_pay_amount'])
        pay_amt_inr = int(session['to_pay_amount']) * 100
    except :
        pass
    
    session['f_r_p_project_id'] = project_id
    if logged_in_type == "ALUMNI" :
        session['f_r_p_user_id'] = session['alumni_login_id']
        session['f_r_p_user_type'] = "ALUMNI"
        
    if logged_in_type == "COLLEGE SPOC" :
        session['f_r_p_user_id'] = session['college_login_id']
        session['f_r_p_user_type'] = "COLLEGE SPOC"

        
    if logged_in_type == "ASSOCIATION" :
        session['f_r_p_user_id'] = session['association_login_id']
        session['f_r_p_user_type'] = "ASSOCIATION"

    session['f_r_p_order_id'] = order_id
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    percent_collected = (100 * int(project_details[0][9])) // int(project_details[0][8])
    
    gifts = []
    sql = "SELECT * FROM fund_raising_projects_payments WHERE project_id=%d AND payment_status='captured' AND payment_done='DONE' ORDER BY date_time DESC LIMIT 5" % (int(project_details[0][0]))
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        if i[2] == "ALUMNI" :
            sql = "SELECT first_name,last_name FROM students WHERE id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
                
        if i[2] == "COLLEGE SPOC" :
            sql = "SELECT first_name,last_name FROM colle_spoc WHERE spoc_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
            
            
        if i[2] == "ASSOCIATION" :
            sql = "SELECT first_name,last_name FROM association WHERE association_id=%d" % (int(i[3]))
            con.execute(sql)
            res2 = con.fetchall()
            
            image = "NO"
            try : 
                
                sql = "SELECT profile_image FROM association_basic_profile_details WHERE id=%d" % (int(i[3]))
                con.execute(sql)
                res3 = con.fetchall()
                image = res3[0][0]
            except :
                image = "NO"
            
        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
        random_bg_color = color[0]
        gifts.append([res2[0][0],res2[0][1],i[2],i[6],image,random_bg_color])
    # print(gifts)
    #
    bar_percent = (400 * int(project_details[0][9])) // int(project_details[0][8])
    
    amount_remaining_to_collect = int(project_details[0][8]) - int(project_details[0][9])
    
    con.close()
    
    return render_template("college_fundraising_projects_payment.html",project_details=project_details,project_docs=project_docs,isAllowedForCollege=isAllowedForCollege,isAllowedForAssociation=isAllowedForAssociation,isPersonDonate=isPersonDonate,my_college=my_college,d_e=d_e,d_m_n=d_m_n,amount_remaining_to_collect=amount_remaining_to_collect,order_id=order_id,pay_amt_inr=pay_amt_inr,pay_amt=pay_amt,logged_in_type=logged_in_type,percent_collected=percent_collected,gifts=gifts,l_gifts=len(gifts),bar_percent=bar_percent,isRejected=isRejected)


@app.route('/college/view/fund-raising-project/payment/callback', methods=['POST'])
def college_app_charge():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    amount = int(session['to_pay_amount']) * 100
    payment_id = request.form['razorpay_payment_id']
    
    razorpay_client.payment.capture(payment_id, amount)
    res = razorpay_client.payment.fetch(payment_id)
    isDetailsGot = 0
    isGeneratePDF = 0
    
    project_id = session['f_r_p_project_id']
    
    try :
        
        user_id = session['f_r_p_user_id']
        order_id = str(res["notes"]["shopping_order_id"])
        membership_type = session['f_r_p_user_type']
        payment_id = str(res["id"])
        payment_amount = int(res["amount"]) / 100
        payment_status = str(res["status"])
        payment_method = str(res["method"])
        payment_email = str(res["email"])
        payment_contact = str(res["contact"])
        payment_fee = int(res["fee"]) / 100
        if payment_status == "captured" :
            payment_done = "DONE"
            isGeneratePDF = 1
            
        elif payment_status == "authorized" :
            payment_done = "PENDING"
        else :
            payment_done = "ERROR"
        
        isDetailsGot = 1
    except :
        print("Error In Getting Payment Details.")
    main_sent = 0
    isInserted = 0
    if isDetailsGot == 1 :
        print(payment_id)
        print(order_id)
        print(project_id)
        print(membership_type)
        print("User Id : ",user_id)
        print(payment_amount)
        print(payment_status)
        print(payment_method)
        print(payment_email)
        print(payment_contact)
        print(payment_fee)
        print(isDetailsGot)
        print(payment_done)
        total_payment_done = payment_amount - payment_fee
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S") 
        try :
            sql = "INSERT INTO fund_raising_projects_payments(project_id,membership_type,user_id,payment_id,order_id,payment_amount,payment_fee,payment_method,payment_email,payment_contact,payment_status,payment_done,date_time) VALUES (%d,'%s',%d,'%s','%s',%f,%f,'%s','%s',%d,'%s','%s','%s')" % (int(project_id),str(membership_type),int(user_id),str(payment_id),str(order_id),float(payment_amount),float(payment_fee),str(payment_method),str(payment_email),int(payment_contact),str(payment_status),str(payment_done),d_t)
            print(sql)
            con.execute(sql)
            cnx.commit()
            
            sql = "UPDATE fund_raising_projects SET project_collected_amount=project_collected_amount+"+str(int(payment_amount))+" WHERE id="+str(project_id)
            
            con.execute(sql)
            cnx.commit()
            
            isInserted = 1         
        except :
            print("Error In Inserting In Fund Raising Project Payment Details.")
        
        if isInserted == 1 :
            sql = "SELECT * FROM fund_raising_projects WHERE id=%d" % (int(project_id))
            con.execute(sql)
            res = con.fetchall()
            project_title = res[0][4]
            if membership_type == "ALUMNI" : 
                sql = "SELECT * FROM students WHERE id=%d" % (int(session['alumni_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])
                
            if membership_type == "COLLEGE SPOC" :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][2]).capitalize()+" "+str(res[0][3]).capitalize()
                d_e = str(res[0][4])
                d_m_n = "+"+str(res[0][5])+str(res[0][6])
            
            if membership_type == "ASSOCIATION" :
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                name = str(res[0][1]).capitalize()+" "+str(res[0][2]).capitalize()
                d_e = str(res[0][3])
                d_m_n = "+"+str(res[0][4])+str(res[0][5])

            try :
                
                msg = Message('FUND RAISING PROJECT PAYMENT DETAILS', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [payment_email])
                    
                msg.html = '''
                                <!DOCTYPE html>
                                <html lang="en">
                                <head>
                                    <meta charset="UTF-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                    <title></title>
                                </head>
                                <body>
                                    <table class="nl-container" style="table-layout: fixed; vertical-align: top; min-width: 320px; margin: 0 
                                auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f5f5f5; width: 100%;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                        <tbody>
                                        <tr style="vertical-align: top;" valign="top">
                                            <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 5px 0px 5px 0px;">       
                                                                <table class="divider" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;" valign="top">
                                                                            <table class="divider_content" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" role="presentation" border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
                                                                                <tbody>
                                                                                    <tr style="vertical-align: top;" valign="top">
                                                                                        <td style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" height="10">&nbsp;</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid two-up no-stack" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">     
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #ffffff;">
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 0px 25px 25px;">    
                                                                <div class="img-container left fixedwidth" style="padding-right: 0px; padding-left: 0px;" align="left">
                                                                    <img class="left fixedwidth" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" alt="Image Logo" width="195" border="0" />
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                                            <div style="width: 100% !important;">
                                                                <div style="border: 0px solid transparent; padding: 25px 25px 25px 0px;">    
                                                                <div class="button-container" style="padding: 10px 0px 10px 10px;" align="right">
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div style="background-color: transparent;">
                                                    <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #d6e7f0;">
                                                    <div style="border-collapse: collapse; display: table; width: 100%; background-color: #d6e7f0;">
                                                        <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;background-color:white;padding:20px">
                                                        
                                                            <table bgcolor="#f9f9f9" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f9f9f9; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td style="word-break: break-word; vertical-align: top;" valign="top">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#f9f9f9"><![endif]-->
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 14px; line-height: 1.2; word-break: break-word; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 17px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Dear </span><span style="font-size: 17px; mso-ansi-font-size: 18px;"><b>'''+str(name)+'''</b> Your Payment For Fund Raising Project Is Successful.Thank You</span></span><span style="font-size: 17px; color: #000000; mso-ansi-font-size: 18px;"> For Making Gift To <b>'''+str(project_title)+'''</b> Project.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="font-size: 17px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 20px; mso-ansi-font-size: 18px; margin: 0;"><span style="font-size: 17px; mso-ansi-font-size: 18px;">Payment Details</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 10px; font-family: Arial, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:35px;">
                                                                <div style="line-height: 1.2; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #232323; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>PAYMENT ID : '''+str(payment_id)+'''</strong></span></span></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"></p>
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; mso-line-height-alt: 14px; margin: 0;"><span style="color: #000000;"><span style="font-size: 17px; mso-ansi-font-size: 18px;"><strong>ORDER ID : '''+str(order_id)+'''</strong></span></span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid three-up" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;">Total Amount Paid</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:0px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;"> '''+str(payment_amount)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Fee</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(payment_fee)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="183" style="background-color:#ffffff;width:183px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num4" style="max-width: 320px; min-width: 183px; display: table-cell; vertical-align: top; width: 183px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 18px;">Payment Received</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <div style="line-height: 1.2; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 14px;">
                                                                <p style="line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 14px; margin: 0;"><strong><span style="font-size: 15px;"> '''+str(total_payment_done)+'''</span></strong></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:transparent;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:0px; padding-bottom:0px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:0px; padding-bottom:0px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <div align="center" class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]--><img align="center" alt="Alternate text" border="0" class="center autowidth" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-nwcbjisnnyl/round_corners_2.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 550px; display: block;" title="Alternate text" width="550"/>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Email</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_email)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">Mobile No.</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td><td align="center" width="275" style="background-color:#ffffff;width:275px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num6" style="max-width: 320px; min-width: 275px; display: table-cell; vertical-align: top; width: 275px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 35px; padding-top: 10px; padding-bottom: 0px; font-family: Tahoma, sans-serif"><![endif]-->
                                                                <div style="color:#232323;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;line-height:1.5;padding-top:10px;padding-right:25px;padding-bottom:0px;padding-left:35px;">
                                                                <div style="line-height: 1.5; font-size: 12px; color: #232323; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; word-break: break-word; text-align: left; mso-line-height-alt: 21px; margin: 0;"><span style="font-size: 14px;">'''+str(payment_contact)+'''</span></p>
                                                                </div>
                                                                </div>
                                                                <!--[if mso]></td></tr></table><![endif]-->
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <div style="background-color:transparent;">
                                                                <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 550px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #ffffff;">
                                                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#ffffff;">
                                                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:550px"><tr class="layout-full-width" style="background-color:#ffffff"><![endif]-->
                                                                <!--[if (mso)|(IE)]><td align="center" width="550" style="background-color:#ffffff;width:550px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                                                <div class="col num12" style="min-width: 320px; max-width: 550px; display: table-cell; vertical-align: top; width: 550px;">
                                                                <div style="width:100% !important;">
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                                <!--<![endif]-->
                                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="0" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 0px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                <td height="0" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                                <div align="center" class="button-container" style="padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="" style="height:31.5pt; width:116.25pt; v-text-anchor:middle;" arcsize="10%" stroke="false" fillcolor="#ea5256"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, sans-serif; font-size:16px"><![endif]-->
                                                                <a href="'''+str(app_base_url)+'''fund_raising_project/receipt/'''+str(payment_id)+'''/'''+str(order_id)+'''"><div style="text-decoration:none;display:inline-block;color:#ffffff;background-color:#ea5256;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;width:auto; width:auto;;border-top:1px solid #ea5256;border-right:1px solid #ea5256;border-bottom:1px solid #ea5256;border-left:1px solid #ea5256;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;text-align:center;mso-border-alt:none;word-break:keep-all;"><span style="padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;">VIEW NOW</span></span></div></a>
                                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                                </div>
                                                                <!--[if (!mso)&(!IE)]><!-->
                                                                </div>
                                                                <!--<![endif]-->
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                                                </div>
                                                                </div>
                                                                </div>
                                                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                                                </td>
                                                                </tr>
                                                                </tbody>
                                                                </table>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        <div style="background-color: transparent;">
                                            <div class="block-grid" style="margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                            <div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;">
                                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                                    <div style="width: 100% !important;">
                                                        <div style="border: 0px solid transparent; padding: 20px 0px 60px 0px;">
                                                        <table class="social_icons" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" role="presentation" width="100%" cellspacing="0" cellpadding="0">
                                                            <tbody>
                                                                <tr style="vertical-align: top;" valign="top">
                                                                    <td style="word-break: break-word; vertical-align: top; padding: 10px;" valign="top">
                                                                    <table class="social_table" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" role="presentation" cellspacing="0" cellpadding="0" align="center">
                                                                        <tbody>
                                                                            <tr style="vertical-align: top; display: inline-block; text-align: center;" align="center" valign="top">
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://www.facebook.com/darshpatelofficial" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" alt="Facebook" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://twitter.com/pateldarsh10" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" alt="Twitter" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="https://instagram.com/pateldarsh_007" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" alt="Instagram" width="32" height="32" /></a></td>
                                                                                <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top"><a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank" rel="noopener"><img style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" alt="E-Mail" width="32" height="32" /></a></td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <div style="color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; line-height: 1.5; padding: 10px;">
                                                            <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                                <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;">&copy; 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                                </table>
                                </body>
                                </html>                                   
                    '''
                try :
                    mail.send(msg)
                    mail_sent = 1
                except :
                    print("Error In Sending Mail.")

                if mail_sent == 1 :
                    
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '/college/view/fund-raising-project/"+str(project_id)+"';</script>"; 
                else :
                    flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                    return "<script>window.location = '/college/view/fund-raising-project/"+str(project_id)+"';</script>"; 
                
            except :
                print("Error In Sending payment F_R_P Details To email.")
                flash(Markup("<p style='font-size:15px;color:green;'>Payment Made Successfully.</p>"))
                return "<script>window.location = '/college/view/fund-raising-project/"+str(project_id)+"';</script>"; 
        
        else :
            flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Payment Details.</p>"))
            return "<script>window.location = '/college/view/fund-raising-project/"+str(project_id)+"';</script>"; 
           
    else :
        return "<script>window.location = '/college/view/fund-raising-project/"+str(project_id)+"';</script>"; 
    
    # res2 = json.dumps(res,indent=4)
    # con.close()
    # return res2


@app.route('/college/create-event',methods=['GET','POST'])
def college_create_event():
   
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if request.method == 'POST' : 
        sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        res = con.fetchall()
        account_details = res[0]
        # print(account_details)
        association_id = account_details[0]
        
        event_name = request.form['event-name']
        event_venue = request.form['event-venue']
        event_description = request.form['eventdescription']
        tickets_available = int(request.form['tickets-available'])
        ticket_price = int(request.form['ticket-price'])
        event_start_date_time = request.form['event-start-date-time']
        event_end_date_time = request.form['event-end-date-time']
        
        if len(event_description) == 0 :
            flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Event Description. </p>"))
            return redirect(url_for('college_create_event'))
        
        try :    
            send_not_colleges = request.form.getlist('send_not_colleges')[0]
            if send_not_colleges == "on" :
                send_not_colleges = "YES"
            else :
                send_not_colleges = "NO"
        except :
            send_not_colleges = "NO"
            
        try :
            send_not_alumni = request.form.getlist('send_not_alumni')[0]
            if send_not_alumni == "on" :
                send_not_alumni = "YES"
            else :
                send_not_alumni = "NO"
        except :
            send_not_alumni = "NO"
         
         
        try :
            allow_other_college_alumni = request.form.getlist('allow_other_college_alumni')[0]
            if allow_other_college_alumni == "on" :
                allow_other_college_alumni = "YES"
            else :
                allow_other_college_alumni = "NO"
        except :
            allow_other_college_alumni = "NO"
               
        now = datetime.now()
        time = now.strftime("%Y-%m-%d %H:%M:%S")
            
        session['c_event_name'] = request.form['event-name']
        session['c_event_venue'] = request.form['event-venue']
        session['c_tickets-available'] = request.form['tickets-available']
        session['c_ticket-price'] = request.form['ticket-price']
        session['c_event-start-date-time'] = request.form['event-start-date-time']
        session['c_event-end-date-time'] = request.form['event-end-date-time']
        session['c_event_description'] = request.form['eventdescription']
        session['s_not_colleges'] = send_not_colleges
        session['s_not_alumni'] = send_not_alumni
        session['allow_other_college_alumni'] = allow_other_college_alumni
            
            
        c_dirName = "static/uploads/events/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
        isPosterSaved = 0
        try :
            
            file = request.files['event-file']
            if file.filename == "" :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Select Event Poster / Image. </p>"))
                return redirect(url_for('college_create_event'))
            else :
           
            # p = path+secure_filename(file.filename)
                event_logo = "static/uploads/events/"+str(association_id)+"_"+str(uuid.uuid1())+file.filename
                file.save(event_logo)
                isPosterSaved = 1
            
        except :
            print("Error FIle Upload.")
        
        if isPosterSaved == 0 :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Saving Event Poster / Image. </p>"))
            return redirect(url_for('college_create_event'))
        
        dt1 = event_start_date_time
        dt2 = event_end_date_time
        dt3 = datetime.now().replace(microsecond=0,second=0,hour=0,minute=0)
        
        print(dt1)
        print(type(dt1))
        
        new_dt1 = datetime(int(dt1[:4]),int(dt1[5:7]),int(dt1[8:10]))
        print(new_dt1)
        print(type(new_dt1))
        
        print(type(dt3))
        print(dt3)
        if dt1 <= dt2 :
            print("outer valid")
            if dt3 <  new_dt1 :
                print("dt3 : ",dt3)
            
                try :
                    sql = "INSERT INTO college_events(spoc_id,event_name,event_logo,event_description,event_venue,start_date_time,end_date_time,event_fee,event_tickets_to_sell,isBookingAllowed,isActive,send_notification_to_colleges,send_notification_to_alumni,allow_other_college_alumni,time) VALUES (%d,'%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s','%s','%s','%s')" % (int(session['college_login_id']),str(event_name),event_logo,str(event_description),str(event_venue).replace("'",""),str(event_start_date_time),str(event_end_date_time),int(ticket_price),int(tickets_available),"YES","YES",send_not_colleges,send_not_alumni,allow_other_college_alumni,time)
                    
                    # sql = "INSERT INTO association_events(association_id,event_name,event_logo,event_description,event_venue,start_date_time,end_date_time,event_fee,event_tickets_to_sell,isBookingAllowed,isActive,last_modified_by,last_modified_time,send_notification_to_other_association_members,send_notification_to_colleges,send_notification_to_alumni,time) VALUES(%d,'%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s','%s','%s','%s','%s','%s')" % (int(association_id),str(event_name),event_logo,str(event_description),str(event_venue).replace("'",""),str(event_start_date_time),str(event_end_date_time),int(ticket_price),int(tickets_available),"YES","YES",association_id,time,send_not_association,send_not_colleges,send_not_alumni,time)
            
                    con.execute(sql)
                    cnx.commit()
                    
                    
                    # c_e_cron_table_name = "college_event_"+str(uuid.uuid1()).replace("-","")
                    # sql = "CREATE TABLE "+str(c_e_cron_table_name)+" (id INT(20) UNSIGNED AUTO_INCREMENT PRIMARY KEY,membership_type VARCHAR(30) NOT NULL,email VARCHAR(200) NOT NULL,isEmailSent VARCHAR(10) NOT NULL,date_time TIMESTAMP)"
                    # con.execute(sql)
                    # cnx.commit()
                    
                    
                    
                    flash(Markup("<p style='color:green;font-size:15px;'>Event Created Successfully.</p>"))
                    
                    session['c_event_name'] = ""
                    session['c_event_venue'] = ""
                    session['c_tickets-available'] = ""
                    session['c_ticket-price'] = ""
                    session['c_event-start-date-time'] = ""
                    session['c_event-end-date-time'] = ""
                    session['c_event_description'] = ""
                    session['s_not_association'] = ""
                    session['s_not_colleges'] = ""
                    session['s_not_alumni'] = ""
                    session['allow_other_college_alumni'] = ""
                    
                except :
                    flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting Event Record In Database.</p>"))
                    # print("ERrror INsert.")
                print("e_desc : ",event_description)
                print("send_not_colleges : ",send_not_colleges)
                print("send_not_alumni : ",send_not_alumni)
                
                
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Valid Start Date.</p>"))
                return redirect(url_for('college_create_event'))
        else :
            flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Valid Event Start & End Date-TIme.</p>"))
            return redirect(url_for('college_create_event'))
        
        

          
        
    
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
      
    sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
    con.execute(sql)
    res = con.fetchall()
    account_details = res[0]
    
    con.close()
    return render_template("college_create_event.html",account_details=account_details)
    


@app.route('/college/profile/',methods=['GET','POST'])
def college_profile():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
                    
   
               
       
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
                
        
    main_profile_details = []
    basic_profile_details = []
    
    try :
        sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("College : Error In Getting Main Profile Details.")
        pass
    
    try :
        sql = "SELECT * FROM college_basic_profile_details WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("College : Error In Getting Basic Profile Details.")
        pass
    
    # print(basic_profile_details)
    
    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
    random_bg_color = color[0]
    # print(random_bg_color)
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("college : No Expertise or Error In Getting Expertise")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
            
            
    profile_blog_posts = []
    try :
        sql = "SELECT * FROM blog_post_college WHERE spoc_id=%d ORDER BY date_time" % (int(session['college_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    t.append(soup.get_text())
                else :
                    t.append(res[i][j])
                    
            profile_blog_posts.append(t)
            
    except :
        print("college : Error In Getting Profile Blog Post Details.")
    
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM college_education_details WHERE spoc_id=%d ORDER BY id DESC" % (int(session['college_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("college : Error In Getting Education Details Of Profile")
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM college_work_details WHERE spoc_id=%d ORDER BY id DESC" % (int(session['college_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("college : Error In Getting Education Details Of Profile")
    try :
        profile_pic = basic_profile_details[0][9]
        l_profile_pic = len(profile_pic)
    except :
        profile_pic = ""
        l_profile_pic = len(profile_pic)
    
    profile_network_details = []
    try :
        sql = "SELECT * FROM network WHERE from_id=%d AND from_type='COLLEGE SPOC' ORDER BY date_time DESC" % (int(session['college_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            user_id = int(i[4])
            if i[3] == "ASSOCIATION MEMBER" :
                try :
                    sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("College : Error In Getting Network Profile Details.")
                        
            if i[3] == "COLLEGE SPOC" :
                try :
                    sql = "SELECT college_spoc.first_name,college_spoc.last_name,college_basic_profile_details.profile_image FROM college_spoc,college_basic_profile_details WHERE college_spoc.spoc_id=%d AND college_basic_profile_details.spoc_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["College SPOC",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["College SPOC",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("College : Error In Getting Network Profile Details.")
                        
    except :
        print("College : Error In Getting Education Details Of Profile")
        
    print(profile_network_details)
    
    return render_template("college_profile.html",main_profile_details=main_profile_details,random_bg_color=random_bg_color,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises),profile_blog_posts=profile_blog_posts,l_profile_blog_posts=len(profile_blog_posts),profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details),profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),profile_pic=profile_pic,l_profile_pic=l_profile_pic,profile_network_details=profile_network_details,l_profile_network_details=len(profile_network_details))



@app.route('/college/profile/edit/<int:section_id>',methods=['GET','POST'])
def college_edit_profile(section_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
       
    if request.method == "POST" :
        mode = int(request.form['mode'])
        
        if mode == 2 :
            f_name = str(request.form['profile_first_name']).strip()
            l_name = str(request.form['profile_last_name']).strip()
            email = str(request.form['profile_email']).strip()
            mobile_no = str(request.form['profile_mobile_no']).strip()
            address = str(request.form['profile_main_address'])
            summary = str(request.form['profile_main_summary']).strip()
            expertise = str(request.form['post_tag_value'])[1:]
            
            if len(f_name) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter First Name.</p>"))
                return
            
            if len(l_name) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Last Name.</p>"))
                return
            
            if len(email) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Email Address.</p>"))
                return
            
            if len(mobile_no) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Mobile Number.</p>"))
                return
                        
            
            print("Ex : ",expertise)
            
            isNameUpdated = 0
            isAddressUpdated = 0
            isEmailRequestUpdated = 0
            isEmailSent = 0
            email_sent = 0
            isEmailUpdated = 0
            resx = 0
            resy = 0
            isMobileUpdated = 0
            sms_sent = 0
            try :
                sql = "UPDATE college_spoc SET first_name='%s',last_name='%s' WHERE spoc_id=%d" % (f_name,l_name,int(session['college_login_id']))
                con.execute(sql)
                cnx.commit()
                isNameUpdated = 1
            except :
                print("College : Error In Updating f_name & l_name.")
            
            if isNameUpdated == 1 :
                try :
                    sql = "SELECT * FROM college_basic_profile_details WHERE spoc_id=%d" % (int(session['college_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    if len(res) == 0 :
                        sql = "INSERT INTO college_basic_profile_details(spoc_id,address,summary,expertise) VALUES(%d,'%s','%s','%s')" % (int(session['college_login_id']),str(address),str(summary),str(expertise))
                        con.execute(sql)
                        cnx.commit()
                        isAddressUpdated = 1
                    else :
                        sql = "UPDATE college_basic_profile_details SET address='%s',summary='%s',expertise='%s' WHERE spoc_id=%d" % (str(address),str(summary),str(expertise),int(session['college_login_id']))
                        con.execute(sql)
                        cnx.commit()
                        isAddressUpdated = 1
                except :
                    print("college : Error In Updating Address.")
                    
            if isAddressUpdated == 1 :
                try :
                    sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    old_email = str(res[0][4])
                        
                    if old_email != email :
                        verification_code = str(uuid.uuid1())
                            
                        try :
                            sql = "SELECT * FROM college_spoc WHERE email='%s' AND isEmailVerified='YES' AND isSpocVerified='YES'" % (email)
                            con.execute(sql)
                            res = con.fetchall()
                            resx = len(res)
                        except :
                            print("college_spoc : Profile Email Compare Error.")
                            
                        if resx == 0 :
                            try :
                                sql = "UPDATE college_basic_profile_details,college_spoc SET college_basic_profile_details.isEmailUpdateRequested='YES',college_spoc.verification_code='%s' WHERE college_basic_profile_details.spoc_id=%d AND college_spoc.spoc_id=%d" % (str(verification_code),int(session['college_login_id']),int(session['college_login_id']))
                                con.execute(sql)
                                cnx.commit()
                                isEmailRequestUpdated = 1
                            except :
                                print("Association : Error In Updating isEmailUpdateRequested")
                                
                            url_part_1 = "college/update/"+str(session['college_login_id'])+"/"+str(verification_code)+"/"+str(email)
                        
                            if isEmailRequestUpdated == 1 :
                                msg = Message('Alumni Association Of Goa : College SPOC Email Update', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
                                msg.html = '''
                                                                <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

    <head>
        <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta content="width=device-width" name="viewport" />
        <!--[if !mso]><!-->
        <meta content="IE=edge" http-equiv="X-UA-Compatible" />
        <!--<![endif]-->
        <title></title>
        <!--[if !mso]><!-->
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
        <!--<![endif]-->
        <style type="text/css">
            body {
                margin: 0;
                padding: 0;
            }
            
            table,
            td,
            tr {
                vertical-align: top;
                border-collapse: collapse;
            }
            
            * {
                line-height: inherit;
            }
            
            a[x-apple-data-detectors=true] {
                color: inherit !important;
                text-decoration: none !important;
            }
        </style>
        <style id="media-query" type="text/css">
            @media (max-width: 670px) {
                .block-grid,
                .col {
                    min-width: 320px !important;
                    max-width: 100% !important;
                    display: block !important;
                }
                .block-grid {
                    width: 100% !important;
                }
                .col {
                    width: 100% !important;
                }
                .col>div {
                    margin: 0 auto;
                }
                img.fullwidth,
                img.fullwidthOnMobile {
                    max-width: 100% !important;
                }
                .no-stack .col {
                    min-width: 0 !important;
                    display: table-cell !important;
                }
                .no-stack.two-up .col {
                    width: 50% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num8 {
                    width: 66% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num3 {
                    width: 25% !important;
                }
                .no-stack .col.num6 {
                    width: 50% !important;
                }
                .no-stack .col.num9 {
                    width: 75% !important;
                }
                .video-block {
                    max-width: none !important;
                }
                .mobile_hide {
                    min-height: 0px;
                    max-height: 0px;
                    max-width: 0px;
                    display: none;
                    overflow: hidden;
                    font-size: 0px;
                }
                .desktop_hide {
                    display: block !important;
                    max-height: none !important;
                }
            }
        </style>
    </head>

    <body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
        <!--[if IE]><div class="ie-browser"><![endif]-->
        <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
            <tbody>
                <tr style="vertical-align: top;" valign="top">
                    <td style="word-break: break-word; vertical-align: top;" valign="top">
                        <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                                
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                    <div style="font-size:1px;line-height:45px"></div>
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                    <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                        <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;">Dear <span style="font-size: 18px; color: #000000;"><b>'''+str(f_name).capitalize()+''' '''+str(l_name).capitalize()+'''</b></strong></span>, We Received Request For Email Change From Your Account.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CHANGE MY EMAIL</strong></span></span></a>
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                    <tbody>
                                                                        <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                        <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
        <!--[if (IE)]></div><![endif]-->
    </body>

    </html>
                    '''
                                try :
                                    mail.send(msg)
                                    isEmailSent = 1
                                    email_sent = 1
                                except :
                                    isEmailSent = 1
                                    print("college : Error In Sending Mail.")
                            else :
                                print("college : Error In Updating Status Of Email Change To Yes.")
                        
                        else :
                            flash(Markup("<p style='font-size:15px;color:red;'>This Email Is Already Registed With Us.</p>"))
                            
                        if email_sent == 1 and isEmailSent == 1 :
                            flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated Successfully.\nPlease Verify Your New Email Address.</p>"))
                        if email_sent == 0 and isEmailSent == 1 :
                            flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated But Unable To Send Email To  New Email Address.</p>"))        
                                        
                    else :
                        flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated Successfully.</p>"))
                            
            
                except :
                    print("Error In Updating Email.")
            
            
            
            try :
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                old_mobile_no = int(res[0][6])
                country_code = str(res[0][5])       
                mobile_no = int(mobile_no)
                otp = random.randrange(111111,999999)                       
                if old_mobile_no != mobile_no :
                    try :
                        sql = "SELECT * FROM college_spoc WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND isSpocVerified='YES'" % (int(country_code),int(mobile_no))
                        con.execute(sql)
                        res = con.fetchall()
                        resy = 1
                        resy = len(res)
                    except :
                        print("Association : Error In Comparing Mobile No. In Association Profile")
                        pass
                    
                    if resy == 0 :
                        try :
                            sql = "UPDATE college_basic_profile_details SET isMobileUpdateRequested='YES' WHERE spoc_id=%d" % (int(session['college_login_id']))
                            con.execute(sql)
                            cnx.commit()
                            print("Update Status Of isMobileUpdateRequested To YES.")
                        except :
                            print("college : Error In Updating 	isMobileUpdateRequested In Association Profile")
                        pass
                        
                        headers = {
                                                        'Content-Type': 'application/json',
                                                        'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
                                                    }
                                                
                        msg = 'Dear '+str(f_name)+' '+str(l_name)+',\\nWe Received Your Request For Change Of Mobile Number For College SPOC Account. Use '+str(otp)+' As OTP To Change Mobile Number.'

                        data = '{"message": "'+msg+'","binary": false,  "destinations": ["+'+str(country_code)+str(mobile_no)+'"]}'

                        response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                        res = json.loads(response.text)
                        print(res)
                        try :
                            if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                                sms_sent = 1
                                                            # return jsonify(res=1)
                            else :
                                sms_sent = 0
                        except :
                            sms_sent = 0
                            
                        if sms_sent == 1 :
                            try :
                                sql = "UPDATE college_spoc SET otp=%d WHERE spoc_id=%d" % (int(otp),int(session['college_login_id']))
                                con.execute(sql)
                                cnx.commit()
                                session['college_profile_country_code'] = country_code
                                session['college_profile_mobile_no'] = mobile_no
                                session['college_profile_otp'] = otp
                                return redirect(url_for('college_profile_update_mobile'))
                            except :
                                print("Error In Updating OTP.")
                    
                    else :
                        flash(Markup("<p style='font-size:15px;color:red;'>This Mobile No. Is Already Registed With Us.</p>"))
                        print("Mobile No. Already Registered WIth Us.")
                        
            except :
                print("college : Profile Error Getting Mobile No.")
                # flash("<p style='color:green;font-size:15px;'>Profile Updated Successfully. Please Verify Your New Email.</p>")
                
        if mode == 3 :
            profile_current_location = str(request.form['profile_current_location']).strip()
            profile_hometown = str(request.form['profile_hometown'])
            profile_gender = str(request.form['profile_gender'])
            profile_dob = request.form['profile_dob']
            
            
            print(profile_current_location)
            print(profile_hometown)
            print(profile_gender)
            print(profile_dob)
            
            
            profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            profile_dob = profile_dob.strftime("%Y-%m-%d")
            print(profile_dob)
            isProfileContactInfoUpdated = 0
            try :
                sql = "SELECT * FROM college_basic_profile_details WHERE spoc_id=%d" % (int(session['college_login_id']))
                con.execute(sql)
                res = con.fetchall()
                if len(res) == 0 :
                    sql = "INSERT INTO college_basic_profile_details(spoc_id,hometown,current_location,date_of_birth,gender) VALUES(%d,'%s','%s','%s','%s')" % (int(session['college_login_id']),profile_hometown,profile_current_location,profile_dob,profile_gender)
                    con.execute(sql)
                    cnx.commit()
                    isProfileContactInfoUpdated = 1
                else :
                    sql = "UPDATE college_basic_profile_details SET hometown='%s',current_location='%s',date_of_birth='%s',gender='%s' WHERE spoc_id=%d" % (profile_hometown,profile_current_location,profile_dob,profile_gender,int(session['college_login_id']))
                    con.execute(sql)
                    cnx.commit()
                    isProfileContactInfoUpdated = 1
            except :
                print("Association : Error In Updating Basic Information Of Profile.")
                
            
            if isProfileContactInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Profile Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Basic Information.</p>"))  
                
        
        if mode == 4 :
            institute_name = str(request.form['institute_name']).strip()
            starting_year = request.form['starting_year']
            graduation_year = request.form['graduation_year']
            degree = str(request.form['degree']).strip()
            department = str(request.form['department']).strip()
            
            
            print(institute_name)
            print(starting_year)
            print(graduation_year)
            print(degree)
            print(department)
            
            
            if starting_year > graduation_year :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Graduation Year.</p>"))
                print("Association : Profile Graducation : Please Enter Valid Graduation Year.")
                return redirect("../../../college/profile/edit/3")
                
            
            
            # profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            # profile_dob = profile_dob.strftime("%Y-%m-%d")
            # print(profile_dob)
            isProfileEducationInfoUpdated = 0
            try :
                sql = "INSERT INTO college_education_details(spoc_id,name_of_institute,start_year,graduation_year,degree,department) VALUES(%d,'%s',%d,%d,'%s','%s')" % (int(session['college_login_id']),institute_name,int(starting_year),int(graduation_year),str(degree),str(department))
                con.execute(sql)
                cnx.commit()
                isProfileEducationInfoUpdated= 1
                
            except :
                print("Association : Error In Inserting Education Information Of Profile.")
                
            
            if isProfileEducationInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Education Details Added Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding Education Information.</p>"))  
                
         
        if mode == 5 :
            work_title = str(request.form['work_title']).strip()
            company_name = str(request.form['company_name'])
            work_industry = str(request.form['work_industry'])
            from_month = request.form['from_month']
            from_year = request.form['from_year']
            to_month = request.form['to_month']
            to_year = request.form['to_year']
            try :
                isWorking = request.form.getlist('isWorking')[0]
                if isWorking == "on" :
                    isWorking = "YES"
                else :
                    isWorking = "NO"
            except :
                isWorking = "NO"
                
            achievement = str(request.form['achievement']).strip()
            
            
            
            # print(isWorking)
            
            
            isProfileWorkInfoUpdated = 0
            try :
                sql = "INSERT INTO college_work_details(spoc_id,work_title,company_name,work_industry,from_month,from_year,isWorkingNow,to_year,to_month,achievement) VALUES(%d,'%s','%s','%s','%s',%d,'%s',%d,'%s','%s')" % (int(session['college_login_id']),str(work_title),str(company_name),str(work_industry),str(from_month),int(from_year),isWorking,int(to_year),str(to_month),str(achievement))
                con.execute(sql)
                cnx.commit()
                isProfileWorkInfoUpdated = 1
                
            except :
                print("Association : Error In Inserting Work Information Of Profile.")
                
            
            if isProfileWorkInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Work Details Added Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding Work Information.</p>"))  
               
                      
        
       
    if 'college_login_id' not in session :
        return redirect(url_for('college_login'))
                
        
    main_profile_details = []
    
    try :
        sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("college : Error In Getting Main Profile Details.")
        pass
    
    basic_profile_details = []
    try :
        sql = "SELECT * FROM college_basic_profile_details WHERE spoc_id=%d" % (int(session['college_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("college : Error In Getting Basic Profile Details.")
        pass
    
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("Error In Tag")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
    
    # print(expertises)
    # print(main_profile_details)
    if section_id == 1 :
        return render_template("college_profile_contact_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises))
    if section_id == 2 :
       
        return render_template("college_profile_basic_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details))
    if section_id == 3 :
        sql = "SELECT * FROM colleges"
        con.execute(sql)
        college_list = con.fetchall()
        
        college_degree_list = []
        
        sql = "SELECT * FROM college_degrees"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            if i[2] not in college_degree_list :
                college_degree_list.append(i[2])
            else :
                pass
        
        return render_template("college_profile_education_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),college_degree_list=college_degree_list,college_list=college_list)
    if section_id == 4 :
        month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"]
        year_list = []
        
        for i in range(1960,2021):
            # print(i)
            year_list.append(int(i))
            
        
        return render_template("college_profile_work_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),month_list=month_list,year_list=year_list)

@app.route('/get_xls')
def get_xls():
  cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
  con = cnx.cursor()
  sql = "SELECT * FROM colleges"
  con.execute(sql)
  res = con.fetchall()
  college_l = []
  k = 0
  for i in res :
      college_l.append([str(i[1])])
      
      college_id = int(i[0])
      sql = "SELECT * FROM college_degrees WHERE college_id=%d" % (college_id)
      con.execute(sql)
      res2 = con.fetchall()
      for j in res2 :
          college_l[k].append(j[2])
          
      
      
      print("\n")
      print(k+1,college_l[k])
      k += 1
      print("\n")
#   print(college_l)
  return "read"
  
@app.route("/college/update/<int:spoc_id>/<verification_code>/<new_email>")
def college_change_email(spoc_id,verification_code,new_email):
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * FROM college_spoc,college_basic_profile_details WHERE college_spoc.spoc_id=%d AND college_spoc.verification_code='%s' AND college_basic_profile_details.isEmailUpdateRequested='YES'" % (int(spoc_id),str(verification_code))
        con.execute(sql)
        res = con.fetchall()
        print(res)
        if len(res) == 1 :
            try :
                sql = "UPDATE college_spoc,college_basic_profile_details SET college_spoc.email='%s',college_spoc.verification_code='',college_basic_profile_details.isEmailUpdateRequested='NO' WHERE college_spoc.spoc_id=%d AND college_basic_profile_details.spoc_id=%d" % (str(new_email),int(spoc_id),int(spoc_id))
                print(sql)
                con.execute(sql)
                cnx.commit()
                flash(Markup("<p style='color:green;font-size:15px;'>Email Is Changed Successfully.</p>"))  
                return redirect(url_for('college_logout'))
            except :
                print("college : Error In Updating Email Change")
                
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Email Change.</p>"))  
                return "Error In Email Update"
        else :
            return "Error"

    except :
        return "Error"
        print("college : Error : Email Change Not Found / Lost.")
    con.close()

@app.route('/college/profile/edit/education/<int:id>',methods=['GET','POST'])
def college_profile_edit_education_profile(id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 4 :
            institute_name = str(request.form['institute_name']).strip()
            starting_year = request.form['starting_year']
            graduation_year = request.form['graduation_year']
            degree = str(request.form['degree']).strip()
            department = str(request.form['department']).strip()
                        
            
            if starting_year > graduation_year :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Starting Year & Graduation Year.</p>"))
                print("Association : Profile Graducation : Please Enter Valid Graduation Year.")
                return redirect("../../../../college/profile/edit/education/"+str(id))
                
            
            
            # profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            # profile_dob = profile_dob.strftime("%Y-%m-%d")
            # print(profile_dob)
            isProfileEducationInfoUpdated = 0
            try :
                sql = "UPDATE college_education_details SET name_of_institute='%s',start_year=%d,graduation_year=%d,degree='%s',department='%s' WHERE spoc_id=%d AND id=%d" % (institute_name,int(starting_year),int(graduation_year),str(degree),str(department),int(session['college_login_id']),int(id))
                con.execute(sql)
                cnx.commit()
                isProfileEducationInfoUpdated= 1
                
            except :
                print("college : Error In UpdatingEducation Information Of Profile.")
                
            
            if isProfileEducationInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Education Details Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Education Information.</p>"))  
           
        if mode == 2 :
            edu_id = int(request.form['id'])
            
            try :
                sql = "DELETE FROM college_education_details WHERE id=%d AND spoc_id=%d" % (int(edu_id),int(session['college_login_id']))
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Education Details Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Education.")
        
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM college_education_details WHERE id=%d AND spoc_id=%d" % (id,int(session['college_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("college : Error In Getting Education Details To Edit Profile.")
    con.close()
    
    if len(profile_education_details) == 0 :
        return redirect(url_for('college_profile'))
    
    return render_template('college_profile_education_edit.html',profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details))
    
    
@app.route('/college/profile/edit/work/<int:id>',methods=['GET','POST'])
def college_profile_edit_work_profile(id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 5 :
            work_title = str(request.form['work_title']).strip()
            company_name = str(request.form['company_name'])
            work_industry = str(request.form['work_industry'])
            from_month = request.form['from_month']
            from_year = request.form['from_year']
            to_month = request.form['to_month']
            to_year = request.form['to_year']
            try :
                isWorking = request.form.getlist('isWorking')[0]
                if isWorking == "on" :
                    isWorking = "YES"
                else :
                    isWorking = "NO"
            except :
                isWorking = "NO"
                
            achievement = str(request.form['achievement']).strip()
            
            isProfileWorkInfoUpdated = 0
            try :
                sql = "UPDATE college_work_details SET work_title='%s',company_name='%s',work_industry='%s',from_month='%s',from_year=%d,isWorkingNow='%s',to_year=%d,to_month='%s',achievement='%s' WHERE id=%d AND spoc_id=%d" % (str(work_title),company_name,work_industry,str(from_month),int(from_year),isWorking,int(to_year),str(to_month),achievement,int(id),int(session['college_login_id']))
                con.execute(sql)
                cnx.commit()
                isProfileWorkInfoUpdated = 1
                
            except :
                print("College : Error In Updating Work Information Of Profile.")
                
            
            if isProfileWorkInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Work Details Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Work Information.</p>"))  
           
        if mode == 2 :
            work_id = int(request.form['id'])
            
            try :
                sql = "DELETE FROM college_work_details WHERE id=%d AND spoc_id=%d" % (int(work_id),int(session['college_login_id']))
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Work Details Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Work Details.")
        
    
    profile_work_details = []
    try :
        sql = "SELECT * FROM college_work_details WHERE id=%d AND spoc_id=%d" % (id,int(session['college_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("college : Error In Getting Work Details To Edit Profile.")
    con.close()
    
    if len(profile_work_details) == 0 :
        return redirect(url_for('college_profile'))
    
    month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"]
    year_list = []
        
    for i in range(1960,2021):
            # print(i)
        year_list.append(int(i))
        
        
    return render_template('college_profile_work_edit.html',profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),month_list=month_list,year_list=year_list)
    
    
@app.route("/college/profile/update/mobile/",methods=['GET','POST'])
def college_profile_update_mobile():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "GET" :
        mode = request.args.get('mode')
        if mode == "1" :
            r_otp = request.args.get('otp')
            x = 0
            y = 0
            try :
                # association_basic_profile_details
                # isMobileUpdateRequested
                sql = "SELECT * FROM college_spoc,college_basic_profile_details WHERE college_spoc.spoc_id=%d AND college_basic_profile_details.spoc_id=%d AND college_basic_profile_details.isMobileUpdateRequested='YES' AND college_spoc.otp=%d" % (int(session['college_login_id']),int(session['college_login_id']),int(r_otp))
                con.execute(sql)
                res = con.fetchall()
                x = len(res)
            except :
                print("college : Profile Error In Comparing OTP.")
                
            if x == 1 :
                try :
                    # association_basic_profile_details
                    # isMobileUpdateRequested
                    sql = "UPDATE college_spoc,college_basic_profile_details SET college_spoc.mobile_number=%d,college_basic_profile_details.isMobileUpdateRequested='NO',college_spoc.otp=0 WHERE college_spoc.spoc_id=%d AND college_basic_profile_details.spoc_id=%d" % (int(session['college_profile_mobile_no']),int(session['college_login_id']),int(session['college_login_id']))
                    con.execute(sql)
                    cnx.commit()
                    y = 1
                except :
                    print("college : Profile Error In Comparing OTP.")
            else :
                return jsonify(res=0,msg="Invalid OTP.")
            
            if y == 1 :
                session['college_profile_country_code'] = ""
                session['college_profile_mobile_no'] = ""
                return jsonify(res=1,msg="Mobile No. Updated Successfully.")
            else :
                return jsonify(res=0,msg="Unable To Update, Please Try Again.")

        if mode == "2" :
            country_code = session['college_profile_country_code']
            mobile_no =  session['college_profile_mobile_no']
            otp = session['college_profile_otp']
            sms_sent = 0
            headers = {
                                                        'Content-Type': 'application/json',
                                                        'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
                                                    }
                                                
            msg = 'Hey ! We Received Your Request For Change Of Mobile Number For College SPOC Account. Use '+str(otp)+' As OTP To Change Mobile Number.'

            data = '{"message": "'+msg+'","binary": false,  "destinations": ["+'+str(country_code)+str(mobile_no)+'"]}'

            response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
            res = json.loads(response.text)
            print(res)
            try :
                if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                    sms_sent = 1
                                                            # return jsonify(res=1)
                else :
                    sms_sent = 0
            except :
                sms_sent = 0
                
            if sms_sent == 1 :
                m = "SMS Is Sent To +"+str(country_code)+str(mobile_no)
                return jsonify(res=1,msg=str(m))
            else :
                return jsonify(res=0,msg="Unable To Send SMS, Please Try Again.")
                
         
    if request.method == "POST" :
         pass              
    
    con.close()
    if len(str(session['college_profile_country_code']))== 0 or len(str(session['college_profile_mobile_no'])) == 0 :
        return redirect(url_for('college_profile'))
    
    return render_template("college_profile_update_mobile_no.html")



@app.route('/college/logout/')
def college_logout():
    if 'college_login_id' in session and 'college_login_email' in session and 'college_account_activated' in session :
        session['college_login_id'] = ""
        session['college_login_email'] = ""
        session['college_account_activated'] = ""
        session.pop('college_login_id',None)
        session.pop('college_login_email',None)
        session.pop('college_account_activated',None)
    return "<script>window.location.href='/college/login';</script>"



# Association Routes


@app.route('/association/signup/',methods=['GET','POST'])
def association_signup():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    isEmailExist = 0
    isMobileNoExist = 0
    session['association_signed_up_email'] = ""
    session['association_signed_up_f_name'] = ""
    session['association_signed_up_l_name'] = ""
    session['association_signed_up_url_part_1'] = ""
      
    inserted_into_db = 0
    mail_sent = 0
    file_uploaded = 0
    if request.method=='GET':
        mode=request.args.get('mode')

        
        if mode == "2":
            country = request.args.get('v')
        
            sql = "SELECT * FROM countries WHERE name='%s'" % (country)
            con.execute(sql)
            res = con.fetchall()
            return str(res[0][3])
        
        
    if request.method == 'POST' :
        
        f_name = str(request.form['first_name']).strip().lower()
        l_name = str(request.form['last_name']).strip().lower()
        email = str(request.form['email']).strip()
        country_code = int(request.form['country_code'])
        mobile_number = int(request.form['mobile_number'])
        password = request.form['password']
        # college_id = int(request.form['college'])
        # consent_letter = request.args.get('consent_letter')
            
            
        try :
            #Checking Email or Mobile Exists Or Not
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES'" % (email)
            con.execute(sql)
            res=con.fetchall()
            print("Association Email Exist : ",len(res))
            if len(res) == 1 :
                print("Association Erroor Mail/////////")
                flash(Markup("<p style='color:red;font-size:15px;'>This Email Is Already Registered With Us.</p>"))
                return redirect(url_for('association_signup'))
               
        except :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Comparing Email.</p>"))
            return redirect(url_for('association_signup'))
               
        
        try :
            #Checking  Mobile Exists Or Not
            sql = "SELECT * FROM association WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES'" % (country_code,mobile_number)
            con.execute(sql)
            res=con.fetchall()
            print("Association Mobile Exist : ",len(res))
            if len(res) == 1 :
                print("Association Erroor Mobile/////////")
                flash(Markup("<p style='color:red;font-size:15px;'>This Mobile Number Is Already Registered With Us.</p>"))
                return redirect(url_for('association_signup'))
        except :
            pass
            
            
        # print(consent_letter)
            
            # try :   
            #     #Checking For Student Record Exists Or Not
            #     sql = "SELECT * FROM students WHERE college='%s' AND degree='%s' AND enrollment_number=%d AND entry_year=%d AND passout_year=%d AND isStudentVerified='YES'" % (college,degree,enrollment_number,entry_year,passout_year)
            #     con.execute(sql)
            #     res=con.fetchall()
            #     print("Student Exist : ",len(res))
            #     if len(res) == 1 :
            #         print("Erroor Student Exist/////////")
            #         return jsonify(res=0,error="EMailExist",msg="A Student Record Is Already Registered With Us.")
            # except :
            #     pass   
            
        verification_code = str(uuid.uuid1())
            
        now = datetime.now()
        time = now.strftime("%Y-%m-%d %H:%M:%S")
            
            
        p_dirName = "static/uploads/"

        try :
            os.mkdir(p_dirName)
                    
        except FileExistsError:
            print("Directory " + p_dirName + " already exists")
                    
        c_dirName = "static/uploads/consent_letters/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        c_dirName = "static/uploads/consent_letters/association/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

      
        try :
            
            
            
            file = request.files['file-upload']
            if file.filename == "" :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Upload Consent Letter.</p>"))
                return redirect(url_for('association_signup'))
            path = "uploads/consent_letters"+"/"
            # p = path+secure_filename(file.filename)
            p = "static/uploads/consent_letters/association/"+verification_code+file.filename
            file.save(p)
            
            
        except :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading Consent Letter.</p>"))
            return redirect(url_for('association_signup'))
              
           
        url_part_1 = str(verification_code)
            
        sql = "INSERT INTO association(first_name,last_name, email,country_code, mobile_number, password, consent_letter, isEmailVerified, isMobileVerified,isAssociationVerified, verification_code,otp, account_status, time) VALUES('%s','%s','%s',%d,%d,'%s','%s','%s','%s','%s','%s',%d,'%s','%s')" % (f_name,l_name,email,country_code,mobile_number,password,p,"NO","NO","NO",verification_code,000000,"NOT ACTIVATED",time)
            
        try :
            con.execute(sql)
            cnx.commit()
            inserted_into_db = 1
        except :
            print("Association Error In Inserting In Database.")
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting In Database.</p>"))
            return redirect(url_for('association_signup'))
            
            
        
            
        if inserted_into_db == 1 :
            msg = Message('VERIFY YOUR EMAIL', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                    <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Thanks for joiningto <strong>ALUMNI ASSOCIATION OF GOA</strong></span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''association/verify/email/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>VERIFY MY EMAIL</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                print("Error In Sending Mail.")
                    
            session['association_signed_up_email'] = email
            session['association_signed_up_f_name'] = f_name
            session['association_signed_up_l_name'] = l_name
            session['association_signed_up_url_part_1'] = url_part_1
            
            if mail_sent == 1 :
                return redirect(url_for("association_welcome_email"))
            else :
                return redirect(url_for("association_signup"))
            
    
    sql = "SELECT * FROM countries"
    con.execute(sql)
    res = con.fetchall()
    countries = []
    for i in res :
        countries.append(i)
        
    con.close()

    return render_template('association_signup.html',countries=countries)


@app.route('/association/welcome_email/')
def association_welcome_email():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    mail_sent = 0
    if session['association_signed_up_email'] == "" or session['association_signed_up_f_name'] == "" or session['association_signed_up_l_name'] == "" :
        return redirect(url_for('association_signup'))
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = session['association_signed_up_email']
            f_name = session['association_signed_up_f_name']
            l_name = session['association_signed_up_l_name']
            url_part_1 = session['association_signed_up_url_part_1']
        
            msg = Message('VERIFY YOUR EMAIL', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                                                              <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/48bc327b-a5f2-40e0-80d4-ff98d66ffec1/1129x619.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 50px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 75px; margin: 0;"><span style="font-size: 50px;"><strong><span style="font-size: 50px;"><span style="font-size: 38px;">WELCOME</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                    <p style="font-size: 34px; line-height: 1.5; text-align: center; font-family: inherit; word-break: break-word; mso-line-height-alt: 51px; margin: 0;"><span style="font-size: 34px;"><strong><span style="font-size: 34px;"><span style="color: #2190e3; font-size: 34px;">'''+str(f_name).upper()+''' '''+str(l_name).upper()+'''</span></span>
                                                        </strong>
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Thanks for joiningto <strong>ALUMNI ASSOCIATION OF GOA</strong>.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''association/verify/email/'''+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>VERIFY MY EMAIL</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                print("Error In Sending Mail.")
                
            if mail_sent == 1 :
                return jsonify(res=1)
            else :
                return jsonify(res=0)
    
    con.close()
    return render_template('association_welcome_email.html')


@app.route('/association/verify/email/<string:verification_code>')
def association_verify_email(verification_code):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            m_n = int(request.args.get("mobile_no"))
            c_c = int(request.args.get("country_code"))
            #Checking  Mobile Exists Or Not
            sql = "SELECT * FROM association WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND verification_code='%s'" % (c_c,m_n,verification_code)
            con.execute(sql)
            res=con.fetchall()
            print("Association Mobile Exist : ",len(res))
            if len(res) == 1 :
                print("Association Erroor Mobile/////////")
                return jsonify(res=0,error="EMailExist",msg="This Mobile Number Is Already Registered With Us.")
            else :
                otp = random.randrange(111111,999999)
              
                sql = "UPDATE association SET country_code=%d,mobile_number=%d,isMobileVerified='NO',otp=%d WHERE verification_code='%s'" % (c_c,m_n,otp,verification_code)
                con.execute(sql)
                cnx.commit()
                
                country_code = "+"+str(request.args.get("country_code")).strip()
                mobile_no = str(request.args.get("mobile_no"))
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Welcome To Alumni Association Of Goa. Your OTP is '+str(otp)

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                    return jsonify(res=1)
                else :
                    return jsonify(res=0,error='UnableSMS',msg="Unable To Send SMS.\nPlease Try Again Later.")
        
        if mode == "2" :    
            
            m_n = int(request.args.get("mobile_no"))
            c_c = int(request.args.get("country_code"))
            otp = int(request.args.get("otp"))
            
            sql = "SELECT * FROM association WHERE verification_code='%s'" % (verification_code)
            con.execute(sql)
            res = con.fetchall()
            d_otp = int(res[0][12])
            
            if otp == d_otp :
                sql = "UPDATE association SET isMobileVerified='YES',otp=%d WHERE verification_code='%s'" % (0,verification_code)
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1)
            else :
                return jsonify(res=0,error="InvalidOTP",msg="Invalid OTP.")
                
                
            
            
    
    if len(verification_code) == 0 :
        return redirect(url_for('college_signup'))
    else :
        sql = "SELECT * FROM association WHERE verification_code='%s'" % (verification_code)
        con.execute(sql)
        res = con.fetchall()
        country_code = "+"+str(res[0][4])
        mobile_no = str(res[0][5])
        isEmailVerified = str(res[0][8])
        isMobileVerified = str(res[0][9])
        if len(res) == 1 :
            if isEmailVerified == "YES" :
                
                if isMobileVerified == "YES" :
                    flash("You Have Verified Email & Mobile Number Successfully.")
                else :
                    flash("Your Email Is Already Verified.")
            else :
                sql = "UPDATE association SET isEmailVerified='YES' WHERE verification_code='%s'" % (verification_code)
                con.execute(sql)
                cnx.commit()
                
                flash("Your Email Is Verified Successfully.")
                
    isBothVerified = 0
    if isEmailVerified == "YES" and isMobileVerified == "YES" :
        isBothVerified = 1
    else :
        isBothVerified = 0
    print(isBothVerified)
    con.close()
    return render_template('association_email_verification.html',country_code=country_code,mobile_no=mobile_no,verification_code=verification_code,isBothVerified=isBothVerified)


@app.route('/association/login/')
def association_login():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    accountActivated = 0
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = request.args.get('email')
            password = request.args.get('password')
            
            
            sql = "SELECT * FROM association WHERE email='%s' AND password='%s'" % (email,password)
            con.execute(sql)
            res = con.fetchall()
            print("execured")
            if len(res) >= 1 :
                sql = "SELECT * FROM association WHERE email='%s' AND password='%s' AND isEmailVerified='YES'" % (email,password)
                con.execute(sql)
                res = con.fetchall()
                print("e2")
                if len(res) >= 1 :
                    sql = "SELECT * FROM association WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email,password)
                    con.execute(sql)
                    res = con.fetchall()
                    print("e3")
                    print(res)
                    if len(res) == 1 :
                        sql = "SELECT * FROM association WHERE email='%s' AND password='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'" % (email,password)
                        con.execute(sql)
                        res = con.fetchall()
                        print("e4")
                        if len(res) == 1 :
                            accountActivated = 1
                            session['association_login_id'] = int(res[0][0])
                            session['association_login_email'] = email
                            session['association_account_activated'] = 1
                            print("e5")
                            return jsonify(res=1,error="No",msg="Successfully Logged In.") 
                            
                        else :
                            accountActivated = 0 
                            session['association_login_id'] = int(res[0][0])   
                            session['association_login_email'] = email
                            session['association_account_activated'] = 0
                            print("e6")
                            return jsonify(res=1,error="No",msg="Successfully Logged In.")
                            # return redirect(url_for('association_home'))
                    else :
                      return jsonify(res=0,error="NoMobileVerified",msg="Please Verify Your Mobile No. To Login.")  
                    
                else :
                   return jsonify(res=0,error="NoEmailVerified",msg="Please Verify Your Email To Login.") 
            else :
                print("c1")
                return jsonify(res=0,error="NoAccountFound",msg="Please Enter Correct Username & Password.")     
                
    con.close()
    return render_template('association_login.html')

@app.route('/association/home',methods=['GET','POST'])
def association_home():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 1 :
            discussion_title = request.form['discussion_content']
            post_tags = ""
        
            try :
                post_tags = request.form['post_tag_value'][1:]
            except :
                pass
        
            print(discussion_title)
            print(post_tags)
        
            if len(discussion_title) == 0 :
                return jsonify(res=0,msg="Please Enter Discussion Topic/Question.")
            
            now = datetime.now()
            date_time = now.strftime("%Y-%m-%d %H:%M:%S")
            
            try :
                
                sql = "INSERT INTO association_discussion(association_id,discussion_title,tags,total_views,date_time) VALUES(%d,'%s','%s',%d,'%s')" % (int(session['association_login_id']),str(discussion_title),str(post_tags),0,str(date_time))
                con.execute(sql)
                cnx.commit()
                print("Association : Discussion Post Created Successfully.")
                return jsonify(res=1,msg="Discussion Post Created Successfully.")

            except :
                print("Association Home : Error In Inserting In Discussion Forum.")
                return jsonify(res=0,msg="Error In Creating Discussion Post.")
        
        if mode == 2 :
            options = []
            total_options = int(request.form['total_options'])
            poll_question = str(request.form['poll_title']).strip()
            if len(poll_question) == 0 :
                return jsonify(res=0,msg="Please Enter Poll Question.")
            
            if total_options < 2 :
                return jsonify(res=0,msg="Please Enter Minimum Two Options.")
            else :
            
                for i in range(total_options) :
                    x = 'option_'+str(i+1)
                    v = request.form[x]
                    options.append(str(v))
                
                poll_response_table = "association_poll_response_"+str(uuid.uuid1()).replace("-","")
                isTableCreated = 0
                try :
               
                    sql = "CREATE TABLE "+str(poll_response_table)+" (id INT(20) UNSIGNED AUTO_INCREMENT PRIMARY KEY,membership_type VARCHAR(30) NOT NULL,profile_id INT NOT NULL,voted_option INT NOT NULL,date_time TIMESTAMP)"
                    con.execute(sql)
                    cnx.commit()
                    print("Poll Response Table Created For Options.")
                    isTableCreated = 1
                except :
                # cnx.rollback()
                    print("Association : Unable To Create Poll Response Table.")

                now = datetime.now()
                date_time = now.strftime("%Y-%m-%d %H:%M:%S")
                isPollInserted = 0
                if isTableCreated == 1 :
                    if total_options == 2 :
                        sql = "INSERT INTO association_poll_details(association_id,poll_table_name,poll_question,option_1,option_2,total_votes_for_option_1,total_votes_for_option_2,total_options,date_time) VALUES (%d,'%s','%s','%s','%s',%d,%d,%d,'%s')" % (int(session['association_login_id']),str(poll_response_table),str(poll_question),str(options[0]),str(options[1]),0,0,total_options,str(date_time))
                        con.execute(sql)
                        cnx.commit()
                        print("Inserted For 2 Options.")
                        isPollInserted = 1
                    
                    if total_options == 3 :
                        sql = "INSERT INTO association_poll_details(association_id,poll_table_name,poll_question,option_1,option_2,option_3,total_votes_for_option_1,total_votes_for_option_2,total_votes_for_option_3,total_options,date_time) VALUES (%d,'%s','%s','%s','%s','%s',%d,%d,%d,%d,'%s')" % (int(session['association_login_id']),str(poll_response_table),str(poll_question),str(options[0]),str(options[1]),str(options[2]),0,0,0,total_options,str(date_time))
                        con.execute(sql)
                        cnx.commit()
                        print("Inserted For 3 Options.")
                        isPollInserted = 1
                    
                    if total_options == 4 :
                        sql = "INSERT INTO association_poll_details(association_id,poll_table_name,poll_question,option_1,option_2,option_3,option_4,total_votes_for_option_1,total_votes_for_option_2,total_votes_for_option_3,total_votes_for_option_4,total_options,date_time) VALUES (%d,'%s','%s','%s','%s','%s','%s',%d,%d,%d,%d,%d,'%s')" % (int(session['association_login_id']),str(poll_response_table),str(poll_question),str(options[0]),str(options[1]),str(options[2]),str(options[3]),0,0,0,0,total_options,str(date_time))
                        con.execute(sql)
                        cnx.commit()
                        print("Inserted For 4 Options.")
                        isPollInserted = 1
                    
                    if isPollInserted == 1 :
                        return jsonify(res=1,msg="Poll Created Successfully.")
                    else :
                        return jsonify(res=0,msg="Error In Creating Poll.")
                else :
                    return jsonify(res=0,msg="Error In Creating Poll Response Table.")
      

        if mode == 3 :
        
            poll_id = int(request.form['poll_id'])
            option_id = str(request.form['option_id']).strip()
        
            isGot = 0
            isInserted = 0
            try :
                sql = "SELECT * FROM association_poll_details WHERE id=%d" % (poll_id)
                con.execute(sql)
                res = con.fetchall()
                isGot = 1
            except :
                print("Error In Getting Poll Details To Vote.")
           
            isExist = 0
            if isGot == 1 :
                
                poll_table = res[0][2]
                now = datetime.now()
                d_t = now.strftime("%Y-%m-%d %H:%M:%S")
               
                try :
                    sql = "SELECT * FROM "+str(poll_table)+" WHERE membership_type='ASSOCIATION MEMBER' AND profile_id="+str(session['association_login_id'])
                    con.execute(sql)
                    res = con.fetchall()
                    
                    if len(res) != 0 :
                        isExist = 1
                        res_id = res[0][0]
                        voted_option = res[0][3]

                        return jsonify(res=0,msg="You Have Already Responded To This Poll.")
                    else :
                        try :
                            sql = "INSERT INTO "+str(poll_table)+"(membership_type,profile_id,voted_option,date_time) VALUES('%s',%d,%d,'%s')" % ("ASSOCIATION MEMBER",int(session['association_login_id']),int(option_id),d_t)
                            con.execute(sql)
                            cnx.commit()
                            isInserted = 1
                        except :
                            print("Error In Putting Response.")
                            
                        try :
                            option_v = "total_votes_for_option_"+str(option_id)
                            sql = "UPDATE association_poll_details SET "+str(option_v)+"="+str(option_v)+"+1 WHERE id="+str(poll_id)
                            con.execute(sql)
                            cnx.commit()
                            option_v = "total_votes_for_option_"+str(option_id)
                            sql = "SELECT "+str(option_v)+",total_options FROM association_poll_details WHERE id="+str(poll_id)
                            con.execute(sql)
                            res = con.fetchall()
                        
                            cnx.commit()
                            return jsonify(res=1,msg="Success.",total_count=res[0][0],total_options=res[0][1])

                        except :
                            return jsonify(res=0,msg="Error In Updating Poll Count.")
                                
                except :
                    return jsonify(res=1,msg="Error In Getting Poll Table.")
                                
                
            else :
                return jsonify(res=0,msg="Error In Getting Poll Details.")

        
            
            
            
       
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
                
        
    main_profile_details = []
    basic_profile_details = []
    blog_posts = []
    try :
        sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("Error In Getting Main Profile Details.")
        pass
    
    try :
        sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("Error In Getting Basic Profile Details.")
        pass
    
    # print(basic_profile_details)
    
    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
    random_bg_color = color[0]
    # print(random_bg_color)
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM association_education_details WHERE association_id=%d ORDER BY id DESC" % (int(session['association_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("Association : Error In Getting Education Details Of Profile")
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM association_work_details WHERE association_id=%d ORDER BY id DESC" % (int(session['association_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Association : Error In Getting Education Details Of Profile")
    try :
        profile_pic = basic_profile_details[0][9]
        l_profile_pic = len(profile_pic)
    except :
        profile_pic = ""
        l_profile_pic = len(profile_pic)
    
    profile_network_details = []
    try :
        sql = "SELECT * FROM network WHERE from_id=%d AND from_type='ASSOCIATION MEMBER' ORDER BY date_time DESC" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            user_id = int(i[4])
            if i[3] == "ASSOCIATION MEMBER" :
                try :
                    sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("Association : Error In Getting Network Profile Details.")
    except :
        print("Association : Error In Getting Education Details Of Profile")
        
    polls_for_profile = []
    try :
        sql = "SELECT * FROM association_poll_details WHERE association_id !=%d ORDER BY date_time DESC LIMIT 3" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        print(res)
        for i in range(len(res)) :
            t = list(res[i])
            user_id = int(res[i][1])
            print("user id : ",user_id)
            profile_temp_details = []
            try :
                sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (user_id,user_id)
                con.execute(sql)
                xy = con.fetchall()
                profile_temp_details = ["Association Member",user_id,xy[0][0],xy[0][1],xy[0][2]]
            except :
                try :
                    sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_temp_details = ["Association Member",user_id,xy[0][0],xy[0][1],"NO"]
                except:
                    print("Association : Error In Getting Poll Profile Details.")
    
            print(profile_temp_details)
            j = 0
            for i in range(14,19):
                t.insert(i,profile_temp_details[j])
                j += 1
                
            polls_for_profile.append(t)
            # t = list(res[i])
            # t.insert(14,profile_temp_details)
            # print(t)
            # polls_for_porfile.append(profile_temp_details)
            
    except :
        print("Association : Error In Getting Poll For Association.")
    

    blog_posts = []
    try :
        sql = "SELECT * FROM blog_post_association WHERE association_id !=%d ORDER BY date_time DESC LIMIT 15" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    t.append(soup.get_text())
                else :
                    t.append(res[i][j])
                    
            blog_posts.append(t)
            
    except :
        print("Association : Error In Getting Profile Blog Post Details.")
    
    news = []
    
    try :
        sql = "SELECT * FROM association_news WHERE association_id !=%d ORDER BY date_time DESC LIMIT 10" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in res : 
            print(i[0]) 
            soup = BeautifulSoup(str(i[4]),features="html.parser")
            n_desc = soup.get_text()
            
            n_cat = str(i[5]).replace(","," ")
            d_t = i[7].strftime("%d/%m/%Y")
            news.append([i[0],i[2],i[3],n_desc,n_cat,d_t])
            
    except :
        print("Error In Getting Association News.")
    
    return render_template("association_home.html",main_profile_details=main_profile_details,random_bg_color=random_bg_color,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),blog_posts=blog_posts,l_blog_posts=len(blog_posts),profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details),profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),profile_pic=profile_pic,l_profile_pic=l_profile_pic,profile_network_details=profile_network_details,l_profile_network_details=len(profile_network_details),polls_for_profile=polls_for_profile,l_polls_for_profile=len(polls_for_profile),news=news,l_news=len(news))


@app.route('/association/fund-raising-projects')
def association_fund_raising_projects():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        accountActivated = session['association_account_activated']
        if accountActivated == 1 :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        else :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        
      
         
        return render_template("association_fund_raising_projects.html",account_details=account_details)
    con.close()


@app.route("/association/college_applications")
def association_college_applications():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    applications = []
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        accountActivated = session['association_account_activated']
        if accountActivated == 1 :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        else :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]

        
        
        sql = "SELECT * FROM college_spoc WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isSpocVerified='NO' AND account_status='NOT ACTIVATED'"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            applications.append(i)
            
    if request.method=='GET':
        mode=request.args.get('mode')
        isUpdated = 0
        mail_sent = 0
        sms_sent = 0
        if mode == "1":
            spoc_id = int(request.args.get('spoc_id'))
            print("spoc id : ",spoc_id)
            sql = "UPDATE college_spoc SET isSpocVerified='YES',account_status='ACTIVATED' WHERE spoc_id=%d" % (spoc_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (spoc_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][4])
            name = str(res[0][2]) + " " + str(res[0][3])
            
        if isUpdated == 1 :
            msg = Message('Application Approved', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                         <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_confirmed_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Congratulations <b>'''+name+'''</b> ! Your application has been accepted by Alumni Association Of Goa. Now you are officially part of ALUMNI ASSOCIATION OF GOA.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''college/login" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>LOGIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>            
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Confirmation Mail.")
            
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][5])
                mobile_no = str(res[0][6])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Congratulations '+name+' ! Your Application has been approved by Alumni Association Of Goa.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
            
                
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    
                    if sms_sent == 1 :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.")
                    else :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.\nBut Unable To Send Confirmation SMS.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is accepted successfully but unable to send confirmation email.")
            else :
                return jsonify(res=0,error="AcceptUpdateError",msg="Unable To Accept Application.")
        
        if mode == "2":
            spoc_id = int(request.args.get('spoc_id'))
            print("spoc id : ",spoc_id)
            sql = "UPDATE college_spoc SET isSpocVerified='NO',account_status='REJECTED' WHERE spoc_id=%d" % (spoc_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (spoc_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][4])
            name = str(res[0][2]) + " " + str(res[0][3])
            
        if isUpdated == 1 :
            msg = Message('Application Rejected', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_rejected_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;text-align:left !important;word-wrap:break-word"><span style="font-size: 18px; color: #000000;;">
                                                      Thank you '''+name+''' for your application at ALUMNI ASSOCIATION OF GOA. We really appreciate your interest in joining our association and we want to thank you for the time and energy you invested in applying for this application.
                                                      <br><br>
                                                      <b>After carefully reviewing all of them, unfortunately, we have to inform you that this time we wont be able to invite you to ALUMNI ASSOCIATION OF GOA.</b> We hope youll keep us in mind and apply again in the future on behalf of your college.

                                                      <br><br>If you have any questions or need additional information, please dont hesitate to contact us.
                                                      
We wish you every personal and professional success in your future endeavors.
                                                      
Once again, thank you for showing interest in ALUMNI ASSOCIATION OF GOA.

                                                      
                                                      </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''contact" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CONTACT US</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>                                     
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Rejection College Mail.")
                
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][5])
                mobile_no = str(res[0][6])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Unfortunately, Application for '+name+' at Alumni Association Of Goa has been rejected. Better Luck Next Time.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
                
            
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    return jsonify(res=1,error="No",msg="Application Is Rejected Successfully.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is rejected successfully but unable to send rejection email.")
            
            else :
                return jsonify(res=0,error="RejectUpdateError",msg="Unable To Reject Application.")

    con.close()
    return render_template('association_college_applications.html',applications=applications,account_details=account_details,total_applications=len(applications))

@app.route("/association/directory",methods=['GET','POST'])
def association_directory():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 1 :
            college_id = request.form['college_id']
            college_name = request.form['college_name']
            total_college_members = request.form['total_college_members']
            res = []
            sql = "SELECT * FROM students WHERE college='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (str(college_name))
            con.execute(sql)
            res = con.fetchall()
            class_of_list = []
            content = ''''''
            if len(res) == 0 :
                return jsonify(res=0,msg="No Students Found.")
            else :
                for i in res :
                    if int(i[11]) not in class_of_list :
                        class_of_list.append(int(i[11]))
                    
                
                print(class_of_list)
                
                for i in class_of_list :
                    sql = "SELECT * FROM students WHERE college='%s' AND passout_year=%d AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (str(college_name),int(i))
                    con.execute(sql)
                    res = con.fetchall()
                    content += '''
                                    <div class="college_con" id="college_con" data-collegeid="'''+str(college_id)+'''" data-passoutyear="'''+str(i)+'''" data-collegename="'''+str(college_name)+'''" data-collegemembers="'''+str(total_college_members)+'''" style="padding: 20px;text-align: center;box-shadow: 1px 1px 3px gray,-1px -1px 3px gray;border-radius: 20px;cursor: pointer;" onclick="classof_Click(this);">
                                    <div class="college_c">
                                            <p style="font-size: 25px;padding:0 0 5px 0;">Class Of '''+str(i)+'''</p>
                                            <p  style="color: gray;"><span class="college_members_count">'''+str(len(res))+'''</span> Members</p>
                                    </div>
                                </div>
                    '''
                    
                print(content)
                return jsonify(res=1,msg=content)
        
        if mode == 2 :
            college_id = request.form['college_id']
            college_name = request.form['college_name']
            class_of = int(request.form['class_of'])
            total_college_members = request.form['total_college_members']
            res = []
            sql = "SELECT * FROM students WHERE college='%s' AND passout_year=%d AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (str(college_name),int(class_of))
            con.execute(sql)
            res = con.fetchall()
            college_degree_list = []
            content = ''''''
            if len(res) == 0 :
                return jsonify(res=0,msg="No Students Found.")
            else :
                sql = "SELECT * FROM college_degrees WHERE college_id=%d" % (int(college_id))
                con.execute(sql)
                res = con.fetchall()
                for i in res :
                    college_degree_list.append(str(i[2]))
                
                # print(college_degree_list)
                
                for i in college_degree_list :
                    sql = "SELECT * FROM students WHERE college='%s' AND passout_year=%d AND degree='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (str(college_name),int(class_of),str(i))
                    con.execute(sql)
                    res = con.fetchall()
                    content += '''
                                    <div class="college_con" id="college_con" data-collegeid="'''+str(college_id)+'''" data-passoutyear="'''+str(class_of)+'''" data-collegename="'''+str(college_name)+'''" data-collegemembers="'''+str(total_college_members)+'''" data-degree="'''+str(i)+'''" style="padding: 20px;text-align: center;box-shadow: 1px 1px 3px gray,-1px -1px 3px gray;border-radius: 20px;cursor: pointer;" onclick="degree_Click(this);">
                                    <div class="college_c">
                                            <p style="font-size: 25px;padding:0 0 5px 0;">'''+str(i)+'''</p>
                                            <p  style="color: gray;"><span class="college_members_count">'''+str(len(res))+'''</span> Members</p>
                                    </div>
                                </div>
                    '''
                    
                print(content)
                return jsonify(res=1,msg=content)
        
        if mode == 3 :
            college_id = request.form['college_id']
            college_name = request.form['college_name']
            class_of = int(request.form['class_of'])
            degree = str(request.form['degree'])
            total_college_members = request.form['total_college_members']
            res = []
            sql = "SELECT * FROM students WHERE college='%s' AND passout_year=%d AND degree='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (str(college_name),int(class_of),str(degree))
            con.execute(sql)
            res = con.fetchall()
            college_student_list = []
            content = ''''''
            if len(res) == 0 :
                return jsonify(res=0,msg="No Students Found.")
            else :
                j = 0
                for i in res :
                    user_id = int(i[0])
                    college_student_list.append([user_id,str(i[1]).capitalize(),str(i[2]).capitalize()])
                    isFound = 0
                    try :
                        sql = "SELECT * FROM student_basic_profile_details WHERE student_id=%d" % (int(user_id))
                        con.execute(sql)
                        res = con.fetchall()
                        if len(res) != 0 :
                            isFound = 1
                            college_student_list[j].append(res[0][9])
                            college_student_list[j].append(college_name)
                            college_student_list[j].append("Class Of "+str(class_of))
                            college_student_list[j].append(degree)
                    except :
                        print("Association : Directory Error In Getting Basic Student Details.")
                        
                    if isFound == 0 :
                        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                        random_bg_color = color[0]
                        p_i = 'https://ui-avatars.com/api/?size=128&name='''+str(college_student_list[j][1]).capitalize()+'+'+str(college_student_list[j][2]).capitalize()+'&background='+str(random_bg_color)+'&color=fff'
                        college_student_list[j].append(str(p_i))
                        college_student_list[j].append(college_name)
                        college_student_list[j].append("Class Of "+str(class_of))
                        college_student_list[j].append(degree)
                        content += '''
                                    <figure class="snip1268">
                                    <div class="image">
                                    <img src="'''+str(college_student_list[j][3])+'''" alt="Porfile Image" style="width:100%;"/>
                                    <a href=".../../../association/profile/'''+str(college_student_list[j][0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                    </div>
                                    <figcaption style="text-align:center !important;">
                                    <h2 style="font-size:30px;text-align:center;">'''+str(college_student_list[j][1])+''' '''+str(college_student_list[j][2])+'''</h2>
                                    <p style="margin:0;padding:0;tex-align:center !important;font-weight:bold;color:gray;">'''+str(college_student_list[j][6])+'''</p>
                                    <p style="margin:0;padding:0;tex-align:center !important;">('''+str(college_student_list[j][5])+''')</p>
                                    </figcaption>
                                </figure>
                    '''
                        
                    else :
                        content += '''
                                    <figure class="snip1268">
                                    <div class="image">
                                    <img src="../../../'''+str(college_student_list[j][3])+'''" alt="Porfile Image" style="width:100%;"/>
                                    <a href=".../../../association/profile/'''+str(college_student_list[j][0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                    </div>
                                    <figcaption style="text-align:center !important;">
                                    <h2 style="font-size:30px;text-align:center;">'''+str(college_student_list[j][1])+''' '''+str(college_student_list[j][2])+'''</h2>
                                    <p style="margin:0;padding:0;tex-align:center !important;font-weight:bold;color:gray;">'''+str(college_student_list[j][6])+'''</p>
                                    <p style="margin:0;padding:0;tex-align:center !important;">('''+str(college_student_list[j][5])+''')</p>
                                    </figcaption>
                                </figure>
                    '''
                    
                    j += 1
                # print(college_student_list)
                return jsonify(res=1,msg=content)
        
        
    college_list = []
    try:
        sql = "SELECT * FROM colleges"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            c_n = i[1]
            sql = "SELECT * FROM students WHERE college='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'" % (str(c_n))
            con.execute(sql)
            res2 = con.fetchall()
            college_list.append([i[0],i[1],len(res2)])
    except :
        print("Error In Getting College List")
    
    con.close()
    return render_template("association_directory.html",college_list=college_list,l_college_list=len(college_list))

@app.route('/association/search/',methods=['GET','POST'])
def association_search():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
           
                        
    if request.method == "POST" :
        mode = request.form["mode"]
        if mode == "1" :
            s_q = str(request.form["search_query"]).strip().lower()
            college_value = request.form.getlist('college_value')
            college_degree_value = request.form.getlist('college_degree_value')
            starting_year_value = request.form.getlist('starting_year_value')
            graduation_year_value = request.form.getlist('graduation_year_value')
            location = str(request.form['location']).strip()
            
            print(s_q)
            alumni_results = ''''''
            alumni_results_a = []
            college_results = ''''''
            college_results_a = []
            association_results = ''''''
            association_results_a = []
            # For Alumni
            sql = ""
            sql2 = ""
            isAlumniProfileAvailable = 0
         
         
            print(college_value)
            print(college_degree_value)
            print(starting_year_value)
            print(graduation_year_value)
            print(location)
            
            content = ''''''
            
            if len(college_value) == 0 and len(college_degree_value) == 0 and len(starting_year_value) == 0 and len(graduation_year_value) == 0 and len(location) == 0 :
                print("EXEC")
                # Alumni
                sql = "SELECT * FROM students WHERE first_name LIKE '%"+str(s_q)+"%' OR last_name LIKE '%"+s_q+"%'"
                con.execute(sql)
                res = con.fetchall()
                for i in res :
                    isGot = 0
                    res2 = []
                    t = []
                    try :
                        user_id = int(i[0])
                        sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(user_id))
                        con.execute(sql)
                        res2 = con.fetchall()
                        isGot = 1
                    except :
                        print("Error In Getting Basic Profile Details.")
                    
                    if isGot == 1 :
                        #id,f_name,l_name,isImage,path,
                        t = [i[0],i[1],i[2],"YES",res2[0][9],i[7],i[8],i[10],i[11],res2[0][8]]
                    else :
                        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                        random_bg_color = color[0]
                            
                        p_i = "https://ui-avatars.com/api/?size=512&name="+str(i[1]).capitalize()+"+"+str(i[2]).capitalize()+"&background="+str(random_bg_color)+"&color=fff"
                        t = [i[0],i[1],i[2],"NO",p_i,i[7],i[8],i[10],i[11],"N/A"]
                    
                    alumni_results_a.append(t)

                print(alumni_results_a)
                alumni_results = '''''' 
                if len(alumni_results_a) == 0 :
                    alumni_results = "<br><p style='color:gray;text-align:center;'>No Alumni Found.</p></br>"
                
                for i in alumni_results_a :
                    alumni_results += '''
                               <figure class="snip1268">
                       
                                                 '''
                    print('i[3] : ',i)
                    if i[3] == "YES" :           
                        alumni_results += '''<div class="image"><img src="../../'''+str(i[4])+'''" alt="sq-sample4" style="height: 300px;width:100%"/>
                                                      <a href="../../alumni/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                    else :                            
                    
                        alumni_results += '''<div class="image"><img src="'''+str(i[4])+'''" alt="sq-sample4" style="height: 200px;width:100%;"/>
                                                      <a href="../../alumni/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                                    
                    alumni_results += '''<figcaption>
                                                       
                                                      <h2 style="max-height:50px;font-size: 25px;">'''+str(i[1]).capitalize()+''' '''+str(i[2]).capitalize()+'''</h2>
                                                     
                                                      <table>
                                                        <tr>
                                                            <td style="border: none;background-color: white;">    
                                                                <i class="fas fa-university"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                   '''+str(i[5])+'''
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-user-graduate"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[6])+'''
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-sign-in-alt"></i>
                                                                
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                    '''+str(i[7])+''' - '''+str(i[8])+'''
                                                            </td>
                                                           
                                                        </tr>'''
                                                    
                    if i[9] != "N/A" :           
                        alumni_results += '''<tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-map-marker-alt"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[9])+'''
                                                            </td>
                                                        </tr>'''
                                                    
                    alumni_results +=  '''</table>
                                                    </figcaption>
                                                  </figure>
                    '''
            
                # College_SPOC
                sql = "SELECT * FROM college_spoc WHERE first_name LIKE '%"+str(s_q)+"%' OR last_name LIKE '%"+s_q+"%'"
                con.execute(sql)
                res = con.fetchall()
                for i in res :
                    isGot = 0
                    res2 = []
                    t = []
                    try :
                        user_id = int(i[0])
                        sql = "SELECT * FROM college_basic_profile_details WHERE spoc_id=%d" % (int(user_id))
                        con.excecute(sql)
                        res2 = con.fetchall()
                        isGot = 1
                    except :
                        print("Error In Getting College Basic Profile Details.")
                    
                    if isGot == 1 :
                        #id,f_name,l_name,isImage,path,
                        t = [i[0],i[2],i[3],"YES",res2[0][9],i[8],res2[0][8]]
                    else :
                        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                        random_bg_color = color[0]
                            
                        p_i = "https://ui-avatars.com/api/?size=512&name="+str(i[2]).capitalize()+"+"+str(i[3]).capitalize()+"&background="+str(random_bg_color)+"&color=fff"
                        t = [i[0],i[2],i[3],"NO",p_i,i[8],"N/A"]
                    
                    college_results_a.append(t)

                print("College : ",college_results_a)
                college_results = '''''' 
                if len(college_results_a) == 0 :
                    college_results = "<br><p style='color:gray;text-align:center;'>No College SPOC Found.</p></br>"
                
                for i in college_results_a :
                    college_results += '''
                               <figure class="snip1268">
                       
                                                 '''
                    # print('i[3] : ',i)
                    if i[3] == "YES" :           
                        college_results += '''<div class="image"><img src="../../'''+str(i[4])+'''" alt="sq-sample4" style="height: 200px;width:100%"/>
                                                      <a href="../../college/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                    else :                            
                    
                        college_results += '''<div class="image"><img src="'''+str(i[4])+'''" alt="sq-sample4" style="height: 200px;width:100%;"/>
                                                      <a href="../../college/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                                    
                    college_results += '''<figcaption>
                                                       
                                                      <h2 style="max-height:50px;font-size: 25px;">'''+str(i[1]).capitalize()+''' '''+str(i[2]).capitalize()+'''</h2>
                                                     
                                                      <table>
                                                        <tr>
                                                            <td style="border: none;background-color: white;">    
                                                                <i class="fas fa-university"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                   '''+str(i[5])+'''
                                                            </td>
                                                        </tr>
                                                        '''
                                                    
                    if i[6] != "N/A" :           
                        college_results += '''<tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-map-marker-alt"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[6])+'''
                                                            </td>
                                                        </tr>'''
                                                    
                    college_results +=  '''</table>
                                                    </figcaption>
                                                  </figure>
                    '''
            

                
                # Association
                sql = "SELECT * FROM association WHERE first_name LIKE '%"+str(s_q)+"%' OR last_name LIKE '%"+s_q+"%'"
                con.execute(sql)
                res = con.fetchall()
                for i in res :
                    isGot = 0
                    res2 = []
                    t = []
                    try :
                        user_id = int(i[0])
                        sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(user_id))
                        con.excecute(sql)
                        res2 = con.fetchall()
                        isGot = 1
                    except :
                        print("Error In Getting Basic Profile Details.")
                    
                    if isGot == 1 :
                        #id,f_name,l_name,isImage,path,
                        t = [i[0],i[1],i[2],"YES",res2[0][9],res2[0][8]]
                    else :
                        color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                        random_bg_color = color[0]
                            
                        p_i = "https://ui-avatars.com/api/?size=512&name="+str(i[1]).capitalize()+"+"+str(i[2]).capitalize()+"&background="+str(random_bg_color)+"&color=fff"
                        t = [i[0],i[1],i[2],"NO",p_i,"N/A"]
                    
                    association_results_a.append(t)

                # print(alumni_results_a)
                association_results = '''''' 
                if len(association_results_a) == 0 :
                    association_results = "<br><p style='color:gray;text-align:center;'>No Association Member Found.</p></br>"
                
                for i in association_results_a :
                    association_results += '''
                               <figure class="snip1268">
                       
                                                 '''
                    # print('i[3] : ',i)
                    if i[3] == "YES" :           
                        association_results += '''<div class="image"><img src="../../'''+str(i[4])+'''" alt="sq-sample4" style="height: 200px;width:100%"/>
                                                      <a href="../../alumni/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                    else :                            
                    
                        association_results += '''<div class="image"><img src="'''+str(i[4])+'''" alt="sq-sample4" style="height: 200px;width:100%;"/>
                                                      <a href="../../alumni/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                                    
                    association_results += '''<figcaption>
                                                       
                                                      <h2 style="max-height:50px;font-size: 25px;">'''+str(i[1]).capitalize()+''' '''+str(i[2]).capitalize()+'''</h2>
                                                     
                                                      <table>
                                                       
                                                        
                                                       '''
                                                    
                    if i[5] != "N/A" :           
                        association_results += '''<tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-map-marker-alt"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[5])+'''
                                                            </td>
                                                        </tr>'''
                                                    
                    association_results +=  '''</table>
                                                    </figcaption>
                                                  </figure>
                    '''
            
                
            else :
                #Association
                sql = ""
                if len(s_q) != 0 :
                    sql += "SELECT * FROM association,association_education_details WHERE (association.first_name LIKE '%"+str(s_q)+"%'"+" OR association.last_name LIKE '%"+str(s_q)+"%')"
                
                
                    if len(college_value) != 0 :
                        if len(college_value) == 1 :
                                sql += " AND (association_education_details.name_of_institute='"+str(college_value[0])+"')"
                        else :    
                            for i in range(len(college_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.name_of_institute='"+str(college_value[i])+"'"
                                else :
                                    if i == len(college_value)-1 :
                                        sql += " OR association_education_details.name_of_institute='"+str(college_value[i])+"')"
                                    else :
                                        sql += " OR association_education_details.name_of_institute='"+str(college_value[i])+"'"
                                
                                    
                    
                    if len(college_degree_value) != 0 :
                        if len(college_degree_value) == 1 :
                                sql += " AND (association_education_details.degree='"+str(college_degree_value[0])+"')"
                        else :    
                            for i in range(len(college_degree_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.degree='"+str(college_degree_value[i])+"'"
                                else :
                                    if i == len(college_degree_value)-1 :
                                        sql += " OR association_education_details.degree='"+str(college_degree_value[i])+"')"
                                    else :
                                        sql += " OR association_education_details.degree='"+str(college_degree_value[i])+"'"
                        
                            
                        
                    if len(starting_year_value) != 0 :
                        if len(starting_year_value) == 1 :
                                sql += " AND (association_education_details.start_year="+str(starting_year_value[0])+")"
                        else :    
                            for i in range(len(starting_year_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.start_year="+str(starting_year_value[i])
                                else :
                                    if i == len(starting_year_value)-1 :
                                        sql += " OR association_education_details.start_year="+str(starting_year_value[i])+")"
                                    else :
                                        sql += " OR association_education_details.start_year="+str(starting_year_value[i])
                    
                            
                    if len(graduation_year_value) != 0 :
                        if len(graduation_year_value) == 1 :
                                sql += " AND (association_education_details.graduation_year="+str(graduation_year_value[0])+")"
                        else :    
                            for i in range(len(graduation_year_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.graduation_year="+str(graduation_year_value[i])
                                else :
                                    if i == len(graduation_year_value)-1 :
                                        sql += " OR association_education_details.graduation_year="+str(graduation_year_value[i])+")"
                                    else :
                                        sql += " OR association_education_details.graduation_year="+str(graduation_year_value[i])
                                        
                    if len(location) != 0 :
                        t = list(sql)
                        t.insert(55,",association_basic_profile_details")
                        sql = ''.join(t)
                        sql += " AND (association_basic_profile_details.current_location='"+str(location)+"')"
                                        
                        print("))))))))))))))))))))))))))))))",sql)
                                    
                            
                    
                    sql += " AND (association.association_id=association_education_details.association_id) AND (association.association_id !="+str(session['association_login_id'])+") AND (association_education_details.association_id !="+str(session['association_login_id'])+")" 
                    
                    
                    
                    print(sql)
                    
                    association_results = ""
                    try :
                        con.execute(sql)
                        res = con.fetchall()
                        # content2 = ''''''
                        print(res)
                        if len(res) == 0 :
                            association_results = "<br><p style='color:gray;text-align:center;'>No Association Member Found.</p></br>"

                        else :
                            for i in res :
                                isImage = "NO"
                                try :
                                    user_id = int(i[0])
                                    sql = "SELECT profile_image FROM association_basic_profile_details WHERE association_id=%d" % (int(user_id))
                                    con.excecute(sql)
                                    res2 = con.fetchall()
                                    if len(res2) == 1 :
                                        isGot = 1
                                        print("NOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")
                                    else :
                                        isGot = 0
                                except :
                                    isGot = 0
                                    print("Error In Getting Basic Profile Details.")
                            
                                print("value of isGot : ",isGot)
                            
                                association_results += '''
                               <figure class="snip1268">
                       
                                                 '''
                                
                                if isGot == 1 :
                                       
                           
                                    association_results += '''<div class="image"><img src="../../'''+str(i[0])+'''" alt="sq-sample4" style="height: 200px;width:100%"/>
                                                      <a href="../../alumni/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                             
                                else :    
                                    print("Got It")                         
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                                    random_bg_color = color[0]
                                        
                                    p_i = "https://ui-avatars.com/api/?size=512&name="+str(i[1]).capitalize()+"+"+str(i[2]).capitalize()+"&background="+str(random_bg_color)+"&color=fff"
                                    
                                    association_results += '''<div class="image"><img src="'''+str(p_i)+'''" alt="sq-sample4" style="height: 300px;width:100%;"/>
                                                      <a href="../../association/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                                    
                                association_results += '''<figcaption>
                                                       
                                                      <h2 style="max-height:50px;font-size: 25px;">'''+str(i[1]).capitalize()+''' '''+str(i[2]).capitalize()+'''</h2>
                                                     
                                                      <table>
                                                       
                                                        
                                                       '''
                                                    
                            
                                association_results += ''' <tr>
                                                            <td style="border: none;background-color: white;">    
                                                                <i class="fas fa-university"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[17])+'''
                                                            </td>
                                                        </tr>
                                                        '''
                                                    
                                association_results +=  '''</table>
                                                    </figcaption>
                                                  </figure>
                    '''
            
                            # return jsonify(res=1,content=content,l_content=len(content))
                    except :
                        
                        print("Error In Getting Searched Data With College..")

                else :
                    print("No Search Query Found.")
                    pass
                
                #College SPOC
                sql = ""
                if len(s_q) != 0 :
                    sql += "SELECT * FROM college_spoc,college_education_details WHERE (college_spoc.first_name LIKE '%"+str(s_q)+"%'"+" OR college_spoc.last_name LIKE '%"+str(s_q)+"%')"
                
                
                    if len(college_value) != 0 :
                        if len(college_value) == 1 :
                                sql += " AND (college_education_details.name_of_institute='"+str(college_value[0])+"')"
                        else :    
                            for i in range(len(college_value)):
                                if i == 0 :
                                    sql += " AND (college_education_details.name_of_institute='"+str(college_value[i])+"'"
                                else :
                                    if i == len(college_value)-1 :
                                        sql += " OR college_education_details.name_of_institute='"+str(college_value[i])+"')"
                                    else :
                                        sql += " OR college_education_details.name_of_institute='"+str(college_value[i])+"'"
                                
                                    
                    
                    if len(college_degree_value) != 0 :
                        if len(college_degree_value) == 1 :
                                sql += " AND (college_education_details.degree='"+str(college_degree_value[0])+"')"
                        else :    
                            for i in range(len(college_degree_value)):
                                if i == 0 :
                                    sql += " AND (college_education_details.degree='"+str(college_degree_value[i])+"'"
                                else :
                                    if i == len(college_degree_value)-1 :
                                        sql += " OR college_education_details.degree='"+str(college_degree_value[i])+"')"
                                    else :
                                        sql += " OR college_education_details.degree='"+str(college_degree_value[i])+"'"
                        
                            
                        
                    if len(starting_year_value) != 0 :
                        if len(starting_year_value) == 1 :
                                sql += " AND (college_education_details.start_year="+str(starting_year_value[0])+")"
                        else :    
                            for i in range(len(starting_year_value)):
                                if i == 0 :
                                    sql += " AND (college_education_details.start_year="+str(starting_year_value[i])
                                else :
                                    if i == len(starting_year_value)-1 :
                                        sql += " OR college_education_details.start_year="+str(starting_year_value[i])+")"
                                    else :
                                        sql += " OR college_education_details.start_year="+str(starting_year_value[i])
                    
                            
                    if len(graduation_year_value) != 0 :
                        if len(graduation_year_value) == 1 :
                                sql += " AND (college_education_details.graduation_year="+str(graduation_year_value[0])+")"
                        else :    
                            for i in range(len(graduation_year_value)):
                                if i == 0 :
                                    sql += " AND (college_education_details.graduation_year="+str(graduation_year_value[i])
                                else :
                                    if i == len(graduation_year_value)-1 :
                                        sql += " OR college_education_details.graduation_year="+str(graduation_year_value[i])+")"
                                    else :
                                        sql += " OR college_education_details.graduation_year="+str(graduation_year_value[i])
                                        
                    if len(location) != 0 :
                        t = list(sql)
                        t.insert(52,",college_basic_profile_details")
                        sql = ''.join(t)
                        print(sql)
                        sql += " AND (college_basic_profile_details.current_location='"+str(location)+"')"
                                        
                        print("))))))))))))))))))))))))))))))",sql)
                                    
                            
                    
                    sql += " AND (college_spoc.spoc_id=college_education_details.spoc_id)" 
                                    
                    college_results = ""
                    try :
                        con.execute(sql)
                        res = con.fetchall()
                        # content2 = ''''''
                        print(res)
                        if len(res) == 0 :
                            college_results = "<br><p style='color:gray;text-align:center;'>No College SPOC Found.</p></br>"

                        else :
                            for i in res :
                                print(i)
                                
                                isImage = "NO"
                                try :
                                    user_id = int(i[0])
                                    sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(user_id))
                                    print(sql)
                                    con.execute(sql)
                                    res2 = con.fetchall()
                                    print(res2)
                                    if len(res2) == 1 :
                                        isGot = 1
                                        print("NOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")
                                    else :
                                        isGot = 0
                                except :
                                    isGot = 0
                                    print("Error In Getting Basic Profile Details.")
                            
                                print("value of isGot : ",isGot)
                            
                                college_results += '''
                               <figure class="snip1268">
                       
                                                 '''
                                
                                if isGot == 1 :
                                       
                           
                                    college_results += '''<div class="image"><img src="../../'''+str(res2[0][0])+'''" alt="sq-sample4" style="height: 300px;width:100%"/>
                                                      <a href="../../college/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                             
                                else :    
                                    print("Got It")                         
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                                    random_bg_color = color[0]
                                        
                                    p_i = "https://ui-avatars.com/api/?size=512&name="+str(i[2]).capitalize()+"+"+str(i[3]).capitalize()+"&background="+str(random_bg_color)+"&color=fff"
                                    
                                    college_results += '''<div class="image"><img src="'''+str(p_i)+'''" alt="sq-sample4" style="height: 200px;width:100%;"/>
                                                      <a href="../../college/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                                    
                                college_results += '''<figcaption>
                                                       
                                                      <h2 style="max-height:50px;font-size: 25px;">'''+str(i[2]).capitalize()+''' '''+str(i[3]).capitalize()+'''</h2>
                                                     
                                                      <table>
                                                       
                                                        
                                                       '''
                                                    
                            
                                college_results += ''' <tr>
                                                            <td style="border: none;background-color: white;">    
                                                                <i class="fas fa-university"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[19])+'''
                                                            </td>
                                                        </tr>
                                                        '''
                                                    
                                college_results +=  '''</table>
                                                    </figcaption>
                                                  </figure>
                    '''
            
                            # return jsonify(res=1,content=content,l_content=len(content))
                    except :
                        
                        print("Error In Getting Searched Data With College..")

                else :
                    print("No Search Query Found.")
                    pass
                
                #Alumni
                print("="*100)
                sql = ""
                if len(s_q) != 0 :
                    sql += "SELECT * FROM students WHERE (students.first_name LIKE '%"+str(s_q)+"%'"+" OR students.last_name LIKE '%"+str(s_q)+"%')"
                
                
                    if len(college_value) != 0 :
                        if len(college_value) == 1 :
                                sql += " AND (students.college='"+str(college_value[0])+"')"
                        else :    
                            for i in range(len(college_value)):
                                if i == 0 :
                                    sql += " AND (students.college='"+str(college_value[i])+"'"
                                else :
                                    if i == len(college_value)-1 :
                                        sql += " OR students.college='"+str(college_value[i])+"')"
                                    else :
                                        sql += " OR students.college='"+str(college_value[i])+"'"
                                
                                    
                    
                    if len(college_degree_value) != 0 :
                        if len(college_degree_value) == 1 :
                                sql += " AND (students.degree='"+str(college_degree_value[0])+"')"
                        else :    
                            for i in range(len(college_degree_value)):
                                if i == 0 :
                                    sql += " AND (students.degree='"+str(college_degree_value[i])+"'"
                                else :
                                    if i == len(college_degree_value)-1 :
                                        sql += " OR students.degree='"+str(college_degree_value[i])+"')"
                                    else :
                                        sql += " OR students.degree='"+str(college_degree_value[i])+"'"
                        
                            
                        
                    if len(starting_year_value) != 0 :
                        if len(starting_year_value) == 1 :
                                sql += " AND (students.entry_year="+str(starting_year_value[0])+")"
                        else :    
                            for i in range(len(starting_year_value)):
                                if i == 0 :
                                    sql += " AND (students.entry_year="+str(starting_year_value[i])
                                else :
                                    if i == len(starting_year_value)-1 :
                                        sql += " OR students.entry_year="+str(starting_year_value[i])+")"
                                    else :
                                        sql += " OR students.entry_year="+str(starting_year_value[i])
                    
                            
                    if len(graduation_year_value) != 0 :
                        if len(graduation_year_value) == 1 :
                                sql += " AND (students.passout_year="+str(graduation_year_value[0])+")"
                        else :    
                            for i in range(len(graduation_year_value)):
                                if i == 0 :
                                    sql += " AND (students.passout_year="+str(graduation_year_value[i])
                                else :
                                    if i == len(graduation_year_value)-1 :
                                        sql += " OR students.passout_year="+str(graduation_year_value[i])+")"
                                    else :
                                        sql += " OR students.passout_year="+str(graduation_year_value[i])
                                        
                    if len(location) != 0 :
                        t = list(sql)
                        t.insert(22,",alumni_basic_profile_details")
                        sql = ''.join(t)
                        sql += " AND (alumni_basic_profile_details.current_location='"+str(location)+"')"
                                        
                        print("))))))))))))))))))))))))))))))",sql)
                                    
                            
                    
                 
                    
                    
                    
                    # print(sql)
                    
                    alumni_results = ""
                    try :
                        con.execute(sql)
                        res = con.fetchall()
                        # content2 = ''''''
                        print(res)
                        if len(res) == 0 :
                            alumni_results = "<br><p style='color:gray;text-align:center;'>No Alumni Found.</p></br>"

                        else :
                            for i in res :
                                isImage = "NO"
                                try :
                                    user_id = int(i[0])
                                    sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(user_id))
                                    
                                    con.execute(sql)
                                    res2 = con.fetchall()
                                    print(res2)
                                    if len(res2) == 1 :
                                        isGot = 1
                                        print("NOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")
                                    else :
                                        isGot = 0
                                except :
                                    isGot = 0
                                    print("Error In Getting Basic Profile Details.")
                            
                                print("value of isGot : ",isGot)
                            
                                alumni_results += '''
                               <figure class="snip1268">
                       
                                                 '''
                                
                                if isGot == 1 :
                                       
                           
                                    alumni_results += '''<div class="image"><img src="../../'''+str(res2[0][0])+'''" alt="sq-sample4" style="height: 300px;width:100%;"/>
                                                      <a href="../../alumni/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                             
                                else :    
                                    print("Got It")                         
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                                    random_bg_color = color[0]
                                        
                                    p_i = "https://ui-avatars.com/api/?size=512&name="+str(i[1]).capitalize()+"+"+str(i[2]).capitalize()+"&background="+str(random_bg_color)+"&color=fff"
                                    
                                    alumni_results += '''<div class="image"><img src="'''+str(p_i)+'''" alt="sq-sample4" style="height: 200px;width:100%;"/>
                                                      <a href="../../association/profile/'''+str(i[0])+'''" class="add-to-cart">VIEW PROFILE</a>
                                                    </div>'''
                                                    
                                alumni_results += '''<figcaption>
                                                       
                                                      <h2 style="max-height:50px;font-size: 25px;">'''+str(i[1]).capitalize()+''' '''+str(i[2]).capitalize()+'''</h2>
                                                     
                                                      <table>
                                                       
                                                        
                                                       '''
                                                    
                            
                                alumni_results += ''' <tr>
                                                            <td style="border: none;background-color: white;">    
                                                                <i class="fas fa-university"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[7])+'''
                                                            </td>
                                                        </tr>
                                                       
                                                        <tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-user-graduate"></i>
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                '''+str(i[8])+'''
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border: none;background-color: white;">
                                                                <i class="fas fa-sign-in-alt"></i>
                                                                
                                                            </td>
                                                            <td style="border: none;background-color: white;text-align: left;">
                                                                    '''+str(i[10])+''' - '''+str(i[11])+'''
                                                            </td>
                                                           
                                                        </tr>
                                                        '''
                                                    
                                alumni_results +=  '''</table>
                                                    </figcaption>
                                                  </figure>
                    '''
            
                            # return jsonify(res=1,content=content,l_content=len(content))
                    except :
                        
                        print("Error In Getting Searched Data With College..")

                else :
                    print("No Search Query Found.")
                    pass
                
        
            # print(association_results)                
             
            return jsonify(res=1,content=content,l_content=len(content),alumni_results=alumni_results,college_results=college_results,association_results=association_results)
            
            
           
    
    college_list = []
    try :
        sql = "SELECT * FROM colleges"
        con.execute(sql)
        college_list = con.fetchall()
    except :
        print("Error In Getting College List : Association_Search.")
        
    years_list = []
    for i in range(1960,2021):
        years_list.append(i)
    
    years_list.reverse()
    
    college_degree_list = []
    try :
        sql = "SELECT * FROM college_degrees"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            if i[2] not in college_degree_list :
                college_degree_list.append(i[2])
            else :
                pass
    except :
        print("Error In Getting College Degree List : Association_Search.")
        
    con.close()
    return render_template("association_search.html",college_list=college_list,years_list=years_list,college_degree_list=college_degree_list)


@app.route('/association/view_colleges/')
def association_view_colleges():
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
        con = cnx.cursor()
        all_colleges = []
        l_all_entrepreneurs = 0
        temp_places = []
        places = []
        place_count = []
        l_places = 0
        dict_places = {}
        try :
            sql = "SELECT * FROM  colleges"
            con.execute(sql)
            res = con.fetchall()
            for i in res :
                all_colleges.append(i)
                if str(i[1]) not in temp_places :
                    temp_places.append(str(i[1]))
                    try :
                        sql = "SELECT * FROM college_spoc WHERE college_id=%d AND isEmailVerified='YES' AND isMobileVerified='YES'" % (int(i[0]))
                        con.execute(sql)
                        res = con.fetchall()
                        x = len(res)
                        
                        sql = "SELECT * FROM college_spoc WHERE college_id=%d AND account_status='ACTIVATED'" % (int(i[0]))
                        con.execute(sql)
                        res = con.fetchall()
                        y = len(res)
                        
                        sql = "SELECT * FROM college_spoc WHERE college_id=%d AND account_status='REJECTED'" % (int(i[0]))
                        con.execute(sql)
                        res = con.fetchall()
                        z = len(res)
                        
                        places.append([i[1],str(x),str(y),str(z)])
                    except :
                        pass
                else :
                    pass
                
            print(places)
        except :
            pass
        
    
        cnx.close()
        # return jsonify(o_details=o_details,p_details=p_details,b_details=b_details)
        return render_template('association_view_colleges.html',all_colleges=all_colleges,places=places)   

@app.route('/association/view_alumni/')
def association_view_alumni():
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
        con = cnx.cursor()
        all_students = []
        # l_all_entrepreneurs = 0
        temp_places = []
        places = []
        place_count = []
        l_places = 0
        dict_places = {}
        try :
            sql = "SELECT * FROM students"
            con.execute(sql)
            res = con.fetchall()
            for i in res :
                all_students.append(i)
                # print("exe")
                if str(i[7]) not in temp_places :
                    temp_places.append(str(i[7]))
                    try :
                        sql = "SELECT * FROM students WHERE id=%d AND isEmailVerified='YES' AND isMobileVerified='YES'" % (int(i[0]))
                        con.execute(sql)
                        res = con.fetchall()
                        x = len(res)
                        # print("exe2")
                        sql = "SELECT * FROM students WHERE id=%d AND account_status='ACTIVATED'" % (int(i[0]))
                        con.execute(sql)
                        res = con.fetchall()
                        y = len(res)
                        
                        sql = "SELECT * FROM students WHERE id=%d AND account_status='REJECTED'" % (int(i[0]))
                        con.execute(sql)
                        res = con.fetchall()
                        z = len(res)
                        
                        places.append([i[7],str(x),str(y),str(z)])
                    except :
                        pass
                else :
                    pass
            print("temp places : ",temp_places)
            print(places)
        except :
            pass
        
    
        cnx.close()
        # return jsonify(o_details=o_details,p_details=p_details,b_details=b_details)
        return render_template('association_view_alumni.html',all_students=all_students,places=places)   

@app.route('/association/create-event',methods=['GET','POST'])
def association_create_event():
   
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    if request.method == 'POST' : 
        accountActivated = session['association_account_activated']
        if accountActivated == 1 :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        else :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        # print(account_details)
        association_id = account_details[0]
        
        event_name = request.form['event-name']
        try :
            isTicketFree = request.form.getlist('isTicketFree')[0]
            if isTicketFree == "on" :
                isTicketFree = "YES"
            else :
                isTicketFree = "NO"
        except :
            isTicketFree = "NO"
        event_venue = request.form['event-venue']
        event_description = request.form['eventdescription']
        tickets_available = int(request.form['tickets-available'])
        ticket_price = int(request.form['ticket-price'])
        event_start_date_time = request.form['event-start-date-time']
        event_end_date_time = request.form['event-end-date-time']
        try:
            send_not_association = request.form.getlist('send_not_association')[0]
            if send_not_association == "on" :
                send_not_association = "YES"
            else :
                send_not_association = "NO"
        except :
            send_not_association = "NO"
        
        try :    
            send_not_colleges = request.form.getlist('send_not_colleges')[0]
            if send_not_colleges == "on" :
                send_not_colleges = "YES"
            else :
                send_not_colleges = "NO"
        except :
            send_not_colleges = "NO"
        try :
            send_not_alumni = request.form.getlist('send_not_alumni')[0]
            if send_not_alumni == "on" :
                send_not_alumni = "YES"
            else :
                send_not_alumni = "NO"
        except :
            send_not_alumni = "NO"
            
        now = datetime.now()
        time = now.strftime("%Y-%m-%d %H:%M:%S")
            
        session['c_event_name'] = request.form['event-name']
        session['c_event_venue'] = request.form['event-venue']
        session['c_tickets-available'] = request.form['tickets-available']
        session['c_ticket-price'] = request.form['ticket-price']
        session['c_event-start-date-time'] = request.form['event-start-date-time']
        session['c_event-end-date-time'] = request.form['event-end-date-time']
        session['c_event_description'] = request.form['eventdescription']
        session['s_not_association'] = send_not_association
        session['s_not_colleges'] = send_not_colleges
        session['s_not_alumni'] = send_not_alumni
            
            
        c_dirName = "static/uploads/events/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
      
        try :
            
            
            
            file = request.files['event-file']
            if file.filename == "" :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Select Event Poster / Image. </p>"))
                return redirect(url_for('association_create_event'))
            else :
           
            # p = path+secure_filename(file.filename)
                event_logo = "static/uploads/events/"+str(association_id)+"_"+str(uuid.uuid1())+file.filename
                file.save(event_logo)
            
            
        except :
            print("Error FIle Upload.")
        
          
        dt1 = event_start_date_time
        dt2 = event_end_date_time
        dt3 = datetime.now().replace(microsecond=0,second=0,hour=0,minute=0)
        
        print(dt1)
        print(type(dt1))
        
        new_dt1 = datetime(int(dt1[:4]),int(dt1[5:7]),int(dt1[8:10]))
        print(new_dt1)
        print(type(new_dt1))
        
        print(type(dt3))
        print(dt3)
        if dt1 <= dt2 :
            print("outer valid")
            if dt3 <  new_dt1 :
                print(time)
                print("dt3 : ",dt3)
            
                try :
                    sql = "INSERT INTO association_events(association_id,event_name,event_logo,event_description,event_venue,start_date_time,end_date_time,event_fee,event_tickets_to_sell,isBookingAllowed,isActive,last_modified_by,last_modified_time,send_notification_to_other_association_members,send_notification_to_colleges,send_notification_to_alumni,time) VALUES(%d,'%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s','%s','%s','%s','%s','%s')" % (int(association_id),str(event_name),event_logo,str(event_description),str(event_venue).replace("'",""),str(event_start_date_time),str(event_end_date_time),int(ticket_price),int(tickets_available),"YES","YES",association_id,time,send_not_association,send_not_colleges,send_not_alumni,time)
            
                    con.execute(sql)
                    cnx.commit()
                    flash(Markup("<p style='color:green;font-size:15px;'>Event Created Successfully.</p>"))
                    
                    session['c_event_name'] = ""
                    session['c_event_venue'] = ""
                    session['c_tickets-available'] = ""
                    session['c_ticket-price'] = ""
                    session['c_event-start-date-time'] = ""
                    session['c_event-end-date-time'] = ""
                    session['c_event_description'] = ""
                    session['s_not_association'] = ""
                    session['s_not_colleges'] = ""
                    session['s_not_alumni'] = ""
                    
                except :
                    flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting Event Record In Database.</p>"))
                    # print("ERrror INsert.")
                print("e_desc : ",event_description)
                print("isTicketFree : ",isTicketFree)
                print("send_not_ass : ",send_not_association)
                print("send_not_colleges : ",send_not_colleges)
                print("send_not_alumni : ",send_not_alumni)
                
                
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Valid Start Date.</p>"))
                # session['c_event_file'] = request.files['event-file']
                session['c_event_name'] = request.form['event-name']
                session['c_event_venue'] = request.form['event-venue']
                session['c_tickets-available'] = request.form['tickets-available']
                session['c_ticket-price'] = request.form['ticket-price']
                session['c_event-start-date-time'] = request.form['event-start-date-time']
                session['c_event-end-date-time'] = request.form['event-end-date-time']
                session['c_event_description'] = request.form['eventdescription']
                session['s_not_association'] = send_not_association
                session['s_not_colleges'] = send_not_colleges
                session['s_not_alumni'] = send_not_alumni
                # print("session['c_event_description']" ,session['c_event_description'])
                return redirect(url_for('association_create_event'))
        else :
            flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Valid Event Start & End Date-TIme.</p>"))
            session['c_event_name'] = request.form['event-name']
            session['c_event_venue'] = request.form['event-venue']
            session['c_tickets-available'] = request.form['tickets-available']
            session['c_ticket-price'] = request.form['ticket-price']
            session['c_event-start-date-time'] = request.form['event-start-date-time']
            session['c_event-end-date-time'] = request.form['event-end-date-time']
            session['c_event_description'] = request.form['eventdescription']
            session['s_not_association'] = send_not_association
            session['s_not_colleges'] = send_not_colleges
            session['s_not_alumni'] = send_not_alumni
            return redirect(url_for('association_create_event'))
        
        

          
        
    
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        accountActivated = session['association_account_activated']
        if accountActivated == 1 :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        else :
            email = session['association_login_email']
            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isMobileVerified='YES'" % (email)
            con.execute(sql)
            res = con.fetchall()
            account_details = res[0]
        # print(account_details)
        association_id = account_details[0]
        
        # flash("Welcome To Alumni Association OF Goa.","error")
        # flash(Markup("<p style='color:green;font-size:15px;'>Welcome To Alumni Association OF Goa.</p>"))
        return render_template("association_create_event.html",account_details=account_details)
    
    con.close()


@app.route("/association/fund-raising-projects/applications",methods=['GET','POST'])
def association_fund_raising_projects_applications():
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    applications = []
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
  
 
        
    if request.method=='GET':
        mode=request.args.get('mode')
        isUpdated = 0
        mail_sent = 0
        sms_sent = 0
        if mode == "1":
            project_id = int(request.args.get('project_id'))
            name = str(request.args.get('name'))
            email = str(request.args.get('email'))
            mobile_no = str(request.args.get('mobile_no')).replace(" ","")
            mobile_no = int(mobile_no)
            college = str(request.args.get('college'))
            sql = "UPDATE fund_raising_projects SET isVerifiedByAssociation='YES',verifiedByAssociationId=%d,status='ACTIVATED BY ASSOCIATION' WHERE id=%d" % (int(session['association_login_id']),project_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            
        if isUpdated == 1 :
            msg = Message('Fund Raising Project Application Approved By Alumni Association Of Goa', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                         <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_confirmed_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Congratulations <b>'''+name+'''</b> ! Your application for fund raising project has been accepted by <b>Alumni Association Of Goa</b>. </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''alumni/login" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>LOGIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>            
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Confirmation Mail.")
            
            if mail_sent == 1 :    
        
                final_mobile_no = str(mobile_no)
              
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Congratulations '+str(name)+' ! Your Application For Fund Raising Project has been approved by Alumni Association Of Goa.'
                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
            
                
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    
                    if sms_sent == 1 :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.")
                    else :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.\nBut Unable To Send Confirmation SMS.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is accepted successfully but unable to send confirmation email.")
            else :
                return jsonify(res=0,error="AcceptUpdateError",msg="Unable To Accept Application.")
        
        if mode == "2":
            project_id = int(request.args.get('project_id'))
            name = str(request.args.get('name'))
            email = str(request.args.get('email'))
            mobile_no = str(request.args.get('mobile_no')).replace(" ","")
            mobile_no = int(mobile_no)
            college = str(request.args.get('college'))
            sql = "UPDATE fund_raising_projects SET isVerifiedByAssociation='NO',verifiedByAssociationId=%d,status='REJECTED BY ASSOCIATION' WHERE id=%d" % (0,project_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
        if isUpdated == 1 :
            msg = Message('Fund Raising Project Application Rejected By Alumni Association Of Goa', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_rejected_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;text-align:left !important;word-wrap:break-word"><span style="font-size: 18px; color: #000000;;">
                                                      Thank you <b>'''+name+'''</b> for your fund raising project application at <b>Alumni Association Of Goa</b>. We really appreciate your interest in applying for fund raising project application at Alumni Association Of Goa.
                                                      <br><br>
                                                      <b>After carefully reviewing all of them, unfortunately, we have to inform you that this time we wont be able to accept your application of fund raising project at Alumni Association Of Goa.</b>But your application is accepted by your college. Still other members of '''+str(college)+''' can make a gift to this project. We hope youll keep us in mind and apply again in the future.

                                                      <br><br>If you have any questions or need additional information, please dont hesitate to contact us.
                                                      
We wish you every personal and professional success in your future endeavors.
                                                      
Once again, thank you for showing interest.

                                                      
                                                      </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''contact" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CONTACT US</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>                                     
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Rejection College Mail.")
                
            if mail_sent == 1 :    
              
            
                final_mobile_no = str(mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Unfortunately, Fund Raising Project Application for '+str(name)+' has been rejected at Alumni Association Of Goa. But you can still get gifts from other members of your college. Better Luck Next Time.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
                
            
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    return jsonify(res=1,error="No",msg="Application Is Rejected Successfully.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is rejected successfully but unable to send rejection email.")
            
            else :
                return jsonify(res=0,error="RejectUpdateError",msg="Unable To Reject Application.")
            
            
            
    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
    con.execute(sql)
    res = con.fetchall()
    account_details = res[0]
     
        
    sql = "SELECT * FROM fund_raising_projects WHERE isVerifiedByCollege='YES' AND status='ACTIVATED BY COLLEGE'"
    con.execute(sql)
    res = con.fetchall()
    for i in res :
        applications.append(list(i))

        
    for i in range(len(applications)) :
        if applications[i][1] == "ALUMNI" : 
        
            sql = "SELECT * FROM students WHERE id=%d" % (int(applications[i][2]))
            con.execute(sql)
            res = con.fetchall()
            nam = str(res[0][1]).capitalize() + " " + str(res[0][2]).capitalize()
            applications[i].append(str(nam))
            applications[i].append(str(res[0][3]))
            m_n = str(res[0][4]) + " " + str(res[0][5])
            applications[i].append(str(m_n))
            
        if applications[i][1] == "COLLEGE SPOC" : 
        
            sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(applications[i][2]))
            con.execute(sql)
            res = con.fetchall()
            nam = str(res[0][2]).capitalize() + " " + str(res[0][3]).capitalize()
            applications[i].append(str(nam))
            applications[i].append(str(res[0][4]))
            m_n = str(res[0][5]) + " " + str(res[0][6])
            applications[i].append(str(m_n))

  
    print(applications)
    con.close()
    return render_template('association_college_alumni_fund_raising_projects_applications.html',applications=applications,account_details=account_details,total_applications=len(applications))



@app.route('/association/special_interest_groups/',methods=['GET','POST'])
def association_special_interest_groups():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()  
    isPosterSaved = 0
    
    if request.method == "POST" :
        
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")
        
        # http://localhost:5000/association/poll?poll_title=How+Are+You+%3F&option_1=I+am+Fine.&option_2=Fine.&option_3=Very+Fine.&option_4=Good&total_options=4
        group_title = str(request.form['group_title'])
        group_description = str(request.form['group_description'])
        
        session['association_group_title'] = group_title
        session['association_group_description'] = group_description
        
        c_dirName = "static/uploads/association_speical_interest_groups/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
      
        try :
            
            file = request.files['group-poster']
            # print(file.filename)
            # for file in files :
                # print(file.filename)
            poster_path = "static/uploads/association_speical_interest_groups/"+str(uuid.uuid1())+file.filename
            file.save(poster_path)
            
            print("Association Special Interest Group Poster Saved.")
            isPosterSaved = 1
    
        except :
            isPosterSaved = 0
            print("Error In Saving Association Special Interest Group Poster.")
            
       
            
        if isPosterSaved == 1:
            
            try :
                    sql = "INSERT INTO association_special_interest_groups(association_id,group_title,group_description,poster_image,date_time) VALUES(%d,'%s','%s','%s','%s')" % (int(session['association_login_id']),group_title,group_description,str(poster_path),str(d_t))
                    con.execute(sql)
                    cnx.commit()
                    print("Association Special Interest Groups Saved.")
                    
                    session['association_group_title'] = ""
                    session['association_group_description'] = ""
                    
                    flash(Markup("<p style='color:green;font-size:15px;'>Special Interest Group Added Successfully.</p>"))
                    return redirect(url_for('association_special_interest_groups'))
            except :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting Special Interest Group In Database.</p>"))
                return redirect(url_for('association_special_interest_groups'))
         
    if request.method == "GET" :
        mode = request.args.get('mode')    
        
        if mode == "1" :
            group_id = int(request.args.get('group_id'))
            
            try :
                sql = "DELETE FROM association_special_interest_groups_comments WHERE group_id=%d" % (group_id)
                con.execute(sql)
                cnx.commit()
            except :
                return jsonify(res=0,msg="Error In Deleting Comments.")
            
            try :
                sql = "DELETE FROM association_special_interest_groups WHERE id=%d" % (group_id)
                con.execute(sql)
                cnx.commit()
                flash(Markup("<p style='color:green;font-size:15px;'>Special Interest Group Is Deleted Successfully.</p>"))
                return jsonify(res=1,msg="Special Interest Group Is Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Comments.")

    my_sig = []
    all_sig = []

    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        try :
            sql = "SELECT * FROM association_special_interest_groups WHERE association_id=%d" % (int(session['association_login_id']))
            con.execute(sql)
            res = con.fetchall()
            for i in range(len(res)) :
                group_id = int(res[i][0])
                total_members = 0
                my_sig.append(list(res[i]))
                # print(my_sig)
                try :
                    sql = "SELECT * FROM association_special_interest_groups_members WHERE group_id = %d" % (group_id)
                    con.execute(sql)
                    res2 = con.fetchall()
                    print(res2)
                    total_members = len(res2)
                except : 
                    pass
                
                my_sig[i].append(total_members)
                
            
        except :
            print("Association Error In Getting Special Interest Groups.")
            
            
            
        try :
            sql = "SELECT * FROM association_special_interest_groups"
            con.execute(sql)
            res = con.fetchall()
            for i in range(len(res)) :
                group_id = int(res[i][0])
                total_members = 0
                all_sig.append(list(res[i]))
                # print(my_sig)
                try :
                    sql = "SELECT * FROM association_special_interest_groups_members WHERE group_id = %d" % (group_id)
                    con.execute(sql)
                    res2 = con.fetchall()
                    print(res2)
                    total_members = len(res2)
                except : 
                    pass
                
                all_sig[i].append(total_members)
                
            
        except :
            print("Association Error In Getting All Special Interest Groups.")
            
            
        # print(my_sig)
        con.close()
        return render_template("association_special_interest_groups.html",my_sig=my_sig,l_my_sig=len(my_sig),all_sig=all_sig,l_all_sig=len(all_sig))  
         
   
@app.route('/association/sig/view/<int:group_id>',methods=['GET','POST'])
def association_view_sig(group_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    
    if request.method == "POST" :
        
        
        mode = int(request.form['mode'])
        
        now = datetime.now()
        date_time = now.strftime("%Y-%m-%d %H:%M:%S")
        
        if mode == 1 :
            group_id = int(request.form['group_id'])
            comment = str(request.form['comment'])
            
            if len(comment) == 0 :
                return jsonify(res=0,msg="Please Enter Comment.")
            else :
                
                if 'association_login_id' in session :
                    user_id = int(session['association_login_id'])
                    membership_type = "ASSOCIATION MEMBER"
                
                if 'alumni_login_id' in session :
                    user_id = int(session['alumni_login_id'])
                    membership_type = "ALUMNI"
                
                try :
                    sql = "INSERT INTO association_special_interest_groups_comments(group_id,user_id,membership_type,comment,date_time) VALUES(%d,%d,'%s','%s','%s')" % (int(group_id),user_id,membership_type,str(comment),str(date_time))
                    con.execute(sql)
                    cnx.commit()
                    
                    
                    response = ''''''

                   
                    try :
                        sql = "SELECT * FROM association_special_interest_groups_comments WHERE group_id=%d ORDER BY date_time DESC" % (group_id) 
                        con.execute(sql)
                        res = con.fetchall()
                        print("Total Comments : ",len(res))
                        for i in res :
                            
                            
                            
                            user_id = int(i[2])
                            comment_time = str(i[5])
                            membership_type = str(i[3])
                            comment = str(i[4])
                            comment_id = str(i[0])
                            
                            if membership_type == "ASSOCIATION MEMBER" :
                                
                                sql = "SELECT * FROM association WHERE association_id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                                
                            
                            if membership_type == "ALUMNI" : 
                                
                                sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                        
                        
                        
                            print("f_name :",f_name)
                            print("l_name : ",l_name) 
                        
                            response += '''
                                                    <div class="outer-comment">'''
                            
                            
                                                    
                            if  membership_type == "ASSOCIATION MEMBER" and user_id == int(session['association_login_id']):
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                                
                                         
                            
                            if  membership_type == "ALUMNI" and user_id == int(session['alumni_login_id']):
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                            
                                                
                                                
                            response += ''' <div class="comment">
                                                    <div>
                                                    <img src="'''+profile_url+'''" class="profile-img" alt="">
                                                    </div>
                                                    <div class="user-time">
                                                        <div class="user">'''+f_name+''' '''+l_name+'''<br><br><span class="time">
                                                        <time class="timeago" datetime="'''+comment_time+'''">'''+comment_time+'''</time></span></div>
                                                        
                                                    </div>
                                                </div>
                                                <div class="userComment">'''+comment+'''</div>
                                                
                                            </div>
                                                                    '''       
                                        
                        print(response)    
                        return jsonify(res=1,msg="Comment Added Successfully.",resp=response,total_comments=len(res))
                    except:
                        return jsonify(res=0,msg="SIG : Unable To Get Comments.")
                    
                    
                    
                except :
                    return jsonify(res=0,msg="Unable To Insert, Please Check Your Inputs.")
                
        
        if mode == 2 :
            comment_id = int(request.form['comment_id'])
            
            if comment_id == 0 :
                return jsonify(res=0,msg="No Comments Found.")
            else :
                
                print("comment id : ",comment_id)
                
                try :
                    sql = "DELETE FROM association_special_interest_groups_comments WHERE id=%d" % (int(comment_id))
                    con.execute(sql)
                    cnx.commit()
                    
                    
                    response = ''''''

                   
                    try :
                        sql = "SELECT * FROM association_special_interest_groups_comments WHERE group_id=%d ORDER BY date_time DESC" % (group_id) 
                        con.execute(sql)
                        res = con.fetchall()
                        print("Total Comments : ",len(res))
                        for i in res :
                            
                            
                            
                            user_id = int(i[2])
                            comment_time = str(i[5])
                            membership_type = str(i[3])
                            comment = str(i[4])
                            comment_id = str(i[0])
                            
                            if membership_type == "ASSOCIATION MEMBER" :
                                
                                sql = "SELECT * FROM association WHERE association_id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                                
                                
                        
                            
                            if membership_type == "ALUMNI" : 
                                
                                sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                        
                        
                        
                            print("f_name :",f_name)
                            print("l_name : ",l_name) 
                        
                            response += '''
                                                    <div class="outer-comment">'''
                            
                            
                                                    
                            if  membership_type == "ASSOCIATION MEMBER" and user_id == int(session['association_login_id']):
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                             
                            
                            if  membership_type == "ALUMNI" and user_id == int(session['alumni_login_id']):
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                            
                                                
                                                
                            response += ''' <div class="comment">
                                                    <div>
                                                    <img src="'''+profile_url+'''" class="profile-img" alt="">
                                                    </div>
                                                    <div class="user-time">
                                                        <div class="user">'''+f_name+''' '''+l_name+'''<br><br><span class="time">
                                                        <time class="timeago" datetime="'''+comment_time+'''">'''+comment_time+'''</time></span></div>
                                                        
                                                    </div>
                                                </div>
                                                <div class="userComment">'''+comment+'''</div>
                                                
                                            </div>
                                                                    '''       
                                        
                        print(response)    
                        return jsonify(res=1,msg="Comment Removed Successfully.",resp=response,total_comments=len(res))
                    except:
                        return jsonify(res=0,msg="SIG : Unable To Delete / Fetch Comments.")
                    
                    
                    
                except :
                    return jsonify(res=0,msg="SIG : Unable To Reomve Comment.")
                
                      
                
                
        
    sig_details = []
    try :
        sql = "SELECT * FROM association_special_interest_groups WHERE id=%d" % (group_id)
        con.execute(sql)
        sig_details = con.fetchall()
    except :
        pass
        
    sig_comments_details = []
        
    try :
        sql = "SELECT * FROM association_special_interest_groups_comments WHERE group_id=%d" % (group_id)
        con.execute(sql)
        sig_comments_details = con.fetchall()
    except :
        pass
    
    response = ''''''
            
    
    
    try :
        sql = "SELECT * FROM association_special_interest_groups_comments WHERE group_id=%d ORDER BY date_time DESC" % (group_id) 
        con.execute(sql)
        res = con.fetchall()
        print("Total SIG Comments : ",len(res))
        for i in res :
            
            
            
            user_id = int(i[2])
            comment_time = str(i[5])
            membership_type = str(i[3])
            comment = str(i[4])
            comment_id = str(i[0])
            
            if membership_type == "ASSOCIATION MEMBER" :
                
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(user_id))
                con.execute(sql)
                res2 =  con.fetchall()
                
                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                f_name = str(res2[0][1]).capitalize()
                l_name = str(res2[0][2]).capitalize()
                
            
            if membership_type == "ALUMNI" : 
                
                sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
                con.execute(sql)
                res2 =  con.fetchall()
                
                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                f_name = str(res2[0][1]).capitalize()
                l_name = str(res2[0][2]).capitalize()
           
           
           
            print("f_name :",f_name)
            print("l_name : ",l_name) 
           
            response += '''
                                    <div class="outer-comment">'''
            
            
                                    
            if  membership_type == "ASSOCIATION MEMBER" and user_id == int(session['association_login_id']):
                                  
                response += '''<p class="read-more" style="width:100%;">
                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                   </p>'''
                                                       
            
            if  membership_type == "ALUMNI" and user_id == int(session['alumni_login_id']):
                                  
                response += '''<p class="read-more" style="width:100%;">
                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                   </p>'''
            
                                   
                                   
            response += ''' <div class="comment">
                                    <div>
                                      <img src="'''+profile_url+'''" class="profile-img" alt="">
                                    </div>
                                    <div class="user-time">
                                          <div class="user">'''+f_name+''' '''+l_name+'''<br><br><span class="time">
                                          <time class="timeago" datetime="'''+comment_time+'''">'''+comment_time+'''</time></span></div>
                                          
                                    </div>
                                  </div>
                                  <div class="userComment">'''+comment+'''</div>
                                  
                              </div>
                                                    '''
         
            
            
                        
        # print(response)    
          
    except:
        pass
    
    
    
        
        
    # print(response)
        
    con.close()
    # print(discussion_comments_details)
    return render_template("association_view_special_interest_groups.html",sig_details=sig_details,l_sig_details=len(sig_details),sig_comments_details=sig_comments_details,l_sig_comments_details=len(sig_comments_details),all_comments=response)
        

@app.route('/association/inquiry/',methods=['GET','POST'])
def association_inquiry():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 1 :
            inquiry_id = int(request.form['inquiry_id'])
            
            try :
                sql = "DELETE FROM association_inquiry WHERE id=%d" % (inquiry_id)
                con.execute(sql)
                cnx.commit()
                flash(Markup("<p style='color:green;font-size:15px;'>Inquiry Is Deleted Successfully.</p>"))
                return jsonify(res=1,msg="Inquiry Is Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Inquiry.")
            


    unsolved_association_inquiries = []
    
    try :
        sql = "SELECT * FROM association_inquiry WHERE isResponsed='NO'"
        con.execute(sql)
        unsolved_association_inquiries = con.fetchall()
    except :
        print("Association : Error In Getting Unsolved Association Inquiries.")
    
    all_association_inquiries = []
    
    try :
        sql = "SELECT * FROM association_inquiry"
        con.execute(sql)
        all_association_inquiries = con.fetchall()
    except :
        print("Association : Error In Getting All Association Inquiries.")
    
    
    # print(unsolved_association_inquiries)
    
    con.close() 
    return render_template('association_inquiry.html',unsolved_association_inquiries=unsolved_association_inquiries,l_unsolved_association_inquiries=len(unsolved_association_inquiries),all_association_inquiries=all_association_inquiries,l_all_association_inquiries=len(all_association_inquiries))



@app.route('/association/blog/new',methods=['GET','POST'])
def association_create_blog_post():
    # print(session['association_login_id'])
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        post_title = request.form['post_title']
        post_desc = request.form['post_desc']
        post_tags = request.form['post_tag_value'][1:]
        post_categories = request.form['post_category_value']
        post_views = 0
        file_uploaded = 0
        now = datetime.now()
        time = now.strftime("%Y-%m-%d %H:%M:%S")
        print(post_tags)
        print(post_categories)

        c_dirName = "static/uploads/blog_posts/"

        try :
            os.mkdir(c_dirName)
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        try :
            file = request.files['event-file']
            if file.filename == "" :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Select Post Featured Image. </p>"))
                return redirect(url_for('association_create_blog_post'))
            else :
           
            # p = path+secure_filename(file.filename)
                blog_image = "static/uploads/blog_posts/association_"+str(session['association_login_id'])+"_"+str(uuid.uuid1())+file.filename
                file.save(blog_image)
                print("File Saved !")
                file_uploaded = 1
                
                if file_uploaded == 1 :
                    try :
                        print(str(session['association_login_id']),str(blog_image),str(post_title),str(post_desc),str(post_tags),str(post_categories),int(post_views),str(time))
                        sql = "INSERT INTO `blog_post_association`(`association_id`, `post_image`, `post_title`, `post_description`, `tags`, `category`, `total_views`, `date_time`) VALUES (%d,'%s','%s','%s','%s','%s',%d,'%s')" % (int(session['association_login_id']),str(blog_image),str(post_title),str(post_desc),str(post_tags),str(post_categories),int(post_views),str(time))
                        print(sql)
                        con.execute(sql)
                        cnx.commit()
                        flash(Markup("<p style='color:green;font-size:15px;'>Blog Post Created Successfully.</p>"))
                        return redirect(url_for('association_create_blog_post'))
                    except :
                        flash(Markup("<p style='color:red;font-size:15px;'>Error In Creating Blog Post.</p>"))
                        return redirect(url_for('association_create_blog_post'))  
                
                else :
                    flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading Featured Image.</p>"))
                    return redirect(url_for('association_create_blog_post'))
        
            
        except :
            print("Error FIle Upload.")
        
        
            
        # print(post_title)
    
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        
        
        con.close()
        return render_template("association_create_blog_post.html")
  
@app.route('/association/news',methods=['GET','POST'])
def association_news():
    # print(session['association_login_id'])
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        news_title = request.form['news_title']
        news_desc = request.form['news_desc']
        news_categories = request.form['post_category_value']
        if len(news_categories) == 0 :
            news_categories = "All"
        post_views = 0
        file_uploaded = 0
        now = datetime.now()
        time = now.strftime("%Y-%m-%d %H:%M:%S")
        print(news_categories)


        session['association_news_title'] = news_title
        session['association_news_description'] = news_desc

        c_dirName = "static/uploads/news/"

        try :
            os.mkdir(c_dirName)
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        try :
            file = request.files['news-file']
            if file.filename == "" :
                flash(Markup("<p style='color:red;font-size:15px;'>Please Select Post Featured Image. </p>"))
                return redirect(url_for('association_news'))
            else :
           
            # p = path+secure_filename(file.filename)
                news_image = "static/uploads/news/association_"+str(session['association_login_id'])+"_"+str(uuid.uuid1())+file.filename
                file.save(news_image)
                print("File Saved !")
                file_uploaded = 1
                
                if file_uploaded == 1 :
                    try :
                        sql = "INSERT INTO `association_news`(`association_id`, `news_title`, `news_image`, `news_description`, `news_categories`, `total_views`, `date_time`) VALUES (%d,'%s','%s','%s','%s',%d,'%s')" % (int(session['association_login_id']),str(news_title),str(news_image),str(news_desc),str(news_categories),int(post_views),str(time))
                        print(sql)
                        con.execute(sql)
                        cnx.commit()
                        
                        session['association_news_title'] = ""
                        session['association_news_description'] = ""
                        
                        flash(Markup("<p style='color:green;font-size:15px;'>News Added Successfully.</p>"))
                        return redirect(url_for('association_news'))
                    except :
                        flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding News.</p>"))
                        return redirect(url_for('association_news'))  
                
                else :
                    flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading News Featured Image.</p>"))
                    return redirect(url_for('association_news'))
        
            
        except :
            print("Error FIle Upload.")
        
        
            
        # print(post_title)
    
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        
        
        con.close()
        return render_template("association_news.html")
 
    
@app.route('/association/poll',methods=['GET','POST'])
def association_poll():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()  
    options = []
    if request.method == "POST" :
        # http://localhost:5000/association/poll?poll_title=How+Are+You+%3F&option_1=I+am+Fine.&option_2=Fine.&option_3=Very+Fine.&option_4=Good&total_options=4
        total_options = int(request.form['total_options'])
        poll_question = request.form['poll_title']
        if total_options < 2 :
            session['association_poll_question'] = poll_question
            flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Minimum Two Options</p>"))
            return redirect(url_for('association_poll'))
        else :
            
            for i in range(total_options) :
                x = 'option_'+str(i+1)
                v = request.form[x]
                options.append(str(v))
                
            poll_response_table = "association_poll_response_"+str(uuid.uuid1()).replace("-","")
            isTableCreated = 0
            try :
               
                sql = "CREATE TABLE "+str(poll_response_table)+" (id INT(20) UNSIGNED AUTO_INCREMENT PRIMARY KEY,membership_type VARCHAR(30) NOT NULL,profile_id INT NOT NULL,voted_option INT NOT NULL,date_time TIMESTAMP)"
                con.execute(sql)
                cnx.commit()
                print("Poll Response Table Created For Options.")
                isTableCreated = 1
            except :
                # cnx.rollback()
                print("Association : Unable To Create Poll Response Table.")

            now = datetime.now()
            date_time = now.strftime("%Y-%m-%d %H:%M:%S")
            isPollInserted = 0
            if isTableCreated == 1 :
                if total_options == 2 :
                    sql = "INSERT INTO association_poll_details(association_id,poll_table_name,poll_question,option_1,option_2,total_votes_for_option_1,total_votes_for_option_2,total_options,date_time) VALUES (%d,'%s','%s','%s','%s',%d,%d,%d,'%s')" % (int(session['association_login_id']),str(poll_response_table),str(poll_question),str(options[0]),str(options[1]),0,0,total_options,str(date_time))
                    con.execute(sql)
                    cnx.commit()
                    print("Inserted For 2 Options.")
                    isPollInserted = 1
                    
                if total_options == 3 :
                    sql = "INSERT INTO association_poll_details(association_id,poll_table_name,poll_question,option_1,option_2,option_3,total_votes_for_option_1,total_votes_for_option_2,total_votes_for_option_3,total_options,date_time) VALUES (%d,'%s','%s','%s','%s','%s',%d,%d,%d,%d,'%s')" % (int(session['association_login_id']),str(poll_response_table),str(poll_question),str(options[0]),str(options[1]),str(options[2]),0,0,0,total_options,str(date_time))
                    con.execute(sql)
                    cnx.commit()
                    print("Inserted For 3 Options.")
                    isPollInserted = 1
                    
                if total_options == 4 :
                    sql = "INSERT INTO association_poll_details(association_id,poll_table_name,poll_question,option_1,option_2,option_3,option_4,total_votes_for_option_1,total_votes_for_option_2,total_votes_for_option_3,total_votes_for_option_4,total_options,date_time) VALUES (%d,'%s','%s','%s','%s','%s','%s',%d,%d,%d,%d,%d,'%s')" % (int(session['association_login_id']),str(poll_response_table),str(poll_question),str(options[0]),str(options[1]),str(options[2]),str(options[3]),0,0,0,0,total_options,str(date_time))
                    con.execute(sql)
                    cnx.commit()
                    print("Inserted For 4 Options.")
                    isPollInserted = 1
                    
                if isPollInserted == 1 :
                    session['association_poll_question'] = ''
                    flash(Markup("<p style='color:green;font-size:15px;'>Poll Created Successfully.</p>"))
                    return redirect(url_for('association_poll'))
                else :
                    flash(Markup("<p style='color:red;font-size:15px;'>Unable To Create Poll.</p>"))
                    return redirect(url_for('association_poll'))
                    
                    
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Unable To Create Poll Response Table.</p>"))
                return redirect(url_for('association_poll'))
                
           
    if request.method == "GET" :
        mode = str(request.args.get('mode'))
        if mode == "1" :
            poll_id = request.args.get('poll_id')
            print(poll_id)
            try :
                sql = "SELECT * FROM association_poll_details WHERE id=%d"  % (int(poll_id))
                con.execute(sql)
                res = con.fetchall()
                
                print(res)
                
                if int(res[0][12]) == 4 :
                    poll_1_per,poll_2_per,poll_3_per,poll_4_per = "0","0","0","0"
                    total_votes = int(res[0][8])+int(res[0][9])+int(res[0][10])+int(res[0][11])
                    if total_votes != 0 :
                        try :
                            poll_1_per = (int(res[0][8]*100)) / total_votes
                            poll_1_per = round(poll_1_per)
                        except :
                            pass
                        
                        try :
                            poll_2_per = (int(res[0][9]*100)) / total_votes
                            poll_2_per = round(poll_2_per)
                        except :
                            pass
                        
                        try :
                            poll_3_per = (int(res[0][10]*100)) / total_votes
                            poll_3_per = round(poll_3_per)
                        except :
                            pass
                        
                        try :
                            poll_4_per = (int(res[0][11]*100)) / total_votes
                            poll_4_per = round(poll_4_per)
                        except :
                            pass
                    
                    print(poll_1_per)
                    print(poll_2_per)
                    print(poll_3_per)
                    print(poll_4_per)
       
                    
                   
                    
                    
                    print(total_votes)
                    cont = '''
                    <section><h1>
                    '''+str(res[0][3])+''' </h1>
                    '''
                    options = [str(res[0][4]),str(res[0][5]),str(res[0][6]),str(res[0][7])]
                    votes = [int(res[0][8]),int(res[0][9]),int(res[0][10]),int(res[0][11])]
                             
                    percentage = [str(poll_1_per),str(poll_2_per),str(poll_3_per),str(poll_4_per)]
                    
                    for i in range(len(options)):
                        
                        cont += '''   <div class="poll-option">
                                            <span class="poll-option__label" style='float:left;'>'''+str(options[i])+'''</span>
                                            <table class="poll-option__result">
                                            <tr>
                                                <td class='option_votes votes_count'>'''+str(votes[i])+'''</td>
                                                <td>
                                                <span></span>
                                                <span style="width: '''+str(percentage[i])+'''%;"></span>
                                                </td>
                                                <td class='option_votes'>'''+str(percentage[i])+'''%</td>
                                            </tr>
                                            </table>
                                        </div>
                        '''                    
                   
                    
                    cont += '''
                    </section>

                    '''
                
                if int(res[0][12]) == 3 :
                    poll_1_per,poll_2_per,poll_3_per = "0","0","0"
                    total_votes = int(res[0][8])+int(res[0][9])+int(res[0][10])
                    if total_votes != 0 :
                        try :
                            poll_1_per = (int(res[0][8]*100)) / total_votes
                            poll_1_per = round(poll_1_per)
                        except :
                            pass
                        
                        try :
                            poll_2_per = (int(res[0][9]*100)) / total_votes
                            poll_2_per = round(poll_2_per)
                        except :
                            pass
                        
                        try :
                            poll_3_per = (int(res[0][10]*100)) / total_votes
                            poll_3_per = round(poll_3_per)
                        except :
                            pass
                        
                        
                    
                    print(poll_1_per)
                    print(poll_2_per)
                    print(poll_3_per)
                    
                    
                    print(total_votes)
                    cont = '''
                    <section><h1>
                    '''+str(res[0][3])+''' </h1>
                    '''
                    options = [str(res[0][4]),str(res[0][5]),str(res[0][6])]
                    votes = [int(res[0][8]),int(res[0][9]),int(res[0][10])]
                             
                    percentage = [str(poll_1_per),str(poll_2_per),str(poll_3_per)]
                    
                    for i in range(len(options)):
                        
                        cont += '''   <div class="poll-option">
                                            <span class="poll-option__label" style='float:left;'>'''+str(options[i])+'''</span>
                                            <table class="poll-option__result">
                                            <tr>
                                                <td class='option_votes votes_count'>'''+str(votes[i])+'''</td>
                                                <td>
                                                <span></span>
                                                <span style="width: '''+str(percentage[i])+'''%;"></span>
                                                </td>
                                                <td class='option_votes'>'''+str(percentage[i])+'''%</td>
                                            </tr>
                                            </table>
                                        </div>
                        '''                    
                   
                    
                    cont += '''
                    </section>

                    '''
                      
                if int(res[0][12]) == 2 :
                    poll_1_per,poll_2_per = "0","0"
                    total_votes = int(res[0][8])+int(res[0][9])
                    if total_votes != 0 :
                        try :
                            poll_1_per = (int(res[0][8]*100)) / total_votes
                            poll_1_per = round(poll_1_per)
                        except :
                            pass
                        
                        try :
                            poll_2_per = (int(res[0][9]*100)) / total_votes
                            poll_2_per = round(poll_2_per)
                        except :
                            pass
                    
                    print(poll_1_per)
                    print(poll_2_per)
                    
                    print(total_votes)
                    cont = '''
                    <section><h1>
                    '''+str(res[0][3])+''' </h1>
                    '''
                    options = [str(res[0][4]),str(res[0][5])]
                    votes = [int(res[0][8]),int(res[0][9])]
                             
                    percentage = [str(poll_1_per),str(poll_2_per)]
                    
                    for i in range(len(options)):
                        
                        cont += '''   <div class="poll-option">
                                            <span class="poll-option__label" style='float:left;'>'''+str(options[i])+'''</span>
                                            <table class="poll-option__result">
                                            <tr>
                                                <td class='option_votes votes_count'>'''+str(votes[i])+'''</td>
                                                <td>
                                                <span></span>
                                                <span style="width: '''+str(percentage[i])+'''%;"></span>
                                                </td>
                                                <td class='option_votes'>'''+str(percentage[i])+'''%</td>
                                            </tr>
                                            </table>
                                        </div>
                        '''                    
                   
                    
                    cont += '''
                    </section>

                    '''
                      
                
                # print(cont)
                print("Association : Poll Response Fetched ")

                return jsonify(res=1,msg=cont)
            except :
                print("Association : Unable To Fetch Poll Details ")
                return jsonify(res=0,msg="Unable To Get Poll Statistics.")
            
                
        if mode == "2" :
            poll_id = request.args.get('poll_id')
            print(poll_id)
            try :
                sql = "SELECT * FROM association_poll_details WHERE id=%d"  % (int(poll_id))
                con.execute(sql)
                res = con.fetchall()
                db_table = str(res[0][2])
                
                sql = "DROP TABLE "+db_table
                con.execute(sql)
                cnx.commit()
                print("Association : Poll Response Table Deleted ",db_table)
            except :
                print("Association : Unable To Delete Poll Response Table ",db_table)
                return jsonify(res=0,msg="Unable To Delete Poll Response")
            
            try :
                sql = "DELETE FROM association_poll_details WHERE id=%d"  % (int(poll_id))
                con.execute(sql)
                cnx.commit()
                print("Association : Poll Record Deleted Successfully.")
                return jsonify(res=1,msg="Poll Deleted Successfully.")
            except :
                print("Association : Unable To Delete Poll From Table ",db_table)
                return jsonify(res=0,msg="Unable To Delete Poll.")
                
            
            
                    
            
    all_polls = []
    my_polls = []  
    
    try :
        sql = "SELECT * FROM association_poll_details WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            my_polls.append(i)
    except :
        
        pass
    
    try :
        sql = "SELECT * FROM association_poll_details"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            all_polls.append(i)
    except :
        pass   

    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        
        con.close()
        return render_template("association_poll.html",l_my_polls=len(my_polls),my_polls=my_polls,l_all_polls=len(all_polls),all_polls=all_polls)  


@app.route('/association/discussion',methods=['GET','POST'])
def association_discussion():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    if request.method == "POST" :
        discussion_title = request.form['discussion_content']
        post_tags = ""
        
        try :
            post_tags = request.form['post_tag_value'][1:]
        except :
            pass
        
        print(discussion_title)
        print(post_tags)
        
        if len(discussion_title) == 0 :
            flash(Markup("<p style='color:red;font-size:15px;'>Please Enter Discussion Topic/Question.</p>"))
            return redirect(url_for('association_discussion'))
        session['association_discussion_topic'] = discussion_title
        
        now = datetime.now()
        date_time = now.strftime("%Y-%m-%d %H:%M:%S")
        
        try :
            
            sql = "INSERT INTO association_discussion(association_id,discussion_title,tags,total_views,date_time) VALUES(%d,'%s','%s',%d,'%s')" % (int(session['association_login_id']),str(discussion_title),str(post_tags),0,str(date_time))
            con.execute(sql)
            cnx.commit()
            print("Association : Discussion Post Created Successfully.")
            session['association_discussion_topic'] = ""
            flash(Markup("<p style='color:green;font-size:15px;'>Discussion Post Created Successfully.</p>"))
            return redirect(url_for('association_discussion'))
        except :
            print("Association : Error In Inserting In Discussion Forum.")
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Creating Post In Discussion Forum.</p>"))
            return redirect(url_for('association_discussion'))
    
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        
        my_discussions = []
        all_discussions = []
        try :
            sql = "SELECT * FROM association_discussion WHERE association_id=%d ORDER BY date_time DESC" % (int(session['association_login_id']))
            con.execute(sql)
            my_discussions = con.fetchall()
        except :
            pass
        
        try :
            sql = "SELECT * FROM association_discussion ORDER BY date_time DESC"
            con.execute(sql)
            all_discussions = con.fetchall()
        except :
            pass
        
        con.close()
        return render_template("association_discussion.html",my_discussions=my_discussions,l_my_discussions=len(my_discussions),all_discussions=all_discussions,l_all_discussions=len(all_discussions))
    
@app.route('/association/discussion/view/<int:discussion_id>',methods=['GET','POST'])
def association_view_discussion(discussion_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
    
    if request.method == "POST" :
        
        
        mode = int(request.form['mode'])
        
        now = datetime.now()
        date_time = now.strftime("%Y-%m-%d %H:%M:%S")
        
        if mode == 1 :
            post_id = int(request.form['post_id'])
            comment = str(request.form['comment'])
            
            if len(comment) == 0 :
                return jsonify(res=0,msg="Please Enter Comment.")
            else :
                my_membership_type = ""
                my_user_id = 0
                if 'alumni_login_id' in session :
                    my_user_id = session['alumni_login_id']
                    my_membership_type = "ALUMNI"
                elif 'college_login_id' in session :
                    my_user_id = session['college_login_id']
                    my_membership_type = "COLLEGE SPOC"
                elif 'association_login_id' in session :
                    my_user_id = session['association_login_id']
                    my_membership_type = "ASSOCIATION MEMBER"
                else :
                    return jsonify(res=1,msg='You Are Not Logged In.')       
                
                soup = BeautifulSoup(comment,features="html.parser")
                text_of_post = soup.get_text()
                
                u = "http://api1.webpurify.com/services/rest/?method=webpurify.live.return&api_key=5dbe9ccc991f21c15ecd24b151186ecc&format=json&text="+str(text_of_post)
                r=requests.get(u)

                json_con = r.json()

                
                
                no_of_offensive_words = 0
                try :
                    no_of_offensive_words = int(json_con['rsp']['found'])
                except :
                    print("Error In Getting Offensive Words.")
                
                
                    
                if no_of_offensive_words != 0 :  
                    offensive_words = json_con['rsp']['expletive']
                    if isinstance(offensive_words,str) :
                        print("Offensive Word : ",offensive_words)
                        msg = "Your Post Contains Offensive Word : "+str(offensive_words) + " Please Remove It To Make A Post."
                    elif isinstance(offensive_words,list) :
                        offensive_words = ','.join(list(offensive_words))
                        print("Offensive Words : ",offensive_words)
                        msg = "Your Post Contains Offensive Words Like "+str(offensive_words) + " Please Remove It To Make A Post."
                    else :
                        print("Error In Determining Offensive Words.")
                   
                    return jsonify(res=0,msg=msg,sp=1) 
                    
                
                try :
                    sql = "INSERT INTO association_discussion_comments(discussion_id,user_id,membership_type,comment,date_time) VALUES(%d,%d,'%s','%s','%s')" % (int(post_id),int(my_user_id),str(my_membership_type),str(comment),str(date_time))
                    con.execute(sql)
                    cnx.commit()
                    
                    
                    response = ''''''

                   
                    try :
                        sql = "SELECT * FROM association_discussion_comments WHERE discussion_id=%d ORDER BY date_time DESC" % (discussion_id) 
                        con.execute(sql)
                        res = con.fetchall()
                        print("Total Comments : ",len(res))
                        for i in res :
                            
                            
                            
                            user_id = int(i[2])
                            comment_time = str(i[5])
                            membership_type = str(i[3])
                            comment = str(i[4])
                            comment_id = str(i[0])
                            
                            if membership_type == "ASSOCIATION MEMBER" :
                                
                                sql = "SELECT * FROM association WHERE association_id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                                
                                try :
                                    sql = "SELECT profile_image FROM association_basic_profile_details WHERE association_id=%d" % (int(res2[0][0]))
                                    con.execute(sql)
                                    res_prof = con.fetchall()
                                    profile_url = "../../../../"+res_prof[0][0]
                                
                                except :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
                    
                                    random_bg_color = color[0]
                                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                                
                                
                            if membership_type == "COLLEGE SPOC" : 
                                
                                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][2]).capitalize()
                                l_name = str(res2[0][3]).capitalize()
                                
                                
                                try :
                                    sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(res2[0][0]))
                                    con.execute(sql)
                                    res_prof = con.fetchall()
                                    profile_url = "../../../../"+res_prof[0][0]
                                
                                except :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
                    
                                    random_bg_color = color[0]
                                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                                
                            
                            if membership_type == "ALUMNI" : 
                                
                                sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                        
                                try :
                                    sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(res2[0][0]))
                                    con.execute(sql)
                                    res_prof = con.fetchall()
                                    profile_url = "../../../../"+res_prof[0][0]
                                
                                except :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
                    
                                    random_bg_color = color[0]
                                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                        
                        
                            print("f_name :",f_name)
                            print("l_name : ",l_name) 
                        
                            response += '''
                                                    <div class="outer-comment">'''
                            
                            
                                                    
                            if  membership_type == "ASSOCIATION MEMBER" and user_id == my_user_id:
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                
                                commenter_type = "Association Member"
                                            
                            if  membership_type == "COLLEGE SPOC" and user_id == my_user_id:
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                                
                                commenter_type = "College SPOC"
                                                
                            
                            if  membership_type == "ALUMNI" and user_id == my_user_id:
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                                
                                commenter_type = "Alumni"
                            
                                                
                                                
                            response += ''' <div class="comment">
                                                    <div>
                                                    <img src="'''+profile_url+'''" class="profile-img" alt="">
                                                    
                                                    
                                                    </div>
                                                    <div class="user-time">
                                                        <div class="user">'''+f_name+''' '''+l_name+''' <br><br><span class="time">
                                                        <time class="timeago" datetime="'''+comment_time+'''">'''+comment_time+'''</time></span></div>
                                                        
                                                    </div>
                                                </div>
                                                <div class="userComment">'''+comment+'''</div>
                                                
                                            </div>
                                                                    '''       
                                        
                        print(response)    
                        return jsonify(res=1,msg="Comment Added Successfully.",resp=response,total_comments=len(res))
                    except:
                        return jsonify(res=0,msg="Unable To Get Comments.")
                    
                    
                    
                except :
                    return jsonify(res=0,msg="Unable To Insert, Please Check Your Inputs.")
                
        
        if mode == 2 :
            my_membership_type = ""
            my_user_id = 0
            if 'alumni_login_id' in session :
                my_user_id = session['alumni_login_id']
                my_membership_type = "ALUMNI"
            elif 'college_login_id' in session :
                my_user_id = session['college_login_id']
                my_membership_type = "COLLEGE SPOC"
            elif 'association_login_id' in session :
                my_user_id = session['association_login_id']
                my_membership_type = "ASSOCIATION MEMBER"
            else :
                return jsonify(res=1,msg='You Are Not Logged In.')       
                
            comment_id = int(request.form['comment_id'])
            
            if comment_id == 0 :
                return jsonify(res=0,msg="No Comments Found.")
            else :
                
                print("comment id : ",comment_id)
                
                try :
                    sql = "DELETE FROM association_discussion_comments WHERE id=%d" % (int(comment_id))
                    con.execute(sql)
                    cnx.commit()
                    
                    
                    response = ''''''

                   
                    try :
                        sql = "SELECT * FROM association_discussion_comments WHERE discussion_id=%d ORDER BY date_time DESC" % (discussion_id) 
                        con.execute(sql)
                        res = con.fetchall()
                        print("Total Comments : ",len(res))
                        for i in res :
                            
                            
                            
                            user_id = int(i[2])
                            comment_time = str(i[5])
                            membership_type = str(i[3])
                            comment = str(i[4])
                            comment_id = str(i[0])
                            
                            if membership_type == "ASSOCIATION MEMBER" :
                                
                                sql = "SELECT * FROM association WHERE association_id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                                
                                try :
                                    sql = "SELECT profile_image FROM association_basic_profile_details WHERE association_id=%d" % (int(res2[0][0]))
                                    con.execute(sql)
                                    res_prof = con.fetchall()
                                    profile_url = "../../../../"+res_prof[0][0]
                                
                                except :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
                    
                                    random_bg_color = color[0]
                                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                                
                                
                            if membership_type == "COLLEGE SPOC" : 
                                
                                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][2]).capitalize()
                                l_name = str(res2[0][3]).capitalize()
                                
                                
                                try :
                                    sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(res2[0][0]))
                                    con.execute(sql)
                                    res_prof = con.fetchall()
                                    profile_url = "../../../../"+res_prof[0][0]
                                
                                except :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
                    
                                    random_bg_color = color[0]
                                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                                
                            
                            if membership_type == "ALUMNI" : 
                                
                                sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
                                con.execute(sql)
                                res2 =  con.fetchall()
                                
                                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                                f_name = str(res2[0][1]).capitalize()
                                l_name = str(res2[0][2]).capitalize()
                                
                                try :
                                    sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(res2[0][0]))
                                    con.execute(sql)
                                    res_prof = con.fetchall()
                                    profile_url = "../../../../"+res_prof[0][0]
                                
                                except :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
                    
                                    random_bg_color = color[0]
                                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                        
                        
                        
                            print("f_name :",f_name)
                            print("l_name : ",l_name) 
                        
                            response += '''
                                                    <div class="outer-comment">'''
                            
                            
                                                    
                            if  membership_type == "ASSOCIATION MEMBER" and user_id == my_user_id:
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                                
                            if  membership_type == "COLLEGE SPOC" and user_id == my_user_id:
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                                                
                            
                            if  membership_type == "ALUMNI" and user_id == my_user_id:
                                                
                                response += '''<p class="read-more" style="width:100%;">
                                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                                </p>'''
                            
                                                
                                                
                            response += ''' <div class="comment">
                                                    <div>
                                                    <img src="'''+profile_url+'''" class="profile-img" alt="">
                                                    </div>
                                                    <div class="user-time">
                                                        <div class="user">'''+f_name+''' '''+l_name+'''<br><br><span class="time">
                                                        <time class="timeago" datetime="'''+comment_time+'''">'''+comment_time+'''</time></span></div>
                                                        
                                                    </div>
                                                </div>
                                                <div class="userComment">'''+comment+'''</div>
                                                
                                            </div>
                                                                    '''       
                                        
                        print(response)    
                        return jsonify(res=1,msg="Comment Removed Successfully.",resp=response,total_comments=len(res))
                    except:
                        return jsonify(res=0,msg="Unable To Delete / Fetch Comments.")
                    
                    
                    
                except :
                    return jsonify(res=0,msg="Unable To Reomve Comment.")
                
                      
       
    try :
        sql = "UPDATE association_discussion SET total_views = total_views+1 WHERE id=%d" % (discussion_id)
        con.execute(sql)
        cnx.commit()
        
    except :
        pass
                
                
        
    discussion_details = []
    try :
        sql = "SELECT * FROM association_discussion WHERE id=%d" % (discussion_id)
        con.execute(sql)
        discussion_details = con.fetchall()
    except :
        pass
        
    discussion_comments_details = []
        
    try :
        sql = "SELECT * FROM association_discussion_comments WHERE discussion_id=%d" % (discussion_id)
        con.execute(sql)
        discussion_comments_details = con.fetchall()
    except :
        pass
    
    response = ''''''
            
    
    
    try :
        sql = "SELECT * FROM association_discussion_comments WHERE discussion_id=%d ORDER BY date_time DESC" % (discussion_id) 
        con.execute(sql)
        res = con.fetchall()
        print("Total Comments : ",len(res))
        
        my_membership_type = ""
        my_user_id = 0
        if 'alumni_login_id' in session :
            my_user_id = session['alumni_login_id']
            my_membership_type = "ALUMNI"
        elif 'college_login_id' in session :
            my_user_id = session['college_login_id']
            my_membership_type = "COLLEGE SPOC"
        elif 'association_login_id' in session :
            my_user_id = session['association_login_id']
            my_membership_type = "ASSOCIATION MEMBER"
        else :
            my_user_id = 0
            my_membership_type = ""             
        for i in res :
            
            
            
            user_id = int(i[2])
            comment_time = i[5].strftime('%d/%m/%Y %I:%M:%S %p')
            membership_type = str(i[3])
            comment = str(i[4])
            comment_id = str(i[0])
            
            if membership_type == "ASSOCIATION MEMBER" :
                
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(user_id))
                con.execute(sql)
                res2 =  con.fetchall()
                
                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                f_name = str(res2[0][1]).capitalize()
                l_name = str(res2[0][2]).capitalize()
                commenter_type = "Association Member"
                
                try :
                    sql = "SELECT profile_image FROM association_basic_profile_details WHERE association_id=%d" % (int(res2[0][0]))
                    con.execute(sql)
                    res_prof = con.fetchall()
                    profile_url = "../../../../"+res_prof[0][0]
                
                except :
                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                    random_bg_color = color[0]
                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
                
            if membership_type == "COLLEGE SPOC"  : 
                
                sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(user_id))
                con.execute(sql)
                res2 =  con.fetchall()
                
                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                f_name = str(res2[0][2]).capitalize()
                l_name = str(res2[0][3]).capitalize()
                commenter_type = "College SPOC"

                try :
                    sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(res2[0][0]))
                    con.execute(sql)
                    res_prof = con.fetchall()
                    profile_url = "../../../../"+res_prof[0][0]
                
                except :
                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                    random_bg_color = color[0]
                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
            
            if membership_type == "ALUMNI" : 
                
                sql = "SELECT * FROM students WHERE id=%d" % (int(user_id))
                con.execute(sql)
                res2 =  con.fetchall()
                
                profile_url = "https://style.anu.edu.au/_anu/4/images/placeholders/person.png"
                f_name = str(res2[0][1]).capitalize()
                l_name = str(res2[0][2]).capitalize()
           
                commenter_type = "Alumni"
                
                try :
                    sql = "SELECT profile_image FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(res2[0][0]))
                    con.execute(sql)
                    res_prof = con.fetchall()
                    profile_url = "../../../../"+res_prof[0][0]
                
                except :
                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                    random_bg_color = color[0]
                    profile_url = "https://ui-avatars.com/api/?size=512&name="+str(f_name)+"+"+ str(l_name)+"&background="+str(random_bg_color)+"&color=fff" 
           
            print("f_name :",f_name)
            print("l_name : ",l_name) 
           
            response += '''
                                    <div class="outer-comment">'''
            
            
                                    
            if  membership_type == "ASSOCIATION MEMBER" and user_id == my_user_id :
                    response += '''<p class="read-more" style="width:100%;">
                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                   </p>'''
             
                    
                                   
            if  membership_type == "COLLEGE SPOC" and user_id == my_user_id :
                    response += '''<p class="read-more" style="width:100%;">
                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                   </p>'''
                                   
            
            if  membership_type == "ALUMNI" and user_id == my_user_id :
                    response += '''<p class="read-more" style="width:100%;">
                                    <a href="javascript:void(0)" style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="deleteComment(this);">Delete</a>
                                   </p>'''
            if user_id != my_user_id :
                response += '''<p class="read-more" style="width:100%;">
                                                    <a style="float: right;" data-commentid="'''+str(comment_id)+'''" onclick="reportComment(this);"> <i class="fas fa-flag"></i>
                                                    </a>
                                                </p>'''       
                                   
            response += ''' <div class="comment">
                                    <div>
                                      <img src="'''+profile_url+'''" class="profile-img" alt="">
                                    </div>
                                    <div class="user-time">
                                    
                                          <div class="user">'''+f_name+''' '''+l_name+'''<br><br><span class="time">
                                          <time class="timeago" datetime="'''+comment_time+'''">'''+comment_time+'''</time></span></div>
                                          
                                    </div>
                                  </div>
                                  <div class="userComment">'''+comment+'''</div>
                                  
                              </div>
                                                    '''
         
            
            
                        
        # print(response)    
          
    except:
        pass
    
    
    
        
        
    discussion_title = ""
    soup = BeautifulSoup(discussion_details[0][2],features="html.parser")
    discussion_title = soup.get_text()
        
        # print(discussion_details)
        
    tags = str(discussion_details[0][3]).split(",")
    # print(tags)
    if len(tags[0]) == 0 :
        l_tags = 0
    else :
        
        l_tags = len(tags)
        # print(tags)
        
    # print(response)
        
    con.close()
    # print(discussion_comments_details)
    return render_template("association_view_discussion.html",discussion_details=discussion_details,l_discussion_details=len(discussion_details),discussion_comments_details=discussion_comments_details,l_discussion_comments_details=len(discussion_comments_details),discussion_title=discussion_title,tags=tags,l_tags=l_tags,all_comments=response)
        
@app.route('/association/magazines',methods=['GET','POST'])
def association_magazines():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()  
    isPosterSaved = 0
    isMagazineSaved = 0
    if request.method == "POST" :
        
        
        now = datetime.now()
        d_t = now.strftime("%Y-%m-%d %H:%M:%S")
        
        # http://localhost:5000/association/poll?poll_title=How+Are+You+%3F&option_1=I+am+Fine.&option_2=Fine.&option_3=Very+Fine.&option_4=Good&total_options=4
        magazine_title = str(request.form['magazine_title'])
        magazine_description = str(request.form['magazine_description'])
        
        session['association_magazine_title'] = magazine_title
        session['association_magazine_description'] = magazine_description
        
        c_dirName = "static/uploads/association_magazines/"

        try :
            os.mkdir(c_dirName)
                    
        except FileExistsError:
            print("Directory " + c_dirName + " already exists")

        
      
        try :
            
            file = request.files['magazine-poster']
            print(file.filename)
            # for file in files :
                # print(file.filename)
            poster_path = "static/uploads/association_magazines/"+str(uuid.uuid1()).replace("-","")+file.filename
            file.save(poster_path)
            
            print("Association Magazine Poster Saved.")
            isPosterSaved = 1
    
        except :
            isPosterSaved = 0
            print("Error In Saving Association Magazine Poster.")
            
        
        try :
            
            file = request.files['magazine-file']
            
            # p = path+secure_filename(file.filename)
            magazine_file_path = "static/uploads/association_magazines/magazine_"+str(uuid.uuid1())+file.filename
            file.save(magazine_file_path)
            
            print("Association Magazine File Saved.")
            isMagazineSaved = 1
        except :
            isMagazineSaved = 0
            print("Error In Saving Association Magazine File.")
            
            
        if isPosterSaved == 1 and isMagazineSaved == 1 :
            
            try :
                    sql = "INSERT INTO association_magazines(association_id,magazine_title,magazine_description,magazine_poster,magazine_file,date_time) VALUES(%d,'%s','%s','%s','%s','%s')" % (int(session['association_login_id']),magazine_title,magazine_description,str(poster_path),str(magazine_file_path),str(d_t))
                    con.execute(sql)
                    cnx.commit()
                    print("Association Magazine Saved.")
                    
                    session['association_magazine_title'] = ""
                    session['association_magazine_description'] = ""
                    
                    flash(Markup("<p style='color:green;font-size:15px;'>Magazine Added Successfully.</p>"))
                    return redirect(url_for('association_magazines'))
            except :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting Magazine In Database.</p>"))
                return redirect(url_for('association_magazines'))
   
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        
        con.close()
        return render_template("association_magazines.html")  
         
        
@app.route('/association/broadcast',methods=['GET','POST'])
def association_broadcast():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    
    
    if request.method == "POST" :
        broadcast_mode = int(request.form['broadcast_mode'])
        if broadcast_mode == 1 :
            email_subject = request.form['email_subject']
            email_content = request.form['email_broadcast_message']
            
            try:
                send_not_association = request.form.getlist('e_send_not_association')[0]
                if send_not_association == "on" :
                    send_not_association = "YES"
                else :
                    send_not_association = "NO"
            except :
                send_not_association = "NO"
        
            try :    
                send_not_colleges = request.form.getlist('e_send_not_colleges')[0]
                if send_not_colleges == "on" :
                    send_not_colleges = "YES"
                else :
                    send_not_colleges = "NO"
            except :
                send_not_colleges = "NO"
            try :
                send_not_alumni = request.form.getlist('e_send_not_alumni')[0]
                if send_not_alumni == "on" :
                    send_not_alumni = "YES"
                else :
                    send_not_alumni = "NO"
            except :
                send_not_alumni = "NO"
                
            if send_not_alumni == "NO" and send_not_colleges == "NO" and send_not_association == "NO" :
                session['association_bc_email_subject'] = email_subject
                session['association_bc_email_content'] = email_content
                flash(Markup("<p style='color:red;font-size:15px;'>Select Email Receipients From Alumni, Colleges & Association Members.</p>"))
                return redirect(url_for('association_broadcast'))
        
            else :
                
                alumni_e_list = []
                college_e_list = []
                association_e_list = []
                
                isMTableCreated = 0
                try : 
                    nu = str(uuid.uuid1()).replace("-","")
                    table_name = "association_email_cron_"+nu
                    sql = "CREATE TABLE "+str(table_name)+" (id INT(20) UNSIGNED AUTO_INCREMENT PRIMARY KEY,membership_type VARCHAR(30) NOT NULL,email VARCHAR(200) NOT NULL,isEmailSent VARCHAR(10) NOT NULL,date_time TIMESTAMP)"
                    con.execute(sql)
                    cnx.commit()
                    print("Association Cron Email Table Created.")
                    isMTableCreated = 1
                except :
                    print("Error In Creating Association Email Cron Table.")
                    pass
                
                if isMTableCreated == 1 :
                    if send_not_alumni == "YES" :
                        try :
                            sql = "SELECT email FROM students WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'"
                            con.execute(sql)
                            res = con.fetchall()
                            for i in res :
                                alumni_e_list.append(str(i[0]))
                            print("\nalumni_e_list : ",alumni_e_list)
                        except :
                            pass
                        
                        try :
                            for i in alumni_e_list :
                                sql = "INSERT INTO "+str(table_name)+"(membership_type,email,isEMailSent) VALUES('ALUMNI','%s','NO')" % (i)
                                con.execute(sql)
                                cnx.commit()  
                            print("Alumni Email For Email Cron Inserted.")  
                        except :
                            print("Unable To Insert Alumni Mail In Association Email Cron Table.")
                            pass
                        
                    if send_not_colleges == "YES" :
                        try :
                            sql = "SELECT email FROM college_spoc WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isSpocVerified='YES'"
                            con.execute(sql)
                            res = con.fetchall()
                            for i in res :
                                
                                college_e_list.append(str(i[0]))
                            print("\ncollege_e_list : ",college_e_list)
                        except :
                            pass
                        
                        try :
                            for i in college_e_list :
                                sql = "INSERT INTO "+str(table_name)+"(membership_type,email,isEMailSent) VALUES('COLLEGE_SPOC','%s','NO')" % (i)
                                con.execute(sql)
                                cnx.commit()  
                            print("College Email For Email Cron Inserted.")  
                        except :
                            print("Unable To Insert College Mail In Association Email Cron Table.")
                            pass
                    if send_not_association == "YES" :
                        try :
                            sql = "SELECT email FROM association WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'"
                            con.execute(sql)
                            res = con.fetchall()
                            for i in res :
                            
                                association_e_list.append(str(i[0]))
                            print("\nassociation_e_list : ",association_e_list)
                        except :
                            pass
                         
                        try :
                            for i in association_e_list :
                                sql = "INSERT INTO "+str(table_name)+"(membership_type,email,isEMailSent) VALUES('ASSOCIATION_MEMBER','%s','NO')" % (i)
                                con.execute(sql)
                                cnx.commit()  
                            print("Association Email For Email Cron Inserted.")  
                        except :
                            print("Unable To Insert Association Mail In Association Email Cron Table.")
                            pass
                            
                    if send_not_alumni == "YES" :
                        s_s_n_al = "PENDING"
                    else :
                        s_s_n_al = "N/A"
                            
                    if send_not_colleges == "YES" :
                        s_s_n_c = "PENDING"
                    else :
                        s_s_n_c = "N/A"
                            
                    if send_not_association == "YES" :
                        s_s_n_as = "PENDING"
                    else :
                        s_s_n_as = "N/A"
                            
                    try :
                        now = datetime.now()
                        ti = now.strftime("%Y-%m-%d %H:%M:%S")
                        sql = "INSERT INTO association_cron_details(association_id,table_name,type,title,message,send_not_alumni,send_not_colleges,send_not_association,status_send_not_alumni,status_send_not_colleges,status_send_not_association,date_time) VALUES(%d,'%s','%s','%s','%s','%s','%s','%s','%s','%s','%s','%s')" % (int(session['association_login_id']),str(table_name),"EMAIL",str(email_subject),str(email_content),str(send_not_alumni),str(send_not_colleges),str(send_not_association),str(s_s_n_al),str(s_s_n_c),str(s_s_n_as),str(ti))
                        con.execute(sql)
                        cnx.commit()
                            
                        session['association_bc_email_subject'] = ""
                        session['association_bc_email_content'] = ""
                            
                        flash(Markup("<p style='color:green;font-size:15px;'>Email Broadcast Request Made Successfully</p>"))
                        return redirect(url_for('association_broadcast'))
                    except :
                        print("Error In Inserting Email Cron Details In Main Cron Table.")
                        flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting Email Cron Details In Main Cron Table.</p>"))
                        return redirect(url_for('association_broadcast'))
                        # pass
                           
                else :
                    flash(Markup("<p style='color:red;font-size:15px;'>Error In Creating Association Cron Table.</p>"))
                    return redirect(url_for('association_broadcast'))
                
                print("Subject : ",email_subject)
                print("Content : ",email_content)
                print("Send_Not_ALumni : ",send_not_alumni)
                print("Send_Not_Colleges : ",send_not_colleges)
                print("Send_Not_Association: ",send_not_association)
        
        if broadcast_mode == 2 :
            sms_title = request.form['sms_title']
            sms_content = request.form['sms_content']
            
            try:
                send_not_association = request.form.getlist('s_send_not_association')[0]
                if send_not_association == "on" :
                    send_not_association = "YES"
                else :
                    send_not_association = "NO"
            except :
                send_not_association = "NO"
        
            try :    
                send_not_colleges = request.form.getlist('s_send_not_colleges')[0]
                if send_not_colleges == "on" :
                    send_not_colleges = "YES"
                else :
                    send_not_colleges = "NO"
            except :
                send_not_colleges = "NO"
            try :
                send_not_alumni = request.form.getlist('s_send_not_alumni')[0]
                if send_not_alumni == "on" :
                    send_not_alumni = "YES"
                else :
                    send_not_alumni = "NO"
            except :
                send_not_alumni = "NO"
                
            if send_not_alumni == "NO" and send_not_colleges == "NO" and send_not_association == "NO" :
                session['association_bc_sms_title'] = sms_title
                session['association_bc_sms_content'] = sms_content
                flash(Markup("<p style='color:red;font-size:15px;'>Select SMS Receipients From Alumni, Colleges & Association Members.</p>"))
                return redirect(url_for('association_broadcast'))
        
            else :
                
                alumni_s_list = []
                college_s_list = []
                association_s_list = []
                
                isMTableCreated = 0
                try : 
                    nu = str(uuid.uuid1()).replace("-","")
                    table_name = "association_sms_cron_"+nu
                    sql = "CREATE TABLE "+str(table_name)+" (id INT(20) UNSIGNED AUTO_INCREMENT PRIMARY KEY,membership_type VARCHAR(30) NOT NULL,mobile_number BIGINT NOT NULL,isSMSSent VARCHAR(10) NOT NULL,date_time TIMESTAMP)"
                    con.execute(sql)
                    cnx.commit()
                    print("Association SMS Cron Table Created.")
                    isMTableCreated = 1
                except :
                    print("Error In Creating Association SMS Cron Table.")
                    pass
                
                if isMTableCreated == 1 :
                    if send_not_alumni == "YES" :
                        try :
                            sql = "SELECT country_code,mobile_number FROM students WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isStudentVerified='YES'"
                            con.execute(sql)
                            res = con.fetchall()
                            for i in res :
                                m_n = "+"+str(i[0])+str(i[1])
                                alumni_s_list.append(m_n)
                            print("\nalumni_s_list : ",alumni_s_list)
                        except :
                            pass
                        
                        try :
                            for i in alumni_s_list :
                                sql = "INSERT INTO "+str(table_name)+"(membership_type,mobile_number,isSMSSent) VALUES('ALUMNI','%s','NO')" % (i)
                                con.execute(sql)
                                cnx.commit()  
                            print("Alumni Mobile No For SMS Cron Inserted.")  
                        except :
                            print("Unable To Insert Alumni Mobile No. In Association SMS Cron Table.")
                            pass
                        
                    if send_not_colleges == "YES" :
                        try :
                            sql = "SELECT country_code,mobile_number FROM college_spoc WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isSpocVerified='YES'"
                            con.execute(sql)
                            res = con.fetchall()
                            for i in res :
                                m_n = "+"+str(i[0])+str(i[1])
                                college_s_list.append(m_n)
                            print("\ncollege_s_list : ",college_s_list)
                        except :
                            pass
                        
                        try :
                            for i in college_s_list :
                                sql = "INSERT INTO "+str(table_name)+"(membership_type,mobile_number,isSMSSent) VALUES('COLLEGE_SPOC','%s','NO')" % (i)
                                con.execute(sql)
                                cnx.commit()  
                            print("College Mobile_no For SMS Cron Inserted.")  
                        except :
                            print("Unable To Insert College Mobile_No In Association SMS Cron Table.")
                            pass
                    if send_not_association == "YES" :
                        try :
                            sql = "SELECT country_code,mobile_number FROM association WHERE isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='YES'"
                            con.execute(sql)
                            res = con.fetchall()
                            for i in res :
                                m_n = "+"+str(i[0])+str(i[1])
                                association_s_list.append(m_n)
                            print("\nassociation_s_list : ",association_s_list)
                        except :
                            pass
                         
                        try :
                            for i in association_s_list :
                                sql = "INSERT INTO "+str(table_name)+"(membership_type,mobile_number,isSMSSent) VALUES('ASSOCIATION_MEMBER','%s','NO')" % (i)
                                con.execute(sql)
                                cnx.commit()  
                            print("Association Mobile_No For SMS Cron Inserted.")  
                        except :
                            print("Unable To Insert Association Mobile No. In Association SMS Cron Table.")
                            pass
                            
                    if send_not_alumni == "YES" :
                        s_s_n_al = "PENDING"
                    else :
                        s_s_n_al = "N/A"
                            
                    if send_not_colleges == "YES" :
                        s_s_n_c = "PENDING"
                    else :
                        s_s_n_c = "N/A"
                            
                    if send_not_association == "YES" :
                        s_s_n_as = "PENDING"
                    else :
                        s_s_n_as = "N/A"
                            
                    try :
                        now = datetime.now()
                        ti = now.strftime("%Y-%m-%d %H:%M:%S")
                        sql = "INSERT INTO association_cron_details(association_id,table_name,type,title,message,send_not_alumni,send_not_colleges,send_not_association,status_send_not_alumni,status_send_not_colleges,status_send_not_association,date_time) VALUES(%d,'%s','%s','%s','%s','%s','%s','%s','%s','%s','%s','%s')" % (int(session['association_login_id']),str(table_name),"SMS",str(sms_title),str(sms_content),str(send_not_alumni),str(send_not_colleges),str(send_not_association),str(s_s_n_al),str(s_s_n_c),str(s_s_n_as),str(ti))
                        con.execute(sql)
                        cnx.commit()
                            
                        session['association_bc_sms_title'] = ""
                        session['association_bc_sms_content'] = ""
                            
                        flash(Markup("<p style='color:green;font-size:15px;'>SMS Broadcast Request Made Successfully</p>"))
                        return redirect(url_for('association_broadcast'))
                    except :
                        print("Error In Inserting SMS Cron Details In Main Cron Table.")
                        flash(Markup("<p style='color:red;font-size:15px;'>Error In Inserting SMS Cron Details In Main Cron Table.</p>"))
                        return redirect(url_for('association_broadcast'))
                        # pass
                           
                else :
                    flash(Markup("<p style='color:red;font-size:15px;'>Error In Creating Association Cron Table.</p>"))
                    return redirect(url_for('association_broadcast'))
                
                print("SMS Title : ",sms_title)
                print("SMS Content : ",sms_content)
                print("SMS_Send_Not_ALumni : ",send_not_alumni)
                print("SMS_Send_Not_Colleges : ",send_not_colleges)
                print("SMS_Send_Not_Association: ",send_not_association)
            
        
    
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    else :
        
        con.close()
        return render_template("association_broadcast.html")
     

@app.route('/association/chat/',methods=['GET','POST'])
def association_chat():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 0 :
            search = request.form['search']
            sql = "SELECT * FROM network WHERE from_type='ASSOCIATION MEMBER' AND from_id=%d" % (int(session['association_login_id']))
            con.execute(sql)
            res = con.fetchall()
            person_search = ""
            total_found = 0
            for i in res :
                if i[3] == "ASSOCIATION MEMBER" :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(i[4]))
                    con.execute(sql)
                    res2 = con.fetchall()
                    name = res2[0][1] +" "+ res2[0][2]
                    total_found = 0
                    if str(name).lower().find(search.lower()) != -1:
                        total_found += 1
                        image = ""
                        try :
                            sql = "SELECT profile_image FROM association_basic_profile_details WHERE association_id=%d" % (int(i[4]))
                            con.execute(sql)
                            res3 = con.fetchall()
                            res3 = res3[0][0]
                            # person_search += res3 
                            person_search += '''
                            
                                <div class="person" data-chat="person" data-personname="'''+str(res2[0][1]).capitalize()+''' '''+str(res2[0][2]).capitalize()+'''" data-personabout="Association Member" data-usertype="ASSOCIATION MEMBER" data-userid="'''+str(int(i[4]))+'''" data-personimage="../../'''+str(res3)+'''" onclick="openChat(this);" style="cursor: pointer;box-shadow:1px 1px 3px gray,-1px -1px 3px gray;border-radius:10px;padding:0;margin:5px 0;">
                                        <table style="width: 100%;">
                                            <tr>
                                                <td style="border: none;">
                                                    <img src="../../'''+str(res3)+'''" style="width: 50px;height:50px;border-radius: 50%;">
                                                </td>
                                                <td style="text-align: left;border: none">
                                                    <span class="name" style="color: black;font-weight:bold;">'''+str(res2[0][1]).capitalize()+''' '''+str(res2[0][2]).capitalize()+'''</span>
                                                    <br>
                                                    <span class="preview" style="font-size: 14px;">Association Member</span>
                                                </td>
                                            </tr>
                                        </table>
                                    
                                    
                                    </div>
                            '''
                        except :
                            color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                            random_bg_color = color[0]
                            person_search += '''
                            
                                <div class="person" data-chat="person" data-personname="'''+str(res2[0][1]).capitalize()+''' '''+str(res2[0][2]).capitalize()+'''" data-personabout="Association Member" data-usertype="ASSOCIATION MEMBER" data-userid="'''+str(int(i[4]))+'''" data-personimage="https://ui-avatars.com/api/?size=512&name='''+res2[0][1] +'''+'''+ res2[0][2]+'''&background='''+str(random_bg_color)+'''&color=fff" onclick="openChat(this);" style="cursor: pointer;box-shadow:1px 1px 3px gray,-1px -1px 3px gray;border-radius:10px;padding:0;margin:5px 0;">
                                        <table style="width: 100%;">
                                            <tr>
                                                <td style="border: none;">
                                                    <img src="https://ui-avatars.com/api/?size=512&name='''+res2[0][1] +'''+'''+ res2[0][2]+'''&background='''+str(random_bg_color)+'''&color=fff" style="width: 50px;height:50px;border-radius: 50%;">
                                                </td>
                                                <td style="text-align: left;border: none">
                                                    <span class="name" style="color: black;font-weight:bold;">'''+str(res2[0][1]).capitalize()+''' '''+str(res2[0][2]).capitalize()+'''</span>
                                                    <br>
                                                    <span class="preview" style="font-size: 14px;">Association Member</span>
                                                </td>
                                            </tr>
                                        </table>
                                    
                                    
                                    </div>
                            '''
                
                if i[3] == "COLLEGE SPOC" :
                    sql = "SELECT * FROM college_spoc WHERE spoc_id=%d" % (int(i[4]))
                    con.execute(sql)
                    res2 = con.fetchall()
                    name = res2[0][2] +" "+ res2[0][3]
                    total_found = 0
                    if str(name).lower().find(search.lower()) != -1:
                        total_found += 1
                        image = ""
                        try :
                            sql = "SELECT profile_image FROM college_basic_profile_details WHERE spoc_id=%d" % (int(i[4]))
                            con.execute(sql)
                            res3 = con.fetchall()
                            res3 = res3[0][0]
                            # person_search += res3 
                            person_search += '''
                            
                                <div class="person" data-chat="person" data-personname="'''+str(res2[0][2]).capitalize()+''' '''+str(res2[0][3]).capitalize()+'''" data-personabout="College SPOC" data-usertype="COLLEGE SPOC" data-userid="'''+str(int(i[4]))+'''" data-personimage="../../'''+str(res3)+'''" onclick="openChat(this);" style="cursor: pointer;box-shadow:1px 1px 3px gray,-1px -1px 3px gray;border-radius:10px;padding:0;margin:5px 0;">
                                        <table style="width: 100%;">
                                            <tr>
                                                <td style="border: none;">
                                                    <img src="../../'''+str(res3)+'''" style="width: 50px;height:50px;border-radius: 50%;">
                                                </td>
                                                <td style="text-align: left;border: none">
                                                    <span class="name" style="color: black;font-weight:bold;">'''+str(res2[0][2]).capitalize()+''' '''+str(res2[0][3]).capitalize()+'''</span>
                                                    <br>
                                                    <span class="preview" style="font-size: 14px;">College SPOC</span>
                                                </td>
                                            </tr>
                                        </table>
                                    
                                    
                                    </div>
                            '''
                        except :
                            color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                            random_bg_color = color[0]
                            person_search += '''
                            
                                <div class="person" data-chat="person" data-personname="'''+str(res2[0][2]).capitalize()+''' '''+str(res2[0][3]).capitalize()+'''" data-personabout="College SPOC" data-usertype="COLLEGE SPOC" data-userid="'''+str(int(i[4]))+'''" data-personimage="https://ui-avatars.com/api/?size=512&name='''+res2[0][2] +'''+'''+ res2[0][3]+'''&background='''+str(random_bg_color)+'''&color=fff" onclick="openChat(this);" style="cursor: pointer;box-shadow:1px 1px 3px gray,-1px -1px 3px gray;border-radius:10px;padding:0;margin:5px 0;">
                                        <table style="width: 100%;">
                                            <tr>
                                                <td style="border: none;">
                                                    <img src="https://ui-avatars.com/api/?size=512&name='''+res2[0][2] +'''+'''+ res2[0][3]+'''&background='''+str(random_bg_color)+'''&color=fff" style="width: 50px;height:50px;border-radius: 50%;">
                                                </td>
                                                <td style="text-align: left;border: none">
                                                    <span class="name" style="color: black;font-weight:bold;">'''+str(res2[0][2]).capitalize()+''' '''+str(res2[0][3]).capitalize()+'''</span>
                                                    <br>
                                                    <span class="preview" style="font-size: 14px;">College SPOC</span>
                                                </td>
                                            </tr>
                                        </table>
                                    
                                    
                                    </div>
                            '''
                
                
                if total_found == 0 or search == "" or len(search) == 0:
                    person_search = "<br><p style='color:gray;text-align:center;'>No Results Found.</p><br>"
            return jsonify(res=1,person_search=person_search)   
            
        if mode == 1 :
            to_type = str(request.form['membership_type'])
            to_id = int(request.form['to_id'])
            message = str(request.form['message']).strip()
            total_m = 0
            if len(message) == 0 :
                return jsonify(res=0,msg="Please Enter Message.")
            
            now = datetime.now()
            d_t = now.strftime('%Y-%m-%d %H:%M:%S')
            
            isInserted = 0
            try :
                sql = "INSERT INTO chat(from_type,from_id,to_type,to_id,message,date_time) VALUES('%s',%d,'%s',%d,'%s','%s')" % ("ASSOCIATION MEMBER",int(session['association_login_id']),to_type,to_id,message,d_t)
                con.execute(sql)
                cnx.commit()
                isInserted = 1
                
            except :
                print("Error In Inserting Chat Message.")
                return jsonify(res=0,msg='Error In Sending Message.')
            
            content = ''''''
            if isInserted == 1 :
                if to_type == "ASSOCIATION MEMBER" :
                    
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    profile_f_l_name = str(res[0][1]).capitalize()+' '+str(res[0][2]).capitalize()
                    
                        
                    sql = "SELECT * FROM chat WHERE (from_type='ASSOCIATION MEMBER' AND from_id=%d AND to_type='%s' AND to_id=%d) OR (from_type='%s' AND from_id=%d AND to_type='%s' AND to_id=%d) ORDER BY date_time" % (int(session['association_login_id']),to_type,to_id,to_type,to_id,"ASSOCIATION MEMBER",int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    for i in res :
                        total_m += 1
                        if int(i[2]) == int(session['association_login_id']):
                            content += '''
                                         
                                <div class="bubble me" style="margin-bottom: 10px !important;float: right;">
                                   '''+str(i[5])+'''
                            </div>
                            <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;padding-right:10px;text-align: right;float:right;">'''+str(i[6].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>
                               
                           
                                
                                    '''
                        else :
                            content += '''
    
                                <div class="bubble you" style="margin-bottom: 10px !important;float: left;">
                                   '''+str(i[5])+'''
                                    </div>
                                    <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;padding-left:10px;vertical-align: middle;">'''+str(i[6].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>

                          
                            
                            '''
                                
                    
                isUpdate = 0
                if 'association_chat_count' not in session :
                    isUpdate = 1
                    session['association_chat_count'] = total_m
                else :
                    try :
                        if int(session['association_chat_count']) != total_m :
                            isUpdate = 1
                            session['association_chat_count'] = total_m
                            
                        else :
                            isUpdate = 0
                    except :
                        pass
                print("Insert Inupdate : ",isUpdate)
                msg_to = "New Message From "+profile_f_l_name
                return jsonify(res=1,msg='Message Sent.',content=content,total_m=total_m,msg_to=msg_to)

        if mode == 2 :
            to_type = str(request.form['membership_type'])
            to_id = int(request.form['to_id'])
            
            total_m = 0
            content = ''''''
            
            
            if to_type == "ASSOCIATION MEMBER" :
                
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(to_id))
                con.execute(sql)
                res = con.fetchall()
                profile_f_l_name = str(res[0][1]).capitalize()+' '+str(res[0][2]).capitalize()
                
                sql = "SELECT * FROM chat WHERE (from_type='ASSOCIATION MEMBER' AND from_id=%d AND to_type='%s' AND to_id=%d) OR (from_type='%s' AND from_id=%d AND to_type='%s' AND to_id=%d) ORDER BY date_time" % (int(session['association_login_id']),to_type,to_id,to_type,to_id,"ASSOCIATION MEMBER",int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                for i in res :
                    total_m += 1
                    if int(i[2]) == int(session['association_login_id']):
                        content += '''
                                         
                                <div class="bubble me" style="margin-bottom: 10px !important;float: right;">
                                   '''+str(i[5])+'''
                            </div>
                            <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;padding-right:10px;text-align: right;float:right;">'''+str(i[6].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>
                               
                           
                                
                                    '''
                    else :
                        content += '''
    
                
                                <div class="bubble you" style="margin-bottom: 10px !important;float: left;">
                                   '''+str(i[5])+'''
                                    </div>
                                    <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;float: left;padding-left:10px;vertical-align: middle;">'''+str(i[6].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>

                           
                            
                            '''
                                
            
            isUpdate = 0
            try :
                if int(session['association_chat_count']) != total_m :
                    isUpdate = 1
                    session['association_chat_count'] = total_m
                else :
                    isUpdate = 0
            except :
                pass
                        
            msg_to = "New Message From "+profile_f_l_name
            return jsonify(res=1,msg='Message Received.',content=content,total_m=total_m,isUpdate=isUpdate,msg_to=msg_to)

    
        if mode == 3 :
            
            group_name = request.form['group_name']
            group_description = request.form['group_description']
            group_upload_file = ""
            f_n = ""
            isfileuploaded = 0
            path = ""
            
            now = datetime.now()
            d_t = now.strftime("%Y-%m-%d %H:%M:%S")
            
            try :
                group_upload_file = request.files['group-upload-file']
            
                isfileuploaded = 0
                f_n = ""
                
                f_n = group_upload_file.filename
            except :
                pass
            
            # print(f_n)
            
            if len(f_n) != 0 :
                try :
                    os.mkdir('static/uploads/group_images')
                except :
                    pass
                
                group_upload_file = request.files['group-upload-file']
            
                
                path = "static/uploads/group_images/group_img_"+str(uuid.uuid1())+"_"+group_upload_file.filename

                try :
                    group_upload_file.save(path)
                    isfileuploaded = 1
                    
                except :
                    flash(Markup("<p style='font-size:15px;color:red;'>Error In Uploading Group Image.</p>"))
                    return
                
            
            add_to_people = request.form.getlist('add_to_people')
            add_to = []
            for i in range(len(add_to_people)):
                p = add_to_people[i].split(",")
                add_to.append(p)
                
            try :
                sql = "INSERT INTO groups(membership_type,profile_id,group_name,group_description,group_image,date_time) VALUES ('ASSOCIATION MEMBER',%d,'%s','%s','%s','%s')" % (int(session['association_login_id']),group_name,group_description,path,d_t)
                con.execute(sql)
                cnx.commit()
            except :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Group.</p>"))
                return redirect(url_for('association_chat'))
            
            try :
                sql = "SELECT * FROM groups WHERE membership_type='ASSOCIATION MEMBER' AND profile_id=%d AND group_name='%s' AND group_description='%s' AND group_image='%s' AND date_time='%s'" % (int(session['association_login_id']),group_name,group_description,path,d_t)
                con.execute(sql)
                res = con.fetchall()
                group_id = res[0][0]
                print("Group Id : ",group_id)
            except :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Getting Group Details.</p>"))
                return redirect(url_for('association_chat'))
            
            try :
                sql = "INSERT INTO group_members(group_id,membership_type,profile_id,type,date_time) VALUES (%d,'ASSOCIATION MEMBER',%d,'ADMIN','%s')" % (int(group_id),int(session['association_login_id']),d_t)
                con.execute(sql)
                cnx.commit()
                for i in range(len(add_to)):
                    sql = "INSERT INTO group_members(group_id,membership_type,profile_id,type,date_time) VALUES (%d,'%s',%d,'MEMBER','%s')" % (int(group_id),str(add_to[i][1]),int(add_to[i][0]),d_t)
                    con.execute(sql)
                    cnx.commit()
                flash(Markup("<p style='font-size:15px;color:green;'>Group Created Successfully.</p>"))
                return redirect(url_for('association_chat'))
            except :
                flash(Markup("<p style='font-size:15px;color:red;'>Error In Inserting Members In Group.</p>"))
                return redirect(url_for('association_chat'))
            
            return redirect(url_for('association_chat'))
                   
        # Group Chat
        if mode == 4 :
            group_id = int(request.form['group_id'])
            s_id = int(request.form['profile_id'])
            message = str(request.form['message']).strip()
            membership_type = str(request.form['membership_type'])
            group_name = str(request.form['group_name'])
            total_g_m = 0
            if len(message) == 0 :
                return jsonify(res=0,msg="Please Enter Message.")
            
            now = datetime.now()
            d_t = now.strftime('%Y-%m-%d %H:%M:%S')
            
            isInserted = 0
            try :
                sql = "INSERT INTO group_messages(group_id,membership_type,profile_id,message,date_time) VALUES(%d,'%s',%d,'%s','%s')" % (int(group_id),"ASSOCIATION MEMBER",int(session['association_login_id']),message,d_t)
                con.execute(sql)
                cnx.commit()
                isInserted = 1
                
            except :
                print("Error In Inserting Group Chat Message.")
                return jsonify(res=0,msg='Error In Sending Message.')
            
            content = ''''''
            if isInserted == 1 :
                if membership_type == "ASSOCIATION MEMBER" :
                    
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    profile_f_l_name = str(res[0][1]).capitalize()+' '+str(res[0][2]).capitalize()
                    
                        
                    sql = "SELECT * FROM group_messages WHERE group_id=%d" % (int(group_id))
                    con.execute(sql)
                    res = con.fetchall()
                    
                    for i in res :
                        total_g_m += 1
                        if int(i[3]) == int(session['association_login_id']) and str(membership_type) == str(i[2]):
                            content += '''
                                         
                                <div class="bubble me" style="margin-bottom: 10px !important;float: right;">
                                   '''+str(i[4])+'''
                            </div>
                            <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;padding-right:10px;text-align: right;float:right;">'''+str(i[5].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>
                               
                           
                                
                                    '''
                        else :
                            content += '''
    
                                <div class="bubble you" style="margin-bottom: 10px !important;float: left;">
                                   '''+str(i[4])+'''
                                    </div>
                                    <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;padding-left:10px;vertical-align: middle;">'''+str(i[5].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>

                          
                            
                            '''
                                
                    
                isUpdate = 0
                if 'association_g_chat_count' not in session :
                    isUpdate = 1
                    session['association_g_chat_count'] = total_g_m
                else :
                    try :
                        if int(session['association_g_chat_count']) != total_g_m :
                            isUpdate = 1
                            session['association_g_chat_count'] = total_g_m
                            
                        else :
                            isUpdate = 0
                    except :
                        pass
                    
                    
                print("Insert Inupdate : ",isUpdate)
                
                print("s_id : ",s_id)
                print("c_id : ",session['association_login_id'])
                msg_to = "New Message In Group <b>"+str(group_name)+"</b>"        
                return jsonify(res=1,msg='Message Sent.',content=content,total_g_m=total_g_m,msg_to=msg_to,s_id=s_id)

        if mode == 5 :
            group_id = request.form['group_id'] 
            membership_type = str(request.form['membership_type'])
            group_name = str(request.form['group_name'])
            profile_id = int(request.form['profile_id'])
            s_id = int(request.form['profile_id'])
            c_u = str(request.form['c_u'])
            
            # print(profile_id,s_id)
            # if len(message) == 0 :
            # print(s_id)
            total_g_m = 0
            content = ''''''
            
            
            
            sql = "SELECT * FROM group_messages WHERE group_id=%d" % (int(group_id))
            con.execute(sql)
            res = con.fetchall()
                
               
            for i in res :
                total_g_m += 1
                if int(i[3]) == int(session['association_login_id']) and str(i[2]) == str(membership_type):
                        content += '''
                                         
                                <div class="bubble me" style="margin-bottom: 10px !important;float: right;">
                                   '''+str(i[4])+'''
                            </div>
                            <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;padding-right:10px;text-align: right;float:right;">'''+str(i[5].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>
                               
                           
                                
                                    '''
                else :
                    content += '''
    
                
                                <div class="bubble you" style="margin-bottom: 10px !important;float: left;">
                                   '''+str(i[4])+'''
                                    </div>
                                    <div style="font-size: 12px;color: gray;position: relative;line-height: 50px;float: left;padding-left:10px;vertical-align: middle;">'''+str(i[5].strftime("%d/%m/%Y @ %I:%M:%S %p"))+'''</div>

                           
                            
                            '''
                                
            
            isUpdate = 0
            try :
                if int(session['association_g_chat_count']) != total_g_m :
                    isUpdate = 1
                    session['association_g_chat_count'] = total_g_m
                else :
                    isUpdate = 0
            except :
                pass
            if c_u  == "NO" :
                session['association_g_chat_count'] = total_g_m
                isUpdate = 1
            
            msg_to = "New Message In Group <b>"+str(group_name)+"</b>"        
            return jsonify(res=1,msg='Message Received.',content=content,total_g_m=total_g_m,isUpdate=isUpdate,msg_to=msg_to,s_id=s_id,c_u=c_u)

    
            
                    

    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
    
    user_con = ''''''
    try :
        sql = "SELECT * FROM network WHERE from_type='ASSOCIATION MEMBER' AND from_id=%d ORDER BY date_time DESC" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        # print(res)
        to_profile_details = []
        for i in range(len(res)) :
            to_profile_details = []
            # print(res[i][3])
            if res[i][3] == "ASSOCIATION MEMBER" :
                
                try : 
                    sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image  FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (int(res[i][4]),int(res[i][4]))
                    con.execute(sql)
                    res2 = con.fetchall()
                    if len(res2) == 0 :
                        sql = "SELECT association.first_name,association.last_name  FROM association WHERE association.association_id=%d" % (int(res[i][4]))
                        con.execute(sql)
                        res2 = con.fetchall()
                        if len(res2) != 0 :
                            print(res2)
                            to_profile_details.append([int(res[i][4]),res2[0][0],res2[0][1],"NO",'',"Association Member","ASSOCIATION MEMBER"])
                    else :
                        if len(res2[0][2]) == 0 :
                            to_profile_details.append([int(res[i][4]),res2[0][0],res2[0][1],"YES",'',"Association Member","ASSOCIATION MEMBER"])
                        else :
                            to_profile_details.append([int(res[i][4]),res2[0][0],res2[0][1],"YES",res2[0][2],"Association Member","ASSOCIATION MEMBER"])
                            
                        
                except :
                    print("Association : Error In Getting Network Profile Details For Chat.")
            
            print("to_profile_details",to_profile_details)
            
            if to_profile_details[i][3] == "NO" :
                color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                random_bg_color = color[0]
                p_i = 'https://ui-avatars.com/api/?size=512&name='''+str(to_profile_details[i][1]).capitalize()+'+'+str(to_profile_details[i][2]).capitalize()+'&background='+str(random_bg_color)+'&color=fff'
                user_con += '''
                    <li class="person" data-chat="person" data-personname="'''+str(to_profile_details[i][1]).capitalize()+''' '''+str(to_profile_details[i][2]).capitalize()+'''" data-personabout='Association Member' data-usertype="ASSOCIATION MEMBER" data-userid="'''+str(res[i][4])+'''" data-personimage="'''+str(p_i)+'''" onclick="openChat(this);">
                            <img src="'''+str(p_i)+'''" alt="" />
                            <span class="name">'''+str(to_profile_details[i][1]).capitalize()+' '+str(to_profile_details[i][2]).capitalize()+'''</span>
                            <span class="preview">Association Member</span>
                        </li>
                '''
            else :
                user_con += '''
                    <li class="person" data-chat="person" data-personname="'''+str(to_profile_details[i][1]).capitalize()+''' '''+str(to_profile_details[i][2]).capitalize()+'''" data-personabout='Association Member' data-usertype="ASSOCIATION MEMBER" data-userid="'''+str(res[i][4])+'''" data-personimage="../../'''+str(to_profile_details[i][4])+'''" onclick="openChat(this);">
                            <img src="../../'''+str(to_profile_details[i][4])+'''" alt="" />
                            <span class="name">'''+str(to_profile_details[i][1]).capitalize()+' '+str(to_profile_details[i][2]).capitalize()+'''</span>
                            <span class="preview">Association Member</span>
                        </li>
                '''
            
           
            
    except :
        print("Error In Getting Network Details For Chat.")
    
    
    user_con2 = ''''''
    try :
        sql = "SELECT * FROM group_members WHERE membership_type='ASSOCIATION MEMBER' AND profile_id=%d ORDER BY date_time DESC" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        
        # print(res)
        group_details = []
        k = 0
        for i in range(len(res)) :
            group_id = int(res[i][1])
            
            sql = "SELECT * FROM group_members WHERE group_id=%d" % (group_id)
            con.execute(sql)
            resx = con.fetchall()
            total_g_members = len(resx)
            sql = "SELECT * FROM groups WHERE id=%d" % (group_id)
            con.execute(sql)
            
            res2 = con.fetchall()
            
            # print(res2)
            if len(res2[0][5]) == 0 :
                color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                random_bg_color = color[0]
                p_i = 'https://ui-avatars.com/api/?size=512&name='''+str(res2[0][3])+'&background='+str(random_bg_color)+'&color=fff'
                
                group_details.append([group_id,res2[0][3],res2[0][4],"NO",p_i,total_g_members])
                user_con2 += '''
                    <li class="person" data-chat="group" data-groupname="'''+str(res2[0][3])+'''" data-groupdescription="'''+str(res2[0][4])+'''" data-groupid="'''+str(group_id)+'''" data-groupimage="'''+str(p_i)+'''" data-totalgmembers="'''+str(total_g_members)+'''" onclick="openGroupChat(this);" style="padding-bottom:30px !important;padding-top:20px !important;">
                            <img src="'''+str(p_i)+'''" alt="" />
                            <span class="name" style="line-height:30px;">'''+str(res2[0][3])+'''</span>
                        </li>
                '''
            else :
                group_details.append([group_id,res2[0][3],res2[0][4],"YES",res2[0][5],total_g_members])
                
                user_con2 += '''
                    <li class="person" data-chat="group" data-groupname="'''+str(res2[0][3])+'''" data-groupdescription="'''+str(res2[0][4])+'''" data-groupid="'''+str(group_id)+'''" data-groupimage="../../'''+str(res2[0][5])+'''" data-totalgmembers="'''+str(total_g_members)+'''" onclick="openGroupChat(this);" style="padding-bottom:30px !important;padding-top:20px !important;">
                            <img src="../../'''+str(res2[0][5])+'''" alt="" />
                            <span class="name" style="line-height:30px;">'''+str(res2[0][3])+'''</span>
                        </li>
                '''
                
            k += 1
        
                
            
    except :
        print("Error In Getting Group Chat Details.")
    
    
    
    con.close()
    return render_template("association_chat.html",total_in_network=len(res),left_user_content=user_con,to_profile_details=to_profile_details,left_group_user_content=user_con2,group_details=group_details)


     
@app.route('/association/profile/',methods=['GET','POST'])
def association_profile():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
       
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
                
        
    main_profile_details = []
    basic_profile_details = []
    try :
        sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("Error In Getting Main Profile Details.")
        pass
    
    try :
        sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("Error In Getting Basic Profile Details.")
        pass
    
    # print(basic_profile_details)
    
    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
    random_bg_color = color[0]
    # print(random_bg_color)
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("No Expertise or Error In Getting Expertise")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
            
            
    profile_blog_posts = []
    try :
        sql = "SELECT * FROM blog_post_association WHERE association_id=%d ORDER BY date_time" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in range(len(res)) :
            t = []
            for j in range(len(res[i])):
                if j == 4 :
                    soup = BeautifulSoup(res[i][j],features="html.parser")
                    t.append(soup.get_text())
                else :
                    t.append(res[i][j])
                    
            profile_blog_posts.append(t)
            
    except :
        print("Association : Error In Getting Profile Blog Post Details.")
    
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM association_education_details WHERE association_id=%d ORDER BY id DESC" % (int(session['association_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("Association : Error In Getting Education Details Of Profile")
        
    profile_work_details = []
    try :
        sql = "SELECT * FROM association_work_details WHERE association_id=%d ORDER BY id DESC" % (int(session['association_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Association : Error In Getting Education Details Of Profile")
    try :
        profile_pic = basic_profile_details[0][9]
        l_profile_pic = len(profile_pic)
    except :
        profile_pic = ""
        l_profile_pic = len(profile_pic)
    
    profile_network_details = []
    try :
        sql = "SELECT * FROM network WHERE from_id=%d AND from_type='ASSOCIATION MEMBER' ORDER BY date_time DESC" % (int(session['association_login_id']))
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            user_id = int(i[4])
            if i[3] == "ASSOCIATION MEMBER" :
                try :
                    sql = "SELECT association.first_name,association.last_name,association_basic_profile_details.profile_image FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (user_id,user_id)
                    con.execute(sql)
                    xy = con.fetchall()
                    profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],xy[0][2]])
                except :
                    try :
                        sql = "SELECT association.first_name,association.last_name FROM association WHERE association.association_id=%d" % (user_id)
                        con.execute(sql)
                        xy = con.fetchall()
                        profile_network_details.append(["Association Member",user_id,xy[0][0],xy[0][1],"NO"])
                    except:
                        print("Association : Error In Getting Network Profile Details.")
    except :
        print("Association : Error In Getting Education Details Of Profile")
        
    print(profile_network_details)
    
    return render_template("association_profile.html",main_profile_details=main_profile_details,random_bg_color=random_bg_color,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises),profile_blog_posts=profile_blog_posts,l_profile_blog_posts=len(profile_blog_posts),profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details),profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),profile_pic=profile_pic,l_profile_pic=l_profile_pic,profile_network_details=profile_network_details,l_profile_network_details=len(profile_network_details))


@app.route('/association/network/',methods=['GET','POST'])
def association_network():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    
    if request.method == "GET" :
        mode = request.args.get('mode')
        if mode == "1":
            to_id = request.args.get('to_id')
            membership_type = request.args.get('type')
            
            now = datetime.now()
            date_time = now.strftime("%Y-%m-%d %H:%M:%S")
            
            isSearched = 0
            isInserted = 0
            res = []
            try :
                sql = "SELECT * FROM network WHERE from_type='ASSOCIATION MEMBER' AND from_id=%d AND to_type='%s' AND to_id=%d" % (int(session['association_login_id']),str(membership_type),int(to_id))
                con.execute(sql)
                res = con.fetchall()
                isSearched = 1
            except:
                print("Association : Error In Prechecking Network Details")
    
            if isSearched == 1 :
                if len(res) == 1 :
                    return jsonify(res=2,msg="Already In Your Network.")
                else :
                    if len(res) == 0 :
                        sql = "INSERT INTO network(from_type,from_id,to_type,to_id,date_time) VALUES('ASSOCIATION MEMBER',%d,'%s',%d,'%s')" % (int(session['association_login_id']),str(membership_type),int(to_id),date_time)
                        con.execute(sql)
                        cnx.commit()
                        isInserted = 1
                        
            if isInserted == 1 :
                return jsonify(res=1,msg="Added To Your Network.")
            else :
                return jsonify(res=0,msg="Error In Adding To Your Network.")
                        
                        
    if request.method == "POST" :
        mode = request.form["mode"]
        if mode == "1" :
            s_q = str(request.form["search_query"]).strip()
            membership_type = request.form.getlist('membership_type')
            college_value = request.form.getlist('college_value')
            college_degree_value = request.form.getlist('college_degree_value')
            starting_year_value = request.form.getlist('starting_year_value')
            graduation_year_value = request.form.getlist('graduation_year_value')
            location = str(request.form['location']).strip()
            
            print(s_q)
            print(membership_type)
            print(college_value)
            print(college_degree_value)
            print(starting_year_value)
            print(graduation_year_value)
            print(location)
            
            content = ''''''
            
            if "ASSOCIATION MEMBER" in membership_type :
                
                sql = ""
                
                 
                if len(s_q) != 0 :
                    sql += "SELECT * FROM association,association_basic_profile_details,association_education_details WHERE (association.first_name LIKE '%"+str(s_q)+"%'"+" OR association.last_name LIKE '%"+str(s_q)+"%')"
                
                
                    if len(college_value) != 0 :
                        if len(college_value) == 1 :
                                sql += " AND (association_education_details.name_of_institute='"+str(college_value[0])+"')"
                        else :    
                            for i in range(len(college_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.name_of_institute='"+str(college_value[i])+"'"
                                else :
                                    if i == len(college_value)-1 :
                                        sql += " OR association_education_details.name_of_institute='"+str(college_value[i])+"')"
                                    else :
                                        sql += " OR association_education_details.name_of_institute='"+str(college_value[i])+"'"
                                
                                    
                    
                    if len(college_degree_value) != 0 :
                        if len(college_degree_value) == 1 :
                                sql += " AND (association_education_details.degree='"+str(college_degree_value[0])+"')"
                        else :    
                            for i in range(len(college_degree_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.degree='"+str(college_degree_value[i])+"'"
                                else :
                                    if i == len(college_degree_value)-1 :
                                        sql += " OR association_education_details.degree='"+str(college_degree_value[i])+"')"
                                    else :
                                        sql += " OR association_education_details.degree='"+str(college_degree_value[i])+"'"
                        
                            
                        
                    if len(starting_year_value) != 0 :
                        if len(starting_year_value) == 1 :
                                sql += " AND (association_education_details.start_year="+str(starting_year_value[0])+")"
                        else :    
                            for i in range(len(starting_year_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.start_year="+str(starting_year_value[i])
                                else :
                                    if i == len(starting_year_value)-1 :
                                        sql += " OR association_education_details.start_year="+str(starting_year_value[i])+")"
                                    else :
                                        sql += " OR association_education_details.start_year="+str(starting_year_value[i])
                    
                            
                    if len(graduation_year_value) != 0 :
                        if len(graduation_year_value) == 1 :
                                sql += " AND (association_education_details.graduation_year="+str(graduation_year_value[0])+")"
                        else :    
                            for i in range(len(graduation_year_value)):
                                if i == 0 :
                                    sql += " AND (association_education_details.graduation_year="+str(graduation_year_value[i])
                                else :
                                    if i == len(graduation_year_value)-1 :
                                        sql += " OR association_education_details.graduation_year="+str(graduation_year_value[i])+")"
                                    else :
                                        sql += " OR association_education_details.graduation_year="+str(graduation_year_value[i])
                                        
                    if len(location) != 0 :
                        sql += " AND (association_basic_profile_details.current_location='"+str(location)+"')"
                                        
                                    
                            
                    
                    sql += " AND (association.association_id=association_education_details.association_id) AND (association.association_id=association_basic_profile_details.association_id) AND (association.association_id !="+str(session['association_login_id'])+") AND (association_education_details.association_id !="+str(session['association_login_id'])+") AND (association_basic_profile_details.association_id !="+str(session['association_login_id'])+")" 
                    
                    
                    print(sql)
                    
                    try :
                        con.execute(sql)
                        res = con.fetchall()
                        # content2 = ''''''
                        if len(res) == 0 :
                            sql2 = "SELECT * FROM association WHERE (association.first_name LIKE '%"+str(s_q)+"%'"+" OR association.last_name LIKE '%"+str(s_q)+"%') AND association.association_id !="+str(session['association_login_id'])
                            con.execute(sql2)
                            res2 = con.fetchall()
                            if len(res2) == 0 :
                                pass
                                # return jsonify(res=0,msg="No Profile Data Found.",content=content2,l_content=len(content2))

                            else :
                                
                                for i in res2 :
                                    color = [''.join([random.choice('0123456789ABCDE') for j in range(6)])]
    
                                    random_bg_color = color[0]
                                    content += '''
                                        <div class="card">
                                            <div class="card-header"
                                        style="background-image: url('https://ui-avatars.com/api/?size=512&name='''+str(i[1]).capitalize()+'''+'''+str(i[2]).capitalize()+'''&background='''+str(random_bg_color)+'''&color=fff');backgroud-position:center center;">
                                                
                                    
                                                <div class="card-header-slanted-edge">
                                                    <a href="javascript:void(0)" class="btn-follow" data-id="'''+str(i[0])+'''" data-usertype="ASSOCIATION MEMBER" onclick="AddToNetwork(this);"><span class="sr-only">Add</span></a>
                                                </div>
                                            </div>
                                    
                                            <div class="card-body">
                                                <h2 class="name">'''+str(i[1]).capitalize()+''' '''+str(i[2]).capitalize()+'''</h2>
                                                <h4 class="job-title">Association Member</h4>
                                                <div class="bio"></div>
                                            </div>
                                    
                                            
                                        </div>
                                '''
                                # return jsonify(res=1,content=content,l_content=len(content2))
                                
                        else :
                            for i in res :
                            
                                content += '''
                                        <div class="card">
                                            <div class="card-header"
                                        style="background-image: url('../../'''+str(i[24])+'''')"
                                            >
                                                
                                    
                                                <div class="card-header-slanted-edge">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 200"><path class="polygon" d="M-20,200,1000,0V200Z" /></svg>
                                                    <a href="javascript:void(0)" class="btn-follow" data-id="'''+str(i[0])+'''" data-usertype="ASSOCIATION MEMBER" onclick="AddToNetwork(this);"><span class="sr-only">Add</span></a>
                                                </div>
                                            </div>
                                    
                                            <div class="card-body">
                                                <h2 class="name">'''+str(i[1])+''' '''+str(i[2])+'''</h2>
                                                <h4 class="job-title">Association Member</h4>
                                                <div class="bio"></div>
                                            <p>'''+str(i[23])+'''</p>
                                            </div>
                                    
                                            
                                        </div>
                                '''
                            # return jsonify(res=1,content=content,l_content=len(content))
                    except :
                        
                        print("Error In Getting Searched Data.")
                        return jsonify(res=0,msg="Error In Getting Profile Data.",content=content,l_content=len(content))

                else :
                    
                    pass
                        
            return jsonify(res=1,content=content,l_content=len(content))
            
            
           
    
    college_list = []
    try :
        sql = "SELECT * FROM colleges"
        con.execute(sql)
        college_list = con.fetchall()
    except :
        print("Error In Getting College List : Network.")
        
    years_list = []
    for i in range(1960,2021):
        years_list.append(i)
    
    years_list.reverse()
    
    college_degree_list = []
    try :
        sql = "SELECT * FROM college_degrees"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            if i[2] not in college_degree_list :
                college_degree_list.append(i[2])
            else :
                pass
    except :
        print("Error In Getting College Degree List : Network.")
        
    con.close()
    return render_template("association_network.html",college_list=college_list,years_list=years_list,college_degree_list=college_degree_list)
    
@app.route('/association/profile/edit/<int:section_id>',methods=['GET','POST'])
def association_edit_profile(section_id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
      
       
    if request.method == "POST" :
        mode = int(request.form['mode'])
        
        if mode == 2 :
            f_name = str(request.form['profile_first_name']).strip()
            l_name = str(request.form['profile_last_name']).strip()
            email = str(request.form['profile_email']).strip()
            mobile_no = str(request.form['profile_mobile_no']).strip()
            address = str(request.form['profile_main_address'])
            summary = str(request.form['profile_main_summary']).strip()
            expertise = str(request.form['post_tag_value'])[1:]
            
            if len(f_name) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter First Name.</p>"))
                return
            
            if len(l_name) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Last Name.</p>"))
                return
            
            if len(email) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Email Address.</p>"))
                return
            
            if len(mobile_no) == 0 :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Mobile Number.</p>"))
                return
                        
            
            print("Ex : ",expertise)
            
            isNameUpdated = 0
            isAddressUpdated = 0
            isEmailRequestUpdated = 0
            isEmailSent = 0
            email_sent = 0
            isEmailUpdated = 0
            resx = 0
            resy = 0
            isMobileUpdated = 0
            sms_sent = 0
            try :
                sql = "UPDATE association SET first_name='%s',last_name='%s' WHERE association_id=%d" % (f_name,l_name,int(session['association_login_id']))
                con.execute(sql)
                cnx.commit()
                isNameUpdated = 1
            except :
                print("Association : Error In Updating f_name & l_name.")
            
            if isNameUpdated == 1 :
                try :
                    sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    if len(res) == 0 :
                        sql = "INSERT INTO association_basic_profile_details(association_id,address,summary,expertise) VALUES(%d,'%s','%s','%s')" % (int(session['association_login_id']),str(address),str(summary),str(expertise))
                        con.execute(sql)
                        cnx.commit()
                        isAddressUpdated = 1
                    else :
                        sql = "UPDATE association_basic_profile_details SET address='%s',summary='%s',expertise='%s' WHERE association_id=%d" % (str(address),str(summary),str(expertise),int(session['association_login_id']))
                        con.execute(sql)
                        cnx.commit()
                        isAddressUpdated = 1
                except :
                    print("Association : Error In Updating Address.")
                    
            if isAddressUpdated == 1 :
                try :
                    sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                    con.execute(sql)
                    res = con.fetchall()
                    old_email = str(res[0][3])
                        
                    if old_email != email :
                        verification_code = str(uuid.uuid1())
                            
                        try :
                            sql = "SELECT * FROM association WHERE email='%s' AND isEmailVerified='YES' AND isAssociationVerified='YES'" % (email)
                            con.execute(sql)
                            res = con.fetchall()
                            resx = len(res)
                        except :
                            print("Association : Profile Email Compare Error.")
                            
                        if resx == 0 :
                            try :
                                sql = "UPDATE association_basic_profile_details,association SET association_basic_profile_details.isEmailUpdateRequested='YES',association.verification_code='%s' WHERE association_basic_profile_details.association_id=%d AND association.association_id=%d" % (str(verification_code),int(session['association_login_id']),int(session['association_login_id']))
                                con.execute(sql)
                                cnx.commit()
                                isEmailRequestUpdated = 1
                            except :
                                print("Association : Error In Updating isEmailUpdateRequested")
                                
                            url_part_1 = "association/update/"+str(session['association_login_id'])+"/"+str(verification_code)+"/"+str(email)
                        
                            if isEmailRequestUpdated == 1 :
                                msg = Message('Alumni Association Of Goa : Email Update', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
                                msg.html = '''
                                                                <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional //EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

    <head>
        <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta content="width=device-width" name="viewport" />
        <!--[if !mso]><!-->
        <meta content="IE=edge" http-equiv="X-UA-Compatible" />
        <!--<![endif]-->
        <title></title>
        <!--[if !mso]><!-->
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
        <!--<![endif]-->
        <style type="text/css">
            body {
                margin: 0;
                padding: 0;
            }
            
            table,
            td,
            tr {
                vertical-align: top;
                border-collapse: collapse;
            }
            
            * {
                line-height: inherit;
            }
            
            a[x-apple-data-detectors=true] {
                color: inherit !important;
                text-decoration: none !important;
            }
        </style>
        <style id="media-query" type="text/css">
            @media (max-width: 670px) {
                .block-grid,
                .col {
                    min-width: 320px !important;
                    max-width: 100% !important;
                    display: block !important;
                }
                .block-grid {
                    width: 100% !important;
                }
                .col {
                    width: 100% !important;
                }
                .col>div {
                    margin: 0 auto;
                }
                img.fullwidth,
                img.fullwidthOnMobile {
                    max-width: 100% !important;
                }
                .no-stack .col {
                    min-width: 0 !important;
                    display: table-cell !important;
                }
                .no-stack.two-up .col {
                    width: 50% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num8 {
                    width: 66% !important;
                }
                .no-stack .col.num4 {
                    width: 33% !important;
                }
                .no-stack .col.num3 {
                    width: 25% !important;
                }
                .no-stack .col.num6 {
                    width: 50% !important;
                }
                .no-stack .col.num9 {
                    width: 75% !important;
                }
                .video-block {
                    max-width: none !important;
                }
                .mobile_hide {
                    min-height: 0px;
                    max-height: 0px;
                    max-width: 0px;
                    display: none;
                    overflow: hidden;
                    font-size: 0px;
                }
                .desktop_hide {
                    display: block !important;
                    max-height: none !important;
                }
            }
        </style>
    </head>

    <body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
        <!--[if IE]><div class="ie-browser"><![endif]-->
        <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
            <tbody>
                <tr style="vertical-align: top;" valign="top">
                    <td style="word-break: break-word; vertical-align: top;" valign="top">
                        <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                    <tbody>
                                                                        <tr style="vertical-align: top;" valign="top">
                                                                            <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                    <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                                
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                                <!--<![endif]-->
                                                <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                    <div style="font-size:1px;line-height:45px"></div>
                                                    <!--[if mso]></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                    <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                    
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                        <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;">Dear <span style="font-size: 18px; color: #000000;"><b>'''+str(f_name).capitalize()+''' '''+str(l_name).capitalize()+'''</b></strong></span>, We Received Request For Email Change From Your Account.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+url_part_1+'''" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CHANGE MY EMAIL</strong></span></span></a>
                                                    <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                                </div>
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <div style="background-color:transparent;">
                            <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                                <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                    <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                    <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                        <div style="width:100% !important;">
                                            <!--[if (!mso)&(!IE)]><!-->
                                            <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                                <!--<![endif]-->
                                                <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                    <tbody>
                                                        <tr style="vertical-align: top;" valign="top">
                                                            <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                                <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                    <tbody>
                                                                        <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                            </td>
                                                                            <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                                <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                                <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                    <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                        <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                    </div>
                                                </div>
                                                <!--[if mso]></td></tr></table><![endif]-->
                                                <!--[if (!mso)&(!IE)]><!-->
                                            </div>
                                            <!--<![endif]-->
                                        </div>
                                    </div>
                                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                    <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                                </div>
                            </div>
                        </div>
                        <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
        <!--[if (IE)]></div><![endif]-->
    </body>

    </html>
                    '''
                                try :
                                    mail.send(msg)
                                    isEmailSent = 1
                                    email_sent = 1
                                except :
                                    isEmailSent = 1
                                    print("Error In Sending Mail.")
                            else :
                                print("Error In Updating Status Of Email Change To Yes.")
                        else :
                            flash(Markup("<p style='font-size:15px;color:red;'>This Email Is Already Registed With Us.</p>"))
                            
                        if email_sent == 1 and isEmailSent == 1 :
                            flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated Successfully.\nPlease Verify Your New Email Address.</p>"))
                        if email_sent == 0 and isEmailSent == 1 :
                            flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated But Unable To Send Email To  New Email Address.</p>"))        
                                        
                    else :
                        flash(Markup("<p style='font-size:15px;color:green;'>Profile Updated Successfully.</p>"))
                            
            
                except :
                    print("Error In Updating Email.")
            
            
            
            try :
                sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                old_mobile_no = int(res[0][5])
                country_code = str(res[0][4])       
                mobile_no = int(mobile_no)
                otp = random.randrange(111111,999999)                       
                if old_mobile_no != mobile_no :
                    try :
                        sql = "SELECT * FROM association WHERE country_code=%d AND mobile_number=%d AND isMobileVerified='YES' AND isAssociationVerified='YES'" % (int(country_code),int(mobile_no))
                        con.execute(sql)
                        res = con.fetchall()
                        resy = 1
                        resy = len(res)
                    except :
                        print("Association : Error In Comparing Mobile No. In Association Profile")
                        pass
                    
                    if resy == 0 :
                        try :
                            sql = "UPDATE association_basic_profile_details SET isMobileUpdateRequested='YES' WHERE association_id=%d" % (int(session['association_login_id']))
                            con.execute(sql)
                            cnx.commit()
                            print("Update Status Of isMobileUpdateRequested To YES.")
                        except :
                            print("Association : Error In Updating 	isMobileUpdateRequested In Association Profile")
                        pass
                        
                        headers = {
                                                        'Content-Type': 'application/json',
                                                        'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
                                                    }
                                                
                        msg = 'Dear '+str(f_name)+' '+str(l_name)+',\\nWe Received Your Request For Change Of Mobile Number. User '+str(otp)+' As OTP To Change Mobile Number.'

                        data = '{"message": "'+msg+'","binary": false,  "destinations": ["+'+str(country_code)+str(mobile_no)+'"]}'

                        response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                        res = json.loads(response.text)
                        print(res)
                        try :
                            if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                                sms_sent = 1
                                                            # return jsonify(res=1)
                            else :
                                sms_sent = 0
                        except :
                            sms_sent = 0
                            
                        if sms_sent == 1 :
                            try :
                                sql = "UPDATE association SET otp=%d WHERE association_id=%d" % (int(otp),int(session['association_login_id']))
                                con.execute(sql)
                                cnx.commit()
                                session['association_profile_country_code'] = country_code
                                session['association_profile_mobile_no'] = mobile_no
                                session['association_profile_otp'] = otp
                                return redirect(url_for('association_profile_update_mobile'))
                            except :
                                print("Error In Updating OTP.")
                    
                    else :
                        flash(Markup("<p style='font-size:15px;color:red;'>This Mobile No. Is Already Registed With Us.</p>"))
                        print("Mobile No. Already Registered WIth Us.")
                        
        
            except :
                print("Association : Profile Error Getting Mobile No.")
                # flash("<p style='color:green;font-size:15px;'>Profile Updated Successfully. Please Verify Your New Email.</p>")
                
        if mode == 3 :
            profile_current_location = str(request.form['profile_current_location']).strip()
            profile_hometown = str(request.form['profile_hometown'])
            profile_gender = str(request.form['profile_gender'])
            profile_dob = request.form['profile_dob']
            
            
            print(profile_current_location)
            print(profile_hometown)
            print(profile_gender)
            print(profile_dob)
            
            
            profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            profile_dob = profile_dob.strftime("%Y-%m-%d")
            print(profile_dob)
            isProfileContactInfoUpdated = 0
            try :
                sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(session['association_login_id']))
                con.execute(sql)
                res = con.fetchall()
                if len(res) == 0 :
                    sql = "INSERT INTO association_basic_profile_details(association_id,hometown,current_location,date_of_birth,gender) VALUES(%d,'%s','%s','%s','%s')" % (int(session['association_login_id']),profile_hometown,profile_current_location,profile_dob,profile_gender)
                    con.execute(sql)
                    cnx.commit()
                    isProfileContactInfoUpdated = 1
                else :
                    sql = "UPDATE association_basic_profile_details SET hometown='%s',current_location='%s',date_of_birth='%s',gender='%s' WHERE association_id=%d" % (profile_hometown,profile_current_location,profile_dob,profile_gender,int(session['association_login_id']))
                    con.execute(sql)
                    cnx.commit()
                    isProfileContactInfoUpdated = 1
            except :
                print("Association : Error In Updating Basic Information Of Profile.")
                
            
            if isProfileContactInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Profile Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Basic Information.</p>"))  
                
        
        if mode == 4 :
            institute_name = str(request.form['institute_name']).strip()
            starting_year = request.form['starting_year']
            graduation_year = request.form['graduation_year']
            degree = str(request.form['degree']).strip()
            department = str(request.form['department']).strip()
            
            
            print(institute_name)
            print(starting_year)
            print(graduation_year)
            print(degree)
            print(department)
            
            
            if starting_year > graduation_year :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Graduation Year.</p>"))
                print("Association : Profile Graducation : Please Enter Valid Graduation Year.")
                return redirect("../../../association/profile/edit/3")
                
            
            
            # profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            # profile_dob = profile_dob.strftime("%Y-%m-%d")
            # print(profile_dob)
            isProfileEducationInfoUpdated = 0
            try :
                sql = "INSERT INTO association_education_details(association_id,name_of_institute,start_year,graduation_year,degree,department) VALUES(%d,'%s',%d,%d,'%s','%s')" % (int(session['association_login_id']),institute_name,int(starting_year),int(graduation_year),str(degree),str(department))
                con.execute(sql)
                cnx.commit()
                isProfileEducationInfoUpdated= 1
                
            except :
                print("Association : Error In Inserting Education Information Of Profile.")
                
            
            if isProfileEducationInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Education Details Added Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding Education Information.</p>"))  
                
         
        if mode == 5 :
            work_title = str(request.form['work_title']).strip()
            company_name = str(request.form['company_name'])
            work_industry = str(request.form['work_industry'])
            from_month = request.form['from_month']
            from_year = request.form['from_year']
            to_month = request.form['to_month']
            to_year = request.form['to_year']
            try :
                isWorking = request.form.getlist('isWorking')[0]
                if isWorking == "on" :
                    isWorking = "YES"
                else :
                    isWorking = "NO"
            except :
                isWorking = "NO"
                
            achievement = str(request.form['achievement']).strip()
            
            
            
            # print(isWorking)
            
            
            isProfileWorkInfoUpdated = 0
            try :
                sql = "INSERT INTO  association_work_details(association_id,work_title,company_name,work_industry,from_month,from_year,isWorkingNow,to_year,to_month,achievement) VALUES(%d,'%s','%s','%s','%s',%d,'%s',%d,'%s','%s')" % (int(session['association_login_id']),str(work_title),str(company_name),str(work_industry),str(from_month),int(from_year),isWorking,int(to_year),str(to_month),str(achievement))
                con.execute(sql)
                cnx.commit()
                isProfileWorkInfoUpdated = 1
                
            except :
                print("Association : Error In Inserting Work Information Of Profile.")
                
            
            if isProfileWorkInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Work Details Added Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Adding Work Information.</p>"))  
               
                      

                
       
    if 'association_login_id' not in session :
        return redirect(url_for('association_login'))
                
        
    main_profile_details = []
    
    try :
        sql = "SELECT * FROM association WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        main_profile_details = con.fetchall()
    except :
        print("Error In Getting Main Profile Details.")
        pass
    
    basic_profile_details = []
    try :
        sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(session['association_login_id']))
        con.execute(sql)
        basic_profile_details = con.fetchall()
    except :
        print("Error In Getting Basic Profile Details.")
        pass
    
    
    
    expertises_x = []
    expertises = []
    
    try :
        expertises_x = str(basic_profile_details[0][15]).split(",")
    except :
        print("Error In Tag")
        
    for i in expertises_x :
        if len(str(i).strip()) != 0 :
            expertises.append(str(i).strip())
    
    # print(expertises)
    # print(main_profile_details)
    if section_id == 1 :
        return render_template("association_profile_contact_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),expertises=expertises,l_expertises=len(expertises))
    if section_id == 2 :
        return render_template("association_profile_basic_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details))
    if section_id == 3 :
        sql = "SELECT * FROM colleges"
        con.execute(sql)
        college_list = con.fetchall()
        
        college_degree_list = []
        
        sql = "SELECT * FROM college_degrees"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            if i[2] not in college_degree_list :
                college_degree_list.append(i[2])
            else :
                pass
        
        return render_template("association_profile_education_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),college_list=college_list,college_degree_list=college_degree_list)
    if section_id == 4 :
        month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"]
        year_list = []
        
        for i in range(1960,2021):
            # print(i)
            year_list.append(int(i))
            
        
        return render_template("association_profile_work_information.html",main_profile_details=main_profile_details,basic_profile_details=basic_profile_details,l_basic_profile_details=len(basic_profile_details),month_list=month_list,year_list=year_list)
  
  
@app.route("/association/update/<int:association_id>/<verification_code>/<new_email>")
def association_change_email(association_id,verification_code,new_email):
    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    try :
        sql = "SELECT * FROM association,association_basic_profile_details WHERE association.association_id=%d AND verification_code='%s' AND association_basic_profile_details.isEmailUpdateRequested='YES'" % (int(association_id),str(verification_code))
        con.execute(sql)
        res = con.fetchall()
        print(res)
        if len(res) == 1 :
            try :
                sql = "UPDATE association,association_basic_profile_details SET association.email='%s',association.verification_code='',association_basic_profile_details.isEmailUpdateRequested='NO' WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (str(new_email),int(association_id),int(association_id))
                print(sql)
                con.execute(sql)
                cnx.commit()
                flash(Markup("<p style='color:green;font-size:15px;'>Email Is Changed Successfully.</p>"))  
                return redirect(url_for('association_logout'))
            except :
                print("Association : Error In Updating Email Change")
                
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Email Change.</p>"))  
                return "Error In Email Update"
        else :
            return "Error"

    except :
        return "Error"
        print("Assosciation : Error : Email Change Not Found / Lost.")
    con.close()

@app.route('/association/profile/edit/education/<int:id>',methods=['GET','POST'])
def association_profile_edit_education_profile(id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 4 :
            institute_name = str(request.form['institute_name']).strip()
            starting_year = request.form['starting_year']
            graduation_year = request.form['graduation_year']
            degree = str(request.form['degree']).strip()
            department = str(request.form['department']).strip()
                        
            
            if starting_year > graduation_year :
                flash(Markup("<p style='font-size:15px;color:red;'>Please Enter Valid Starting Year & Graduation Year.</p>"))
                print("Association : Profile Graducation : Please Enter Valid Graduation Year.")
                return redirect("../../../../association/profile/edit/education/"+str(id))
                
            
            
            # profile_dob = datetime.strptime(profile_dob, '%m/%d/%Y')
            # profile_dob = profile_dob.strftime("%Y-%m-%d")
            # print(profile_dob)
            isProfileEducationInfoUpdated = 0
            try :
                sql = "UPDATE association_education_details SET name_of_institute='%s',start_year=%d,graduation_year=%d,degree='%s',department='%s' WHERE association_id=%d AND id=%d" % (institute_name,int(starting_year),int(graduation_year),str(degree),str(department),int(session['association_login_id']),int(id))
                con.execute(sql)
                cnx.commit()
                isProfileEducationInfoUpdated= 1
                
            except :
                print("Association : Error In UpdatingEducation Information Of Profile.")
                
            
            if isProfileEducationInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Education Details Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Education Information.</p>"))  
           
        if mode == 2 :
            edu_id = int(request.form['id'])
            
            try :
                sql = "DELETE FROM association_education_details WHERE id=%d AND association_id=%d" % (int(edu_id),int(session['association_login_id']))
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Education Details Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Education.")
        
    
    profile_education_details = []
    try :
        sql = "SELECT * FROM association_education_details WHERE id=%d AND association_id=%d" % (id,int(session['association_login_id']))
        con.execute(sql)
        profile_education_details = con.fetchall()
    except :
        print("Association : Error In Getting Education Details To Edit Profile.")
    con.close()
    
    if len(profile_education_details) == 0 :
        return redirect(url_for('association_profile'))
    
    return render_template('association_profile_education_edit.html',profile_education_details=profile_education_details,l_profile_education_details=len(profile_education_details))
    
    
@app.route('/association/profile/edit/work/<int:id>',methods=['GET','POST'])
def association_profile_edit_work_profile(id):
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "POST" :
        mode = int(request.form['mode'])
        if mode == 5 :
            work_title = str(request.form['work_title']).strip()
            company_name = str(request.form['company_name'])
            work_industry = str(request.form['work_industry'])
            from_month = request.form['from_month']
            from_year = request.form['from_year']
            to_month = request.form['to_month']
            to_year = request.form['to_year']
            try :
                isWorking = request.form.getlist('isWorking')[0]
                if isWorking == "on" :
                    isWorking = "YES"
                else :
                    isWorking = "NO"
            except :
                isWorking = "NO"
                
            achievement = str(request.form['achievement']).strip()
            
            isProfileWorkInfoUpdated = 0
            try :
                sql = "UPDATE association_work_details SET work_title='%s',company_name='%s',work_industry='%s',from_month='%s',from_year=%d,isWorkingNow='%s',to_year=%d,to_month='%s',achievement='%s' WHERE id=%d AND association_id=%d" % (str(work_title),company_name,work_industry,str(from_month),int(from_year),isWorking,int(to_year),str(to_month),achievement,int(id),int(session['association_login_id']))
                con.execute(sql)
                cnx.commit()
                isProfileWorkInfoUpdated = 1
                
            except :
                print("Association : Error In Updating Work Information Of Profile.")
                
            
            if isProfileWorkInfoUpdated == 1 :
                flash(Markup("<p style='color:green;font-size:15px;'>Work Details Updated Successfully.</p>"))  
            else :
                flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Work Information.</p>"))  
           
        if mode == 2 :
            work_id = int(request.form['id'])
            
            try :
                sql = "DELETE FROM association_work_details WHERE id=%d AND association_id=%d" % (int(work_id),int(session['association_login_id']))
                con.execute(sql)
                cnx.commit()
                return jsonify(res=1,msg="Work Details Deleted Successfully.")
            except :
                return jsonify(res=0,msg="Error In Deleting Work Details.")
        
    
    profile_work_details = []
    try :
        sql = "SELECT * FROM association_work_details WHERE id=%d AND association_id=%d" % (id,int(session['association_login_id']))
        con.execute(sql)
        profile_work_details = con.fetchall()
    except :
        print("Association : Error In Getting Work Details To Edit Profile.")
    con.close()
    
    if len(profile_work_details) == 0 :
        return redirect(url_for('association_profile'))
    
    month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"]
    year_list = []
        
    for i in range(1960,2021):
            # print(i)
        year_list.append(int(i))
        
        
    return render_template('association_profile_work_edit.html',profile_work_details=profile_work_details,l_profile_work_details=len(profile_work_details),month_list=month_list,year_list=year_list)
    
    
@app.route("/association/profile/update/mobile/",methods=['GET','POST'])
def association_profile_update_mobile():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if request.method == "GET" :
        mode = request.args.get('mode')
        if mode == "1" :
            r_otp = request.args.get('otp')
            x = 0
            y = 0
            try :
                # association_basic_profile_details
                # isMobileUpdateRequested
                sql = "SELECT * FROM association,association_basic_profile_details WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d AND association_basic_profile_details.isMobileUpdateRequested='YES' AND association.otp=%d" % (int(session['association_login_id']),int(session['association_login_id']),int(r_otp))
                con.execute(sql)
                res = con.fetchall()
                x = len(res)
            except :
                print("Association : Profile Error In Comparing OTP.")
                
            if x == 1 :
                try :
                    # association_basic_profile_details
                    # isMobileUpdateRequested
                    sql = "UPDATE association,association_basic_profile_details SET association.mobile_number=%d,association_basic_profile_details.isMobileUpdateRequested='NO',association.otp=0 WHERE association.association_id=%d AND association_basic_profile_details.association_id=%d" % (int(session['association_profile_mobile_no']),int(session['association_login_id']),int(session['association_login_id']))
                    con.execute(sql)
                    cnx.commit()
                    y = 1
                except :
                    print("Association : Profile Error In Comparing OTP.")
            else :
                return jsonify(res=0,msg="Invalid OTP.")
            
            if y == 1 :
                session['association_profile_country_code'] = ""
                session['association_profile_mobile_no'] = ""
                return jsonify(res=1,msg="Mobile No. Updated Successfully.")
            else :
                return jsonify(res=0,msg="Unable To Update, Please Try Again.")

        if mode == "2" :
            country_code = session['association_profile_country_code']
            mobile_no =  session['association_profile_mobile_no']
            otp = session['association_profile_otp']
            sms_sent = 0
            headers = {
                                                        'Content-Type': 'application/json',
                                                        'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
                                                    }
                                                
            msg = 'Hey ! We Received Your Request For Change Of Mobile Number. User '+str(otp)+' As OTP To Change Mobile Number.'

            data = '{"message": "'+msg+'","binary": false,  "destinations": ["+'+str(country_code)+str(mobile_no)+'"]}'

            response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
            res = json.loads(response.text)
            print(res)
            try :
                if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                    sms_sent = 1
                                                            # return jsonify(res=1)
                else :
                    sms_sent = 0
            except :
                sms_sent = 0
                
            if sms_sent == 1 :
                m = "SMS Is Sent To +"+str(country_code)+str(mobile_no)
                return jsonify(res=1,msg=str(m))
            else :
                return jsonify(res=0,msg="Unable To Send SMS, Please Try Again.")
                
         
    if request.method == "POST" :
         pass              
    
    con.close()
    if len(str(session['association_profile_country_code']))== 0 or len(str(session['association_profile_mobile_no'])) == 0 :
        return redirect(url_for('association_profile'))
    
    return render_template("association_profile_update_mobile_no.html")

    

@app.route('/association/logout')
def association_logout():
    if 'association_login_id' in session and 'association_login_email' in session and 'association_account_activated' in session :
        session['association_login_id'] = ""
        session['association_login_email'] = ""
        session['association_account_activated'] = ""
        session.pop('association_login_id',None)
        session.pop('association_login_email',None)
        session.pop('association_account_activated',None)
    return "<script>window.location.href='/association/login';</script>"

@app.route('/super-admin/login/')
def super_admin_login():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    accountActivated = 0
    if request.method=='GET':
        mode=request.args.get('mode')
        
        if mode == "1":
            email = request.args.get('email')
            password = request.args.get('password')
            
            
            sql = "SELECT * FROM super_admin WHERE email='%s' AND password='%s'" % (email,password)
            con.execute(sql)
            res = con.fetchall()
            print("execured")
            if len(res) == 1 :
                session['super_admin_login_id'] = int(res[0][0])
                session['super_admin_login_email'] = email
                return jsonify(res=1,error="No",msg="Successfully Logged In.") 
            else :
                print("c1")
                return jsonify(res=0,error="NoAccountFound",msg="Please Enter Correct Username & Password.")     
                
    con.close()
    return render_template('super_admin_login.html')

@app.route('/super-admin/home/',methods=['GET','POST'])
def super_admin_home():
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    if 'super_admin_login_id' not in session :
        return redirect(url_for('super_admin_login'))

    
    if request.method=='GET':
        mode=request.args.get('mode')
        isUpdated = 0
        mail_sent = 0
        sms_sent = 0
        if mode == "1":
            association_id = int(request.args.get('association_id'))
            print("association_id : ",association_id)
            sql = "UPDATE association SET isAssociationVerified='YES',account_status='ACTIVATED' WHERE association_id=%d" % (association_id)
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            sql = "SELECT * FROM association WHERE association_id=%d" % (association_id)
            con.execute(sql)
            res = con.fetchall()
            email = str(res[0][3])
            name = str(res[0][1]).capitalize() + " " + str(res[0][2]).capitalize()
            
        if isUpdated == 1 :
            msg = Message('Application Approved For Association Member', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
                         <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_confirmed_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;"><span style="font-size: 18px; color: #000000;">Congratulations <b>'''+name+'''</b> ! Your application for association member has been accepted. Now you are officially part of ALUMNI ASSOCIATION OF GOA.</span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''association/login" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>LOGIN NOW</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>            
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Confirmation Mail.")
            
            if mail_sent == 1 :    
                country_code = "+"+str(res[0][4])
                mobile_no = str(res[0][5])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Congratulations '+name+' ! Your Application for association member has been approved.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
            
                
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    
                    if sms_sent == 1 :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.")
                    else :
                        return jsonify(res=1,error="No",msg="Application Is Accepted Successfully.\nBut Unable To Send Confirmation SMS.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is accepted successfully but unable to send confirmation email.")
            else :
                return jsonify(res=0,error="AcceptUpdateError",msg="Unable To Accept Application.")
        
        if mode == "2":
            association_id = int(request.args.get('association_id'))
            print("association : ",association_id)
            
            p_details = []
            sql = "SELECT * FROM association WHERE association_id=%d" % (int(association_id))
            con.execute(sql)
            p_details = con.fetchall()
            print(p_details)
            sql = "DELETE FROM association WHERE association_id=%d" % (int(association_id))
            con.execute(sql)
            cnx.commit()
            isUpdated = 1
            
            email = str(p_details[0][3])
            name = str(p_details[0][1]).capitalize() + " " + str(p_details[0][2]).capitalize()
            
        if isUpdated == 1 :
            msg = Message('Application Rejected For Association Member', sender = ('Alumni Association Of Goa','alumni.association.goa@gmail.com'), recipients = [email])
            msg.html = '''
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml">

<head>
    <!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:AllowPNG/><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml><![endif]-->
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width" name="viewport" />
    <!--[if !mso]><!-->
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <!--<![endif]-->
    <title></title>
    <!--[if !mso]><!-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
        
        table,
        td,
        tr {
            vertical-align: top;
            border-collapse: collapse;
        }
        
        * {
            line-height: inherit;
        }
        
        a[x-apple-data-detectors=true] {
            color: inherit !important;
            text-decoration: none !important;
        }
    </style>
    <style id="media-query" type="text/css">
        @media (max-width: 670px) {
            .block-grid,
            .col {
                min-width: 320px !important;
                max-width: 100% !important;
                display: block !important;
            }
            .block-grid {
                width: 100% !important;
            }
            .col {
                width: 100% !important;
            }
            .col>div {
                margin: 0 auto;
            }
            img.fullwidth,
            img.fullwidthOnMobile {
                max-width: 100% !important;
            }
            .no-stack .col {
                min-width: 0 !important;
                display: table-cell !important;
            }
            .no-stack.two-up .col {
                width: 50% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num8 {
                width: 66% !important;
            }
            .no-stack .col.num4 {
                width: 33% !important;
            }
            .no-stack .col.num3 {
                width: 25% !important;
            }
            .no-stack .col.num6 {
                width: 50% !important;
            }
            .no-stack .col.num9 {
                width: 75% !important;
            }
            .video-block {
                max-width: none !important;
            }
            .mobile_hide {
                min-height: 0px;
                max-height: 0px;
                max-width: 0px;
                display: none;
                overflow: hidden;
                font-size: 0px;
            }
            .desktop_hide {
                display: block !important;
                max-height: none !important;
            }
        }
    </style>
</head>

<body class="clean-body" style="margin: 0; padding: 0; -webkit-text-size-adjust: 100%; background-color: #F5F5F5;">
    <!--[if IE]><div class="ie-browser"><![endif]-->
    <table bgcolor="#F5F5F5" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; Margin: 0 auto; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #F5F5F5; width: 100%;" valign="top" width="100%">
        <tbody>
            <tr style="vertical-align: top;" valign="top">
                <td style="word-break: break-word; vertical-align: top;" valign="top">
                    <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#F5F5F5"><![endif]-->
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table border="0" cellpadding="0" cellspacing="0" class="divider" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td class="divider_inner" style="word-break: break-word; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" border="0" cellpadding="0" cellspacing="0" class="divider_content" height="10" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-top: 0px solid transparent; height: 10px; width: 100%;" valign="top" width="100%">
                                                                <tbody>
                                                                    <tr style="vertical-align: top;" valign="top">
                                                                        <td height="10" style="word-break: break-word; vertical-align: top; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" valign="top"><span></span></td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid two-up no-stack" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #FFFFFF;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#FFFFFF;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#FFFFFF"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 25px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 0px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="left" class="img-container left fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="left"><![endif]--><img alt="Image" border="0" class="left fixedwidth" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/6ac70d4b-6462-4a67-ac30-faec499c6d4f/256x105.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 195px; display: block;" title="Image" width="195" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td><td align="center" width="325" style="background-color:#FFFFFF;width:325px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 0px; padding-top:25px; padding-bottom:25px;"><![endif]-->
                                <div class="col num6" style="min-width: 320px; max-width: 325px; display: table-cell; vertical-align: top; width: 325px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:25px; padding-bottom:25px; padding-right: 25px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <div align="right" class="button-container" style="padding-top:10px;padding-right:0px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 10px; padding-right: 0px; padding-bottom: 10px; padding-left: 10px" align="right"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:31.5pt; width:115.5pt; v-text-anchor:middle;" arcsize="34%" stroke="false" fillcolor="#0088ff"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:14px"><![endif]-->
                                               
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: #D6E7F0;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:#D6E7F0;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:#D6E7F0"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:#D6E7F0;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 25px; padding-left: 25px; padding-top:5px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:60px; padding-right: 25px; padding-left: 25px;">
                                            <!--<![endif]-->
                                            <div align="center" class="img-container center fixedwidth" style="padding-right: 0px;padding-left: 0px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0px"><td style="padding-right: 0px;padding-left: 0px;" align="center"><![endif]-->
                                                <div style="font-size:1px;line-height:45px"></div><img align="center" alt="Image" border="0" class="center fixedwidth" src="https://maxwilliam.s3.amazonaws.com/account_rejected_img.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; border: 0; height: auto; width: 100%; max-width: 540px; display: block;" title="Image" width="540" />
                                                <!--[if mso]></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 15px; padding-top: 20px; padding-bottom: 0px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#052d3d;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:20px;padding-right:10px;padding-bottom:0px;padding-left:15px;">
                                                <div style="font-size: 12px; line-height: 1.5; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; color: #052d3d; mso-line-height-alt: 18px;">
                                                   
                                                        </strong>
                                                        </span>
                                                    </p>
                                                   
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 14px;">
                                                    <p style="font-size: 18px; line-height: 1.2; text-align: center; word-break: break-word; mso-line-height-alt: 22px; margin: 0;text-align:left !important;word-wrap:break-word"><span style="font-size: 18px; color: #000000;;">
                                                      Thank you <b>'''+name+'''</b> for your association application at ALUMNI ASSOCIATION OF GOA. We really appreciate your interest in joining our association and we want to thank you for the time and energy you invested in applying for this application.
                                                      <br><br>
                                                      <b>After carefully reviewing all of them, unfortunately, we have to inform you that this time we wont be able to invite you to ALUMNI ASSOCIATION OF GOA.</b> We hope youll keep us in mind and apply again in the future on behalf of your college.

                                                      <br><br>If you have any questions or need additional information, please dont hesitate to contact us.
                                                      
We wish you every personal and professional success in your future endeavors.
                                                      
Once again, thank you for showing interest in ALUMNI ASSOCIATION OF GOA.

                                                      
                                                      </span></p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <div align="center" class="button-container" style="padding-top:20px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;"><tr><td style="padding-top: 20px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px" align="center"><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="#" style="height:39pt; width:220.5pt; v-text-anchor:middle;" arcsize="29%" stroke="false" fillcolor="#fc7318"><w:anchorlock/><v:textbox inset="0,0,0,0"><center style="color:#ffffff; font-family:Tahoma, Verdana, sans-serif; font-size:16px"><![endif]--><a href="'''+app_base_url+'''contact" style="-webkit-text-size-adjust: none; text-decoration: none; display: inline-block; color: #ffffff; background-color: #fc7318; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; width: auto; width: auto; border-top: 1px solid #fc7318; border-right: 1px solid #fc7318; border-bottom: 1px solid #fc7318; border-left: 1px solid #fc7318; padding-top: 10px; padding-bottom: 10px; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; text-align: center; mso-border-alt: none; word-break: keep-all;" target="_blank"><span style="padding-left:40px;padding-right:40px;font-size:16px;display:inline-block;"><span style="font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;"><strong>CONTACT US</strong></span></span></a>
                                                <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->
                                            </div>
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <div style="background-color:transparent;">
                        <div class="block-grid" style="Margin: 0 auto; min-width: 320px; max-width: 650px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;">
                            <div style="border-collapse: collapse;display: table;width: 100%;background-color:transparent;">
                                <!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:transparent;"><tr><td align="center"><table cellpadding="0" cellspacing="0" border="0" style="width:650px"><tr class="layout-full-width" style="background-color:transparent"><![endif]-->
                                <!--[if (mso)|(IE)]><td align="center" width="650" style="background-color:transparent;width:650px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 0px; padding-left: 0px; padding-top:20px; padding-bottom:60px;"><![endif]-->
                                <div class="col num12" style="min-width: 320px; max-width: 650px; display: table-cell; vertical-align: top; width: 650px;">
                                    <div style="width:100% !important;">
                                        <!--[if (!mso)&(!IE)]><!-->
                                        <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:20px; padding-bottom:60px; padding-right: 0px; padding-left: 0px;">
                                            <!--<![endif]-->
                                            <table cellpadding="0" cellspacing="0" class="social_icons" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top" width="100%">
                                                <tbody>
                                                    <tr style="vertical-align: top;" valign="top">
                                                        <td style="word-break: break-word; vertical-align: top; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;" valign="top">
                                                            <table align="center" cellpadding="0" cellspacing="0" class="social_table" role="presentation" style="table-layout: fixed; vertical-align: top; border-spacing: 0; border-collapse: collapse; mso-table-tspace: 0; mso-table-rspace: 0; mso-table-bspace: 0; mso-table-lspace: 0;" valign="top">
                                                                <tbody>
                                                                    <tr align="center" style="vertical-align: top; display: inline-block; text-align: center;" valign="top">
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://www.facebook.com/darshpatelofficial" target="_blank"><img alt="Facebook" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/93ef56de-a14b-43c0-8cda-7ba7f3b69b19/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Facebook" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://twitter.com/pateldarsh10" target="_blank"><img alt="Twitter" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/81c04100-cf31-4016-8820-9bf9296d39a0/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Twitter" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="https://instagram.com/pateldarsh_007" target="_blank"><img alt="Instagram" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/858aeae3-142f-4b84-8400-87cc7e0e92d8/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="Instagram" width="32" /></a>
                                                                        </td>
                                                                        <td style="word-break: break-word; vertical-align: top; padding-bottom: 5px; padding-right: 8px; padding-left: 8px;" valign="top">
                                                                            <a href="mailto:mailto:alumni.association.goa@gmail.com" target="_blank"><img alt="E-Mail" height="32" src="http://cdn.mcauto-images-production.sendgrid.net/92f4cab4130b7228/89016f33-3bcf-4dc9-b8ee-a4b5bc249ea4/64x64.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: none; display: block;" title="E-Mail" width="32" /></a>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px; font-family: Tahoma, Verdana, sans-serif"><![endif]-->
                                            <div style="color:#555555;font-family:Lato, Tahoma, Verdana, Segoe, sans-serif;line-height:1.5;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;">
                                                <div style="font-size: 12px; line-height: 1.5; color: #555555; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-line-height-alt: 18px;">
                                                    <p style="font-size: 14px; line-height: 1.5; text-align: center; word-break: break-word; mso-line-height-alt: 21px; margin: 0;"> 2020 - Alumni Association Of Goa - All Rights Reserved.</p>
                                                </div>
                                            </div>
                                            <!--[if mso]></td></tr></table><![endif]-->
                                            <!--[if (!mso)&(!IE)]><!-->
                                        </div>
                                        <!--<![endif]-->
                                    </div>
                                </div>
                                <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                                <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->
                            </div>
                        </div>
                    </div>
                    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->
                </td>
            </tr>
        </tbody>
    </table>
    <!--[if (IE)]></div><![endif]-->
</body>

</html>                                     
                '''
            try :
                mail.send(msg)
                mail_sent = 1
            except :
                mail_sent = 0
                print("Error In Sending Rejection College Mail.")
                
            if mail_sent == 1 :    
                country_code = "+"+str(p_details[0][4])
                mobile_no = str(p_details[0][5])
            
            
                final_mobile_no = str(country_code) + str(mobile_no)
                headers = {
                    'Content-Type': 'application/json',
                    'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
            }
            
                print(final_mobile_no)
                headers = {
      'Content-Type': 'application/json',
      'APIKey': 'nnz4MDDl8PZeAbUOUApBUnYo6EbGO8vC'
  }
            
            
            
                msg = 'Unfortunately, Application for '+name+' for association member at Alumni Association Of Goa has been rejected. Better Luck Next Time.'

                data = '{"message": "'+msg+'","binary": false,  "destinations": ["'+final_mobile_no+'"]}'

                response = requests.post('https://sandbox.api.sap.com/proximusenco/sms/outboundmessages', headers=headers, data=data)
                res = json.loads(response.text)
                print(res)
                try :
                    if res["deliveryInfo"][0]["deliveryStatus"] == "DeliveredToNetwork" :
                        sms_sent = 1
                        # return jsonify(res=1)
                    else :
                        sms_sent = 0
                except :
                    sms_sent = 0
    
                
            
            if isUpdated == 1 :
                
                if mail_sent == 1 :
                    return jsonify(res=1,error="No",msg="Application Is Rejected Successfully.")
                else :
                    return jsonify(res=1,error="NoMailSent",msg="Application is rejected successfully but unable to send rejection email.")
            
            else :
                return jsonify(res=0,error="RejectUpdateError",msg="Unable To Reject Application.")

    
    cnx = mysql.connector.connect(host="localhost",user="root",passwd="",database="ats")
    con = cnx.cursor()
    
    association_applications = []
    sql = "SELECT * FROM association WHERE 	isEmailVerified='YES' AND isMobileVerified='YES' AND isAssociationVerified='NO' AND account_status='NOT ACTIVATED'"
    con.execute(sql)
    association_applications = con.fetchall()
    
    con.close()
    return render_template("super_admin_home.html",association_applications=association_applications,l_association_applications=len(association_applications))

@app.route('/super-admin/logout')
def super_admin_logout():
    if 'super_admin_login_id' in session and 'super_admin_login_email' in session :
        session['super_admin_login_id'] = ""
        session['super_admin_login_email'] = ""
        session['super_admin_account_activated'] = ""
        session.pop('super_admin_login_id',None)
        session.pop('super_admin_login_email',None)
        session.pop('super_admin_account_activated',None)
    return "<script>window.location.href='/super-admin/login';</script>"


@app.route('/temp')
def temp():
    return render_template('temp.html')

@app.route('/fb')
def fb():
    return render_template('fb.html')

@app.route('/location')
def location():
    return render_template('location.html')

@app.route('/view_event')
def view_event():
    return render_template('view_event.html')

@app.route('/customerly/')
def customerly():
    return render_template("customerly.html")

@app.route('/uploadajax',methods=[ "GET",'POST'])
def uploadLabel():
    try :
        os.mkdir('static/uploads/association_blog_post_images')
    except :
        pass
    isthisFile=request.files.get('UploadFiles')
    # print(request.files.get('file').read())
    # print(isthisFile)
    print(isthisFile.filename)
    isthisFile.save("static/uploads/association_blog_post_images/"+isthisFile.filename)
    return "File Uploaded."

@app.route('/association_broadcast_ajax',methods=[ "GET",'POST'])
def association_broadcast_ajax():
    try :
        os.mkdir('static/uploads/association_broadcast')
    except :
        pass
    isthisFile=request.files.get('UploadFiles')
    # print(request.files.get('file').read())
    # print(isthisFile)
    print(isthisFile.filename)
    path = "static/uploads/association_broadcast/"+isthisFile.filename
    isthisFile.save(path)
    with open(path, 'rb') as f:
        x = publitio_api.create_file(file=f,
                             title='My title',
                             description='My description')
    
    # t = json.load
    
        print(x['url_preview'])
    return "File Uploaded."

@app.route('/upload_news_ajax',methods=[ "GET",'POST'])
def upload_news_ajax():
    try :
        os.mkdir('static/uploads/news')
    except :
        pass
    isthisFile=request.files.get('UploadFiles')
    # print(request.files.get('file').read())
    # print(isthisFile)
    print(isthisFile.filename)
    path = "static/uploads/news/"+isthisFile.filename
    isthisFile.save(path)
    # with open(path, 'rb') as f:
        # x = publitio_api.create_file(file=f,
                            #  title='My title',
                            #  description='My description')
    
    # t = json.load
    
        # print(x['url_preview'])
    return "File Uploaded."


@app.route('/college_event_upload_ajax',methods=[ "GET",'POST'])
def college_event_upload_ajax():
    try :
        os.mkdir('static/uploads/events')
    except :
        pass
    isthisFile=request.files.get('UploadFiles')
    # print(request.files.get('file').read())
    # print(isthisFile)
    print(isthisFile.filename)
    path = "static/uploads/events/"+isthisFile.filename
    isthisFile.save(path)
    # with open(path, 'rb') as f:
        # x = publitio_api.create_file(file=f,
                            #  title='My title',
                            #  description='My description')
    
    # t = json.load
    
        # print(x['url_preview'])
    return "File Uploaded."


@app.route('/upload_association_profile_img',methods=[ "GET",'POST'])
def upload_association_profile_img():
    try :
        os.mkdir('static/uploads/association_profile_images')
    except :
        pass
    isfileuploaded = 0
    isthisFile = request.files['uploadPicture']
                # print(request.files.get('file').read())
                # print(isthisFile)
    print(isthisFile.filename)
    path = "static/uploads/association_profile_images/profile_img_association_"+str(uuid.uuid1())+"_"+isthisFile.filename

    try :
        isthisFile.save(path)
        isfileuploaded = 1
        
    except :
        pass
    
    isInserted = 0
    
    if isfileuploaded == 1 :
        try :
            sql = "SELECT * FROM association_basic_profile_details WHERE association_id=%d" % (int(session['association_login_id']))
            con.execute(sql)
            res = con.fetchall()
            if len(res) == 0 :
                sql = "INSERT INTO association_basic_profile_details(association_id,profile_image) VALUES(%d,'%s')" % (int(session['association_login_id']),str(path))
                con.execute(sql)
                cnx.commit()
                isInserted = 1
            else :
                sql = "UPDATE association_basic_profile_details SET profile_image='%s' WHERE association_id=%d" % (str(path),int(session['association_login_id']))
                con.execute(sql)
                cnx.commit()
                isInserted = 1
        except :
            pass
        
        if isInserted == 1 :
            flash(Markup("<p style='color:green;font-size:15px;'>Profile Image Changed Successfully.</p>"))  
            return redirect(url_for('association_profile'))
        else :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Profile Image In Database.</p>"))  
            return redirect(url_for('association_profile'))
    else :
        flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading Profile Image.</p>"))  
        return redirect(url_for('association_profile'))
  

@app.route('/upload_college_profile_img',methods=[ "GET",'POST'])
def upload_college_profile_img():
    try :
        os.mkdir('static/uploads/college_profile_images')
    except :
        pass
    isfileuploaded = 0
    isthisFile = request.files['uploadPicture']
                # print(request.files.get('file').read())
                # print(isthisFile)
    print(isthisFile.filename)
    path = "static/uploads/college_profile_images/profile_img_college_"+str(uuid.uuid1())+"_"+isthisFile.filename

    try :
        isthisFile.save(path)
        isfileuploaded = 1
        
    except :
        pass
    
    isInserted = 0
    
    if isfileuploaded == 1 :
        try :
            sql = "SELECT * FROM college_basic_profile_details WHERE spoc_id=%d" % (int(session['college_login_id']))
            con.execute(sql)
            res = con.fetchall()
            if len(res) == 0 :
                sql = "INSERT INTO college_basic_profile_details(spoc_id,profile_image) VALUES(%d,'%s')" % (int(session['college_login_id']),str(path))
                con.execute(sql)
                cnx.commit()
                isInserted = 1
            else :
                sql = "UPDATE college_basic_profile_details SET profile_image='%s' WHERE spoc_id=%d" % (str(path),int(session['college_login_id']))
                con.execute(sql)
                cnx.commit()
                isInserted = 1
        except :
            pass
        
        if isInserted == 1 :
            flash(Markup("<p style='color:green;font-size:15px;'>Profile Image Changed Successfully.</p>"))  
            return redirect(url_for('college_profile'))
        else :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Profile Image In Database.</p>"))  
            return redirect(url_for('college_profile'))
    else :
        flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading Profile Image.</p>"))  
        return redirect(url_for('college_profile'))
                
      
      
@app.route('/upload_alumni_profile_img',methods=[ "GET",'POST'])
def upload_alumni_profile_img():
    try :
        os.mkdir('static/uploads/alumni_profile_images')
    except :
        pass
    isfileuploaded = 0
    isthisFile = request.files['uploadPicture']
                # print(request.files.get('file').read())
                # print(isthisFile)
    print(isthisFile.filename)
    path = "static/uploads/alumni_profile_images/profile_img_alumni_"+str(uuid.uuid1())+"_"+isthisFile.filename

    try :
        isthisFile.save(path)
        isfileuploaded = 1
        
    except :
        pass
    
    isInserted = 0
    
    if isfileuploaded == 1 :
        try :
            sql = "SELECT * FROM alumni_basic_profile_details WHERE alumni_id=%d" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            if len(res) == 0 :
                sql = "INSERT INTO alumni_basic_profile_details(alumni_id,profile_image) VALUES(%d,'%s')" % (int(session['alumni_login_id']),str(path))
                con.execute(sql)
                cnx.commit()
                isInserted = 1
            else :
                sql = "UPDATE alumni_basic_profile_details SET profile_image='%s' WHERE alumni_id=%d" % (str(path),int(session['alumni_login_id']))
                con.execute(sql)
                cnx.commit()
                isInserted = 1
        except :
            pass
        
        if isInserted == 1 :
            flash(Markup("<p style='color:green;font-size:15px;'>Profile Image Changed Successfully.</p>"))  
            return redirect(url_for('alumni_profile'))
        else :
            flash(Markup("<p style='color:red;font-size:15px;'>Error In Updating Profile Image In Database.</p>"))  
            return redirect(url_for('alumni_profile'))
    else :
        flash(Markup("<p style='color:red;font-size:15px;'>Error In Uploading Profile Image.</p>"))  
        return redirect(url_for('alumni_profile'))
                
                    
            

@app.context_processor
def context_processor():
    current_url = request.path
    print(request.endpoint)
    my_cart_records = 0
    cnx = mysql.connector.connect(user="root",passwd="",host="localhost",database="ats")
    con = cnx.cursor()

    footer_blog_posts = []

    try :
        sql = "SELECT post_id,post_image,post_title FROM blog_post_association LIMIT 5"
        con.execute(sql)
        res = con.fetchall()
        for i in res :
            url = "association/blog/post/"+str(i[0])
            image = str(i[1]).replace("static/","")
            # print(image)
            footer_blog_posts.append([str(url),str(image),str(i[2])])
    except :
        pass
    
    isAlumniAllowedForJobPost = 0
    
    if 'alumni_login_id' in session :
        try :
            sql = "SELECT * FROM alumni_recruiters WHERE alumni_id=%d AND isActive='YES'" % (int(session['alumni_login_id']))
            con.execute(sql)
            res = con.fetchall()
            if len(res) >= 1 :
                isAlumniAllowedForJobPost = 1
        except :
            print("Error In Checking For Alumni Recruiter.")
    
    cnx.close()
    return dict(footer_blog_posts=footer_blog_posts,l_footer_blog_posts=len(footer_blog_posts),isAlumniAllowedForJobPost=isAlumniAllowedForJobPost)



if __name__ == "__main__" :
    app.run(debug=True,port=5000)
    